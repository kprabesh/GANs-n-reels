<!DOCTYPE html>
<!-- saved from url=(0114)https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html#kullbackleibler-and-jensenshannon-divergence -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
      






    

    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>From GAN to WGAN</title>
    <meta name="description" content="This post explains the maths behind a generative adversarial network (GAN) model and why it is hard to be trained. Wasserstein GAN is intended to improve GAN...">

    <link rel="shortcut icon" href="https://lilianweng.github.io/lil-log/assets/images/favicon.ico">
    <link rel="stylesheet" href="./From GAN to WGAN_files/main.css">
    <link rel="canonical" href="https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html">

    <!-- For Latex -->
    <script id="facebook-jssdk" src="./From GAN to WGAN_files/sdk.js"></script><script async="" src="./From GAN to WGAN_files/analytics.js"></script><script src="./From GAN to WGAN_files/MathJax.js" type="text/javascript"></script>

    <!-- Google Analytics -->
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-8161570-6', 'auto');
        ga('send', 'pageview');
    </script>

    <!-- For Facebook share button -->
    <style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_loader{background-color:#f6f7f9;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{width:auto;height:auto;min-height:initial;min-width:initial;background:none}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{color:#fff;display:block;padding-top:20px;clear:both;font-size:18px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;bottom:0;left:0;right:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29487d;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f9;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-repeat:no-repeat;background-position:50% 50%;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}
.fb_customer_chat_bounce_in{animation-duration:250ms;animation-name:fb_bounce_in}.fb_customer_chat_bounce_out{animation-duration:250ms;animation-name:fb_fade_out}.fb_invisible_flow{display:inherit;height:0;overflow-x:hidden;width:0}.fb_mobile_overlay_active{background-color:#fff;height:100%;overflow:hidden;position:fixed;visibility:hidden;width:100%}@keyframes fb_fade_out{from{opacity:1}to{opacity:0}}@keyframes fb_bounce_in{0%{opacity:0;transform:scale(.8, .8);transform-origin:100% 100%}10%{opacity:.1}20%{opacity:.2}30%{opacity:.3}40%{opacity:.4}50%{opacity:.5}60%{opacity:.6}70%{opacity:.7}80%{opacity:.8;transform:scale(1.03, 1.03)}90{opacity:.9}100%{opacity:1;transform:scale(1, 1)}}</style></head><body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div><div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_https" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./From GAN to WGAN_files/RQ7NiRXMcYA.html" style="border: none;"></iframe></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div></div></div></div>
    <script>
      (function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.9";
        fjs.parentNode.insertBefore(js, fjs);
      }(document, 'script', 'facebook-jssdk'));
    </script>




  

    <header class="site-header" role="banner">

    <div class="wrapper">
        
        <a class="site-title" href="https://lilianweng.github.io/lil-log/">Lil'Log</a>

        <nav class="site-nav">
            <a class="page-link" href="http://lilianweng.github.io/" target="_blank">🍉 About</a>
        </nav>

        <nav class="site-nav">
            <a class="page-link" href="https://lilianweng.github.io/lil-log/contact.html">📮 Contact</a>
        </nav>

    </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope="" itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">From GAN to WGAN</h1>
    <p class="post-meta">

      <time datetime="2017-08-20T00:23:00+00:00" itemprop="datePublished">
        
        Aug 20, 2017
      </time>

      <span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
        by <span itemprop="name">Lilian Weng</span>
      </span>

      <span>
        
          
          <a class="post-tag" href="https://lilianweng.github.io/lil-log/tag/gan"><nobr>gan</nobr>&nbsp;</a>
        
          
          <a class="post-tag" href="https://lilianweng.github.io/lil-log/tag/long-read"><nobr>long-read</nobr>&nbsp;</a>
        
      </span>
      <!--
      <span class="share-buttons">
        <span class="share-button"><a class="twitter-share-button" href="https://twitter.com/share" data-show-count="false">Tweet</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script></span>

        <span class="share-button"><span class="fb-like" data-href="/2017/08/20/from-GAN-to-WGAN.html" data-layout="button_count" data-action="like" data-size="small" data-show-faces="false" data-share="true"></span></span>
      </span>
      <div style="clear: both;"/>
      -->

    </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <blockquote>
  <p>This post explains the maths behind a generative adversarial network (GAN) model and why it is hard to be trained. Wasserstein GAN is intended to improve GANs’ training by adopting a smooth metric for measuring the distance between two probability distributions.</p>
</blockquote>

<!--more-->

<p><a href="https://arxiv.org/pdf/1406.2661.pdf">Generative adversarial network</a> (GAN) has shown great results in many generative tasks to replicate the real-world rich content such as images, human language, and music. It is inspired by game theory: two models, a generator and a critic, are competing with each other while making each other stronger at the same time. However, it is rather challenging to train a GAN model, as people are facing issues like training instability or failure to converge.</p>

<p>Here I would like to explain the maths behind the generative adversarial network framework,  why it is hard to be trained, and finally introduce a modified version of GAN intended to solve the training difficulties.</p>

<ul class="table-of-content" id="markdown-toc">
  <li><a href="https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html#kullbackleibler-and-jensenshannon-divergence" id="markdown-toc-kullbackleibler-and-jensenshannon-divergence">Kullback–Leibler and Jensen–Shannon Divergence</a></li>
  <li><a href="https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html#generative-adversarial-network-gan" id="markdown-toc-generative-adversarial-network-gan">Generative Adversarial Network (GAN)</a>    <ul>
      <li><a href="https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html#what-is-the-optimal-value-for-d" id="markdown-toc-what-is-the-optimal-value-for-d">What is the optimal value for D?</a></li>
      <li><a href="https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html#what-is-the-global-optimal" id="markdown-toc-what-is-the-global-optimal">What is the global optimal?</a></li>
      <li><a href="https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html#what-does-the-loss-function-represent" id="markdown-toc-what-does-the-loss-function-represent">What does the loss function represent?</a></li>
    </ul>
  </li>
  <li><a href="https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html#problems-in-gans" id="markdown-toc-problems-in-gans">Problems in GANs</a>    <ul>
      <li><a href="https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html#hard-to-achieve-nash-equilibrium" id="markdown-toc-hard-to-achieve-nash-equilibrium">Hard to achieve Nash equilibrium</a></li>
      <li><a href="https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html#low-dimensional-supports" id="markdown-toc-low-dimensional-supports">Low dimensional supports</a></li>
      <li><a href="https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html#vanishing-gradient" id="markdown-toc-vanishing-gradient">Vanishing gradient</a></li>
      <li><a href="https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html#mode-collapse" id="markdown-toc-mode-collapse">Mode collapse</a></li>
      <li><a href="https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html#lack-of-a-proper-evaluation-metric" id="markdown-toc-lack-of-a-proper-evaluation-metric">Lack of a proper evaluation metric</a></li>
    </ul>
  </li>
  <li><a href="https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html#improved-gan-training" id="markdown-toc-improved-gan-training">Improved GAN Training</a></li>
  <li><a href="https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html#wasserstein-gan-wgan" id="markdown-toc-wasserstein-gan-wgan">Wasserstein GAN (WGAN)</a>    <ul>
      <li><a href="https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html#what-is-wasserstein-distance" id="markdown-toc-what-is-wasserstein-distance">What is Wasserstein distance?</a></li>
      <li><a href="https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html#why-wasserstein-is-better-than-js-or-kl-divergence" id="markdown-toc-why-wasserstein-is-better-than-js-or-kl-divergence">Why Wasserstein is better than JS or KL divergence?</a></li>
      <li><a href="https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html#use-wasserstein-distance-as-gan-loss-function" id="markdown-toc-use-wasserstein-distance-as-gan-loss-function">Use Wasserstein distance as GAN loss function</a></li>
    </ul>
  </li>
  <li><a href="https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html#example-create-new-pokemons" id="markdown-toc-example-create-new-pokemons">Example: Create New Pokemons!</a></li>
  <li><a href="https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html#references" id="markdown-toc-references">References</a></li>
</ul>

<h2 id="kullbackleibler-and-jensenshannon-divergence">Kullback–Leibler and Jensen–Shannon Divergence</h2>

<p>Before we start examining GANs closely, let us first review two metrics for quantifying the similarity between two probability distributions.</p>

<p>(1) <a href="https://en.wikipedia.org/wiki/Kullback%E2%80%93Leibler_divergence">KL (Kullback–Leibler) divergence</a> measures how one probability distribution <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0.594em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.487em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.43em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: STIXGeneral; font-style: italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">p</script> diverges from a second expected probability distribution <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4" style="width: 0.594em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.487em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.49em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: STIXGeneral; font-style: italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">q</script>.</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7" style="width: 15.594em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.583em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.97em, 1012.58em, 3.605em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-8"><span class="msubsup" id="MathJax-Span-9"><span style="display: inline-block; position: relative; width: 1.723em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-10" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="texatom" id="MathJax-Span-11"><span class="mrow" id="MathJax-Span-12"><span class="mi" id="MathJax-Span-13" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-14" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-15" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-16" style="font-family: STIXGeneral; font-style: italic;">p</span><span class="mo" id="MathJax-Span-17" style="font-family: STIXGeneral;">‖</span><span class="mi" id="MathJax-Span-18" style="font-family: STIXGeneral; font-style: italic;">q</span><span class="mo" id="MathJax-Span-19" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-20" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="msubsup" id="MathJax-Span-21" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.02em, 5.003em, -999.997em); top: -3.976em; left: 0em;"><span class="mo" id="MathJax-Span-22" style="font-family: STIXIntegralsD; vertical-align: -0.589em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.433em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.062em; left: 0.594em;"><span class="mi" id="MathJax-Span-23" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mi" id="MathJax-Span-24" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">p</span><span class="mo" id="MathJax-Span-25" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-26" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-27" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-28" style="font-family: STIXGeneral; padding-left: 0.164em;">log</span><span class="mo" id="MathJax-Span-29"></span><span class="mfrac" id="MathJax-Span-30" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.723em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1001.56em, 4.358em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.804em;"><span class="mrow" id="MathJax-Span-31"><span class="mi" id="MathJax-Span-32" style="font-family: STIXGeneral; font-style: italic;">p</span><span class="mo" id="MathJax-Span-33" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-34" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-35" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1001.56em, 4.358em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.804em;"><span class="mrow" id="MathJax-Span-36"><span class="mi" id="MathJax-Span-37" style="font-family: STIXGeneral; font-style: italic;">q</span><span class="mo" id="MathJax-Span-38" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-39" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-40" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1001.72em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.723em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mi" id="MathJax-Span-41" style="font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-42" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.197em; border-left: 0px solid; width: 0px; height: 3.003em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">(</mo><mi>p</mi><mo fence="false" stretchy="false">‖</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mo>∫</mo><mi>x</mi></msub><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mi>d</mi><mi>x</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-3">D_{KL}(p \| q) = \int_x p(x) \log \frac{p(x)}{q(x)} dx</script>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-43" style="width: 2.153em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.723em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.562em, 1001.72em, 2.691em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-44"><span class="msubsup" id="MathJax-Span-45"><span style="display: inline-block; position: relative; width: 1.723em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-46" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="texatom" id="MathJax-Span-47"><span class="mrow" id="MathJax-Span-48"><span class="mi" id="MathJax-Span-49" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-50" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.137em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-4">D_{KL}</script> achieves the minimum zero when <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-51" style="width: 2.046em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.616em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1001.56em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-52"><span class="mi" id="MathJax-Span-53" style="font-family: STIXGeneral; font-style: italic;">p</span><span class="mo" id="MathJax-Span-54" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-55" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-56" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-5">p(x)</script> == <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-57" style="width: 2.046em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.616em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1001.56em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-58"><span class="mi" id="MathJax-Span-59" style="font-family: STIXGeneral; font-style: italic;">q</span><span class="mo" id="MathJax-Span-60" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-61" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-62" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-6">q(x)</script> everywhere.</p>

<p>It is noticeable according to the formula that KL divergence is asymmetric. In cases where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-63" style="width: 2.046em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.616em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1001.56em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-64"><span class="mi" id="MathJax-Span-65" style="font-family: STIXGeneral; font-style: italic;">p</span><span class="mo" id="MathJax-Span-66" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-67" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-68" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7">p(x)</script> is close to zero, but <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-69" style="width: 2.046em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.616em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1001.56em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-70"><span class="mi" id="MathJax-Span-71" style="font-family: STIXGeneral; font-style: italic;">q</span><span class="mo" id="MathJax-Span-72" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-73" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-74" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-8">q(x)</script> is significantly non-zero, the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-75" style="width: 0.594em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.487em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.49em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-76"><span class="mi" id="MathJax-Span-77" style="font-family: STIXGeneral; font-style: italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">q</script>’s effect is disregarded. It could cause buggy results when we just want to measure the similarity between two equally important distributions.</p>

<p>(2) <a href="https://en.wikipedia.org/wiki/Jensen%E2%80%93Shannon_divergence">Jensen–Shannon Divergence</a> is another measure of similarity between two probability distributions, bounded by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-78" style="width: 2.637em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.099em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1001.99em, 2.852em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-79"><span class="mo" id="MathJax-Span-80" style="font-family: STIXGeneral;">[</span><span class="mn" id="MathJax-Span-81" style="font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-82" style="font-family: STIXGeneral;">,</span><span class="mn" id="MathJax-Span-83" style="font-family: STIXGeneral; padding-left: 0.164em;">1</span><span class="mo" id="MathJax-Span-84" style="font-family: STIXGeneral;">]</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.137em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-10">[0, 1]</script>. JS divergence is symmetric (yay!) and more smooth. Check this <a href="https://www.quora.com/Why-isnt-the-Jensen-Shannon-divergence-used-more-often-than-the-Kullback-Leibler-since-JS-is-symmetric-thus-possibly-a-better-indicator-of-distance">Quora post</a> if you are interested in reading more about the comparison between KL divergence and JS divergence.</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-85" style="width: 24.841em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.003em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.024em, 1019.95em, 3.39em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-86"><span class="msubsup" id="MathJax-Span-87"><span style="display: inline-block; position: relative; width: 1.508em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-88" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="texatom" id="MathJax-Span-89"><span class="mrow" id="MathJax-Span-90"><span class="mi" id="MathJax-Span-91" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-92" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-93" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-94" style="font-family: STIXGeneral; font-style: italic;">p</span><span class="mo" id="MathJax-Span-95" style="font-family: STIXGeneral;">‖</span><span class="mi" id="MathJax-Span-96" style="font-family: STIXGeneral; font-style: italic;">q</span><span class="mo" id="MathJax-Span-97" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-98" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mfrac" id="MathJax-Span-99" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 0.648em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-100" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1000.49em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-101" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1000.65em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.648em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-102"><span style="display: inline-block; position: relative; width: 1.723em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-103" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="texatom" id="MathJax-Span-104"><span class="mrow" id="MathJax-Span-105"><span class="mi" id="MathJax-Span-106" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-107" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-108" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-109" style="font-family: STIXGeneral; font-style: italic;">p</span><span class="mo" id="MathJax-Span-110" style="font-family: STIXGeneral;">‖</span><span class="mfrac" id="MathJax-Span-111"><span style="display: inline-block; position: relative; width: 2.368em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.282em, 1002.21em, 4.358em, -999.997em); top: -4.675em; left: 50%; margin-left: -1.126em;"><span class="mrow" id="MathJax-Span-112"><span class="mi" id="MathJax-Span-113" style="font-family: STIXGeneral; font-style: italic;">p</span><span class="mo" id="MathJax-Span-114" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="mi" id="MathJax-Span-115" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.272em;">q</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1000.49em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-116" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1002.37em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.368em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-117" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-118" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="mfrac" id="MathJax-Span-119" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 0.648em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-120" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1000.49em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-121" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1000.65em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.648em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-122"><span style="display: inline-block; position: relative; width: 1.723em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-123" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="texatom" id="MathJax-Span-124"><span class="mrow" id="MathJax-Span-125"><span class="mi" id="MathJax-Span-126" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-127" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-128" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-129" style="font-family: STIXGeneral; font-style: italic;">q</span><span class="mo" id="MathJax-Span-130" style="font-family: STIXGeneral;">‖</span><span class="mfrac" id="MathJax-Span-131"><span style="display: inline-block; position: relative; width: 2.368em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.282em, 1002.21em, 4.358em, -999.997em); top: -4.675em; left: 50%; margin-left: -1.126em;"><span class="mrow" id="MathJax-Span-132"><span class="mi" id="MathJax-Span-133" style="font-family: STIXGeneral; font-style: italic;">p</span><span class="mo" id="MathJax-Span-134" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="mi" id="MathJax-Span-135" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.272em;">q</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1000.49em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-136" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1002.37em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.368em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-137" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.93em; border-left: 0px solid; width: 0px; height: 2.67em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>J</mi><mi>S</mi></mrow></msub><mo stretchy="false">(</mo><mi>p</mi><mo fence="false" stretchy="false">‖</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">(</mo><mi>p</mi><mo fence="false" stretchy="false">‖</mo><mfrac><mrow><mi>p</mi><mo>+</mo><mi>q</mi></mrow><mn>2</mn></mfrac><mo stretchy="false">)</mo><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">(</mo><mi>q</mi><mo fence="false" stretchy="false">‖</mo><mfrac><mrow><mi>p</mi><mo>+</mo><mi>q</mi></mrow><mn>2</mn></mfrac><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-11">D_{JS}(p \| q) = \frac{1}{2} D_{KL}(p \| \frac{p + q}{2}) + \frac{1}{2} D_{KL}(q \| \frac{p + q}{2})</script>

<p style="width: 640px;" class="center"><img src="./From GAN to WGAN_files/KL_JS_divergence.png" alt="KL and JS divergence"></p>
<p><em>Fig. 1. Given two Gaussian distribution, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-138" style="width: 0.594em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.487em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.43em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-139"><span class="mi" id="MathJax-Span-140" style="font-family: STIXGeneral; font-style: italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">p</script> with mean=0 and std=1 and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-141" style="width: 0.594em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.487em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.49em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-142"><span class="mi" id="MathJax-Span-143" style="font-family: STIXGeneral; font-style: italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">q</script> with mean=1 and std=1. The average of two distributions is labelled as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-144" style="width: 7.099em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1005.7em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-145"><span class="mi" id="MathJax-Span-146" style="font-family: STIXGeneral; font-style: italic;">m</span><span class="mo" id="MathJax-Span-147" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mo" id="MathJax-Span-148" style="font-family: STIXGeneral; padding-left: 0.325em;">(</span><span class="mi" id="MathJax-Span-149" style="font-family: STIXGeneral; font-style: italic;">p</span><span class="mo" id="MathJax-Span-150" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="mi" id="MathJax-Span-151" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.272em;">q</span><span class="mo" id="MathJax-Span-152" style="font-family: STIXGeneral;">)</span><span class="texatom" id="MathJax-Span-153"><span class="mrow" id="MathJax-Span-154"><span class="mo" id="MathJax-Span-155" style="font-family: STIXGeneral;">/</span></span></span><span class="mn" id="MathJax-Span-156" style="font-family: STIXGeneral;">2</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-14">m=(p+q)/2</script>. KL divergence <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-157" style="width: 2.153em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.723em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.562em, 1001.72em, 2.691em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-158"><span class="msubsup" id="MathJax-Span-159"><span style="display: inline-block; position: relative; width: 1.723em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-160" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="texatom" id="MathJax-Span-161"><span class="mrow" id="MathJax-Span-162"><span class="mi" id="MathJax-Span-163" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-164" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.137em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-15">D_{KL}</script> is asymmetric but JS divergence <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-165" style="width: 1.884em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.508em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.562em, 1001.51em, 2.691em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-166"><span class="msubsup" id="MathJax-Span-167"><span style="display: inline-block; position: relative; width: 1.508em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-168" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="texatom" id="MathJax-Span-169"><span class="mrow" id="MathJax-Span-170"><span class="mi" id="MathJax-Span-171" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-172" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.137em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>J</mi><mi>S</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-16">D_{JS}</script> is symmetric.</em></p>

<p>Some believe (<a href="https://arxiv.org/pdf/1511.05101.pdf">Huszar, 2015</a>) that one reason behind GANs’ big success is switching the loss function from asymmetric KL divergence in traditional maximum-likelihood approach to symmetric JS divergence. We will discuss more on this point in the next section.</p>

<h2 id="generative-adversarial-network-gan">Generative Adversarial Network (GAN)</h2>

<p>GAN consists of two models:</p>
<ul>
  <li>A discriminator <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-173" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.7em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-174"><span class="mi" id="MathJax-Span-175" style="font-family: STIXGeneral; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-17">D</script> estimates the probability of a given sample coming from the real dataset. It works as a critic and is optimized to tell the fake samples from the real ones.</li>
  <li>A generator <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-176" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.7em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-177"><span class="mi" id="MathJax-Span-178" style="font-family: STIXGeneral; font-style: italic;">G</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">G</script> outputs synthetic samples given a noise variable input <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-179" style="width: 0.487em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.379em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.38em, 2.798em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-180"><span class="mi" id="MathJax-Span-181" style="font-family: STIXGeneral; font-style: italic;">z</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.197em; border-left: 0px solid; width: 0px; height: 0.737em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">z</script> (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-182" style="width: 0.487em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.379em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.38em, 2.798em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-183"><span class="mi" id="MathJax-Span-184" style="font-family: STIXGeneral; font-style: italic;">z</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.197em; border-left: 0px solid; width: 0px; height: 0.737em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-20">z</script> brings in potential output diversity). It is trained to capture the real data distribution so that its generative samples can be as real as possible, or in other words, can trick the discriminator to offer a high probability.</li>
</ul>

<p style="width: 600px;" class="center"><img src="./From GAN to WGAN_files/GAN.png" alt="Generative adversarial network"></p>
<p><em>Fig. 2. Architecture of a generative adversarial network. (Image source: <a href="http://www.kdnuggets.com/2017/01/generative-adversarial-networks-hot-topic-machine-learning.html">www.kdnuggets.com/2017/01/generative-…-learning.html</a>)</em></p>

<p>These two models compete against each other during the training process: the generator <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-185" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.7em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-186"><span class="mi" id="MathJax-Span-187" style="font-family: STIXGeneral; font-style: italic;">G</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">G</script> is trying hard to trick the discriminator, while the critic model <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-188" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.7em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-189"><span class="mi" id="MathJax-Span-190" style="font-family: STIXGeneral; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">D</script> is trying hard not to be cheated. This interesting zero-sum game between two models motivates both to improve their functionalities.</p>

<p>Given,</p>

<table class="info">
  <thead>
    <tr>
      <th>Symbol</th>
      <th>Meaning</th>
      <th>Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-191" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.839em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.795em, 1000.84em, 2.751em, -999.997em); top: -2.386em; left: 0em;"><span class="mrow" id="MathJax-Span-192"><span class="msubsup" id="MathJax-Span-193"><span style="display: inline-block; position: relative; width: 0.839em; height: 0px;"><span style="position: absolute; clip: rect(3.408em, 1000.48em, 4.364em, -999.997em); top: -3.999em; left: 0em;"><span class="mi" id="MathJax-Span-194" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 4.005em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.481em;"><span class="texatom" id="MathJax-Span-195"><span class="mrow" id="MathJax-Span-196"><span class="mi" id="MathJax-Span-197" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 4.005em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.392em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.293em; border-left: 0px solid; width: 0px; height: 0.967em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>z</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-23">p_{z}</script></td>
      <td>Data distribution over noise input <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-198" style="width: 0.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.421em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.974em, 1000.42em, 2.811em, -999.997em); top: -2.566em; left: 0em;"><span class="mrow" id="MathJax-Span-199"><span class="mi" id="MathJax-Span-200" style="font-family: STIXGeneral; font-style: italic;">z</span></span><span style="display: inline-block; width: 0px; height: 2.572em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.144em; border-left: 0px solid; width: 0px; height: 0.819em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-24">z</script></td>
      <td>Usually, just uniform.</td>
    </tr>
    <tr>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-201" style="width: 1.198em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.795em, 1000.96em, 2.87em, -999.997em); top: -2.386em; left: 0em;"><span class="mrow" id="MathJax-Span-202"><span class="msubsup" id="MathJax-Span-203"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.408em, 1000.48em, 4.364em, -999.997em); top: -3.999em; left: 0em;"><span class="mi" id="MathJax-Span-204" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 4.005em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.481em;"><span class="texatom" id="MathJax-Span-205"><span class="mrow" id="MathJax-Span-206"><span class="mi" id="MathJax-Span-207" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span></span></span><span style="display: inline-block; width: 0px; height: 4.005em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.392em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.441em; border-left: 0px solid; width: 0px; height: 1.041em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>g</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-25">p_{g}</script></td>
      <td>The generator’s distribution over data <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-208" style="width: 0.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.421em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.974em, 1000.42em, 2.751em, -999.997em); top: -2.566em; left: 0em;"><span class="mrow" id="MathJax-Span-209"><span class="mi" id="MathJax-Span-210" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.572em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.07em; border-left: 0px solid; width: 0px; height: 0.744em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-26">x</script></td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-211" style="width: 1.138em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.899em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.795em, 1000.9em, 2.751em, -999.997em); top: -2.386em; left: 0em;"><span class="mrow" id="MathJax-Span-212"><span class="msubsup" id="MathJax-Span-213"><span style="display: inline-block; position: relative; width: 0.899em; height: 0px;"><span style="position: absolute; clip: rect(3.408em, 1000.48em, 4.364em, -999.997em); top: -3.999em; left: 0em;"><span class="mi" id="MathJax-Span-214" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 4.005em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.481em;"><span class="texatom" id="MathJax-Span-215"><span class="mrow" id="MathJax-Span-216"><span class="mi" id="MathJax-Span-217" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.005em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.392em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.293em; border-left: 0px solid; width: 0px; height: 0.967em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-27">p_{r}</script></td>
      <td>Data distribution over real sample <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-218" style="width: 0.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.421em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.974em, 1000.42em, 2.751em, -999.997em); top: -2.566em; left: 0em;"><span class="mrow" id="MathJax-Span-219"><span class="mi" id="MathJax-Span-220" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.572em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.07em; border-left: 0px solid; width: 0px; height: 0.744em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-28">x</script></td>
      <td>&nbsp;</td>
    </tr>
  </tbody>
</table>

<p>On one hand, we want to make sure the discriminator <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-221" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.7em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-222"><span class="mi" id="MathJax-Span-223" style="font-family: STIXGeneral; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">D</script>’s decisions over real data are accurate by maximizing <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-224" style="width: 8.497em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.831em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1006.72em, 3.013em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-225"><span class="msubsup" id="MathJax-Span-226"><span style="display: inline-block; position: relative; width: 2.906em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="texatom" id="MathJax-Span-227"><span class="mrow" id="MathJax-Span-228"><span class="mi" id="MathJax-Span-229" style="font-family: STIXGeneral;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.648em;"><span class="texatom" id="MathJax-Span-230"><span class="mrow" id="MathJax-Span-231"><span class="mi" id="MathJax-Span-232" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-233" style="font-size: 70.7%; font-family: STIXGeneral;">∼</span><span class="msubsup" id="MathJax-Span-234"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-235" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.379em;"><span class="texatom" id="MathJax-Span-236"><span class="mrow" id="MathJax-Span-237"><span class="mi" id="MathJax-Span-238" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-239" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-240" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-241" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-242" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-243" style="font-family: STIXGeneral;">log</span><span class="mo" id="MathJax-Span-244"></span><span class="mi" id="MathJax-Span-245" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">D</span><span class="mo" id="MathJax-Span-246" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-247" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-248" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-249" style="font-family: STIXGeneral;">]</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.463em; border-left: 0px solid; width: 0px; height: 1.403em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>∼</mo><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">[</mo><mi>log</mi><mo>⁡</mo><mi>D</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-30">\mathbb{E}_{x \sim p_{r}(x)} [\log D(x)]</script>. Meanwhile, given a fake sample <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-250" style="width: 7.207em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.809em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1005.75em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-251"><span class="mi" id="MathJax-Span-252" style="font-family: STIXGeneral; font-style: italic;">G</span><span class="mo" id="MathJax-Span-253" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-254" style="font-family: STIXGeneral; font-style: italic;">z</span><span class="mo" id="MathJax-Span-255" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-256" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-257" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">z</span><span class="mo" id="MathJax-Span-258" style="font-family: STIXGeneral; padding-left: 0.325em;">∼</span><span class="msubsup" id="MathJax-Span-259" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-260" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-261" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-262" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-263" style="font-family: STIXGeneral; font-style: italic;">z</span><span class="mo" id="MathJax-Span-264" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>,</mo><mi>z</mi><mo>∼</mo><msub><mi>p</mi><mi>z</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-31">G(z), z \sim p_z(z)</script>, the discriminator is expected to output a probability, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-265" style="width: 3.927em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.175em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1003.12em, 2.852em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-266"><span class="mi" id="MathJax-Span-267" style="font-family: STIXGeneral; font-style: italic;">D</span><span class="mo" id="MathJax-Span-268" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-269" style="font-family: STIXGeneral; font-style: italic;">G</span><span class="mo" id="MathJax-Span-270" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-271" style="font-family: STIXGeneral; font-style: italic;">z</span><span class="mo" id="MathJax-Span-272" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-273" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi><mo stretchy="false">(</mo><mi>G</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-32">D(G(z))</script>, close to zero by maximizing <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-274" style="width: 12.745em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.272em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1010.16em, 3.067em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-275"><span class="msubsup" id="MathJax-Span-276"><span style="display: inline-block; position: relative; width: 2.798em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="texatom" id="MathJax-Span-277"><span class="mrow" id="MathJax-Span-278"><span class="mi" id="MathJax-Span-279" style="font-family: STIXGeneral;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.648em;"><span class="texatom" id="MathJax-Span-280"><span class="mrow" id="MathJax-Span-281"><span class="mi" id="MathJax-Span-282" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span class="mo" id="MathJax-Span-283" style="font-size: 70.7%; font-family: STIXGeneral;">∼</span><span class="msubsup" id="MathJax-Span-284"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-285" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.379em;"><span class="texatom" id="MathJax-Span-286"><span class="mrow" id="MathJax-Span-287"><span class="mi" id="MathJax-Span-288" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-289" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-290" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span class="mo" id="MathJax-Span-291" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-292" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-293" style="font-family: STIXGeneral;">log</span><span class="mo" id="MathJax-Span-294"></span><span class="mo" id="MathJax-Span-295" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-296" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-297" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="mi" id="MathJax-Span-298" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.272em;">D</span><span class="mo" id="MathJax-Span-299" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-300" style="font-family: STIXGeneral; font-style: italic;">G</span><span class="mo" id="MathJax-Span-301" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-302" style="font-family: STIXGeneral; font-style: italic;">z</span><span class="mo" id="MathJax-Span-303" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-304" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-305" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-306" style="font-family: STIXGeneral;">]</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.53em; border-left: 0px solid; width: 0px; height: 1.403em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mo>∼</mo><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>z</mi></mrow></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">[</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>D</mi><mo stretchy="false">(</mo><mi>G</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-33">\mathbb{E}_{z \sim p_{z}(z)} [\log (1 - D(G(z)))]</script>.</p>

<p>On the other hand, the generator is trained to increase the chances of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-307" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.7em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-308"><span class="mi" id="MathJax-Span-309" style="font-family: STIXGeneral; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-34">D</script> producing a high probability for a fake example, thus to minimize <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-310" style="width: 12.745em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.272em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1010.16em, 3.067em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-311"><span class="msubsup" id="MathJax-Span-312"><span style="display: inline-block; position: relative; width: 2.798em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="texatom" id="MathJax-Span-313"><span class="mrow" id="MathJax-Span-314"><span class="mi" id="MathJax-Span-315" style="font-family: STIXGeneral;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.648em;"><span class="texatom" id="MathJax-Span-316"><span class="mrow" id="MathJax-Span-317"><span class="mi" id="MathJax-Span-318" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span class="mo" id="MathJax-Span-319" style="font-size: 70.7%; font-family: STIXGeneral;">∼</span><span class="msubsup" id="MathJax-Span-320"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-321" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.379em;"><span class="texatom" id="MathJax-Span-322"><span class="mrow" id="MathJax-Span-323"><span class="mi" id="MathJax-Span-324" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-325" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-326" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span class="mo" id="MathJax-Span-327" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-328" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-329" style="font-family: STIXGeneral;">log</span><span class="mo" id="MathJax-Span-330"></span><span class="mo" id="MathJax-Span-331" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-332" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-333" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="mi" id="MathJax-Span-334" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.272em;">D</span><span class="mo" id="MathJax-Span-335" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-336" style="font-family: STIXGeneral; font-style: italic;">G</span><span class="mo" id="MathJax-Span-337" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-338" style="font-family: STIXGeneral; font-style: italic;">z</span><span class="mo" id="MathJax-Span-339" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-340" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-341" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-342" style="font-family: STIXGeneral;">]</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.53em; border-left: 0px solid; width: 0px; height: 1.403em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mo>∼</mo><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>z</mi></mrow></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">[</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>D</mi><mo stretchy="false">(</mo><mi>G</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-35">\mathbb{E}_{z \sim p_{z}(z)} [\log (1 - D(G(z)))]</script>.</p>

<p>When combining both aspects together, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-343" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.7em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-344"><span class="mi" id="MathJax-Span-345" style="font-family: STIXGeneral; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-36">D</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-346" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.7em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-347"><span class="mi" id="MathJax-Span-348" style="font-family: STIXGeneral; font-style: italic;">G</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-37">G</script> are playing a <strong>minimax game</strong> in which we should optimize the following loss function:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;min&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;/munder&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/munder&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-349" style="width: 33.175em; display: inline-block;"><span style="display: inline-block; position: relative; width: 26.723em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.379em, 1026.45em, 3.874em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-350"><span class="mtable" id="MathJax-Span-351" style="padding-right: 0.164em; padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 26.401em; height: 0px;"><span style="position: absolute; clip: rect(2.099em, 1006.67em, 5.056em, -999.997em); top: -3.976em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.669em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1006.67em, 4.949em, -999.997em); top: -4.997em; right: 0em;"><span class="mtd" id="MathJax-Span-352"><span class="mrow" id="MathJax-Span-353"><span class="munderover" id="MathJax-Span-354"><span style="display: inline-block; position: relative; width: 1.562em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1001.56em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mo" id="MathJax-Span-355" style="font-family: STIXGeneral;">min</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.49em, 4.25em, -999.997em); top: -3.277em; left: 0.54em;"><span class="mi" id="MathJax-Span-356" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">G</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="munderover" id="MathJax-Span-357" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.723em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1001.72em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mo" id="MathJax-Span-358" style="font-family: STIXGeneral;">max</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.49em, 4.25em, -999.997em); top: -3.277em; left: 0.594em;"><span class="mi" id="MathJax-Span-359" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mi" id="MathJax-Span-360" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-361" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-362" style="font-family: STIXGeneral; font-style: italic;">D</span><span class="mo" id="MathJax-Span-363" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-364" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">G</span><span class="mo" id="MathJax-Span-365" style="font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.82em, 1000em, 4.142em, -999.997em); top: -3.062em; right: 0em;"><span class="mtd" id="MathJax-Span-424"><span class="mrow" id="MathJax-Span-425"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(2.153em, 1019.63em, 5.54em, -999.997em); top: -4.03em; left: 6.669em;"><span style="display: inline-block; position: relative; width: 19.734em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1019.63em, 4.519em, -999.997em); top: -4.997em; left: 0em;"><span class="mtd" id="MathJax-Span-366"><span class="mrow" id="MathJax-Span-367"><span class="mi" id="MathJax-Span-368"></span><span class="mo" id="MathJax-Span-369" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="msubsup" id="MathJax-Span-370" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 2.906em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="texatom" id="MathJax-Span-371"><span class="mrow" id="MathJax-Span-372"><span class="mi" id="MathJax-Span-373" style="font-family: STIXGeneral;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.648em;"><span class="texatom" id="MathJax-Span-374"><span class="mrow" id="MathJax-Span-375"><span class="mi" id="MathJax-Span-376" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-377" style="font-size: 70.7%; font-family: STIXGeneral;">∼</span><span class="msubsup" id="MathJax-Span-378"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-379" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.379em;"><span class="texatom" id="MathJax-Span-380"><span class="mrow" id="MathJax-Span-381"><span class="mi" id="MathJax-Span-382" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-383" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-384" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-385" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-386" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-387" style="font-family: STIXGeneral;">log</span><span class="mo" id="MathJax-Span-388"></span><span class="mi" id="MathJax-Span-389" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">D</span><span class="mo" id="MathJax-Span-390" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-391" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-392" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-393" style="font-family: STIXGeneral;">]</span><span class="mo" id="MathJax-Span-394" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="msubsup" id="MathJax-Span-395" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 2.798em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="texatom" id="MathJax-Span-396"><span class="mrow" id="MathJax-Span-397"><span class="mi" id="MathJax-Span-398" style="font-family: STIXGeneral;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.648em;"><span class="texatom" id="MathJax-Span-399"><span class="mrow" id="MathJax-Span-400"><span class="mi" id="MathJax-Span-401" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span class="mo" id="MathJax-Span-402" style="font-size: 70.7%; font-family: STIXGeneral;">∼</span><span class="msubsup" id="MathJax-Span-403"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-404" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.379em;"><span class="mi" id="MathJax-Span-405" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-406" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-407" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span class="mo" id="MathJax-Span-408" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-409" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-410" style="font-family: STIXGeneral;">log</span><span class="mo" id="MathJax-Span-411"></span><span class="mo" id="MathJax-Span-412" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-413" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-414" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="mi" id="MathJax-Span-415" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.272em;">D</span><span class="mo" id="MathJax-Span-416" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-417" style="font-family: STIXGeneral; font-style: italic;">G</span><span class="mo" id="MathJax-Span-418" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-419" style="font-family: STIXGeneral; font-style: italic;">z</span><span class="mo" id="MathJax-Span-420" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-421" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-422" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-423" style="font-family: STIXGeneral;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1018.12em, 4.573em, -999.997em); top: -3.062em; left: 0em;"><span class="mtd" id="MathJax-Span-426"><span class="mrow" id="MathJax-Span-427"><span class="mi" id="MathJax-Span-428"></span><span class="mo" id="MathJax-Span-429" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="msubsup" id="MathJax-Span-430" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 2.906em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="texatom" id="MathJax-Span-431"><span class="mrow" id="MathJax-Span-432"><span class="mi" id="MathJax-Span-433" style="font-family: STIXGeneral;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.648em;"><span class="texatom" id="MathJax-Span-434"><span class="mrow" id="MathJax-Span-435"><span class="mi" id="MathJax-Span-436" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-437" style="font-size: 70.7%; font-family: STIXGeneral;">∼</span><span class="msubsup" id="MathJax-Span-438"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-439" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.379em;"><span class="texatom" id="MathJax-Span-440"><span class="mrow" id="MathJax-Span-441"><span class="mi" id="MathJax-Span-442" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-443" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-444" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-445" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-446" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-447" style="font-family: STIXGeneral;">log</span><span class="mo" id="MathJax-Span-448"></span><span class="mi" id="MathJax-Span-449" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">D</span><span class="mo" id="MathJax-Span-450" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-451" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-452" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-453" style="font-family: STIXGeneral;">]</span><span class="mo" id="MathJax-Span-454" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="msubsup" id="MathJax-Span-455" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 2.96em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="texatom" id="MathJax-Span-456"><span class="mrow" id="MathJax-Span-457"><span class="mi" id="MathJax-Span-458" style="font-family: STIXGeneral;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.648em;"><span class="texatom" id="MathJax-Span-459"><span class="mrow" id="MathJax-Span-460"><span class="mi" id="MathJax-Span-461" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-462" style="font-size: 70.7%; font-family: STIXGeneral;">∼</span><span class="msubsup" id="MathJax-Span-463"><span style="display: inline-block; position: relative; width: 0.648em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-464" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.379em;"><span class="mi" id="MathJax-Span-465" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-466" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-467" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-468" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-469" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-470" style="font-family: STIXGeneral;">log</span><span class="mo" id="MathJax-Span-471"></span><span class="mo" id="MathJax-Span-472" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-473" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-474" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="mi" id="MathJax-Span-475" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.272em;">D</span><span class="mo" id="MathJax-Span-476" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-477" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-478" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-479" style="font-family: STIXGeneral;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.035em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.73em; border-left: 0px solid; width: 0px; height: 4.07em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><munder><mo movablelimits="true" form="prefix">min</mo><mi>G</mi></munder><munder><mo movablelimits="true" form="prefix">max</mo><mi>D</mi></munder><mi>L</mi><mo stretchy="false">(</mo><mi>D</mi><mo>,</mo><mi>G</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>∼</mo><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">[</mo><mi>log</mi><mo>⁡</mo><mi>D</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>+</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mo>∼</mo><msub><mi>p</mi><mi>z</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">[</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>D</mi><mo stretchy="false">(</mo><mi>G</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>∼</mo><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">[</mo><mi>log</mi><mo>⁡</mo><mi>D</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>+</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>∼</mo><msub><mi>p</mi><mi>g</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">[</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>D</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-38">% <![CDATA[
\begin{aligned}
\min_G \max_D L(D, G) 
& = \mathbb{E}_{x \sim p_{r}(x)} [\log D(x)] + \mathbb{E}_{z \sim p_z(z)} [\log(1 - D(G(z)))] \\
& = \mathbb{E}_{x \sim p_{r}(x)} [\log D(x)] + \mathbb{E}_{x \sim p_g(x)} [\log(1 - D(x)]
\end{aligned} %]]></script>

<p>(<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-480" style="width: 8.497em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.831em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1006.72em, 3.013em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-481"><span class="msubsup" id="MathJax-Span-482"><span style="display: inline-block; position: relative; width: 2.906em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="texatom" id="MathJax-Span-483"><span class="mrow" id="MathJax-Span-484"><span class="mi" id="MathJax-Span-485" style="font-family: STIXGeneral;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.648em;"><span class="texatom" id="MathJax-Span-486"><span class="mrow" id="MathJax-Span-487"><span class="mi" id="MathJax-Span-488" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-489" style="font-size: 70.7%; font-family: STIXGeneral;">∼</span><span class="msubsup" id="MathJax-Span-490"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-491" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.379em;"><span class="texatom" id="MathJax-Span-492"><span class="mrow" id="MathJax-Span-493"><span class="mi" id="MathJax-Span-494" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-495" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-496" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-497" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-498" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-499" style="font-family: STIXGeneral;">log</span><span class="mo" id="MathJax-Span-500"></span><span class="mi" id="MathJax-Span-501" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">D</span><span class="mo" id="MathJax-Span-502" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-503" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-504" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-505" style="font-family: STIXGeneral;">]</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.463em; border-left: 0px solid; width: 0px; height: 1.403em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>∼</mo><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">[</mo><mi>log</mi><mo>⁡</mo><mi>D</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-39">\mathbb{E}_{x \sim p_{r}(x)} [\log D(x)]</script> has no impact on <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-506" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.7em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-507"><span class="mi" id="MathJax-Span-508" style="font-family: STIXGeneral; font-style: italic;">G</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-40">G</script> during gradient descent updates.)</p>

<h3 id="what-is-the-optimal-value-for-d">What is the optimal value for D?</h3>

<p>Now we have a well-defined loss function. Let’s first examine what is the best value for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-509" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.7em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-510"><span class="mi" id="MathJax-Span-511" style="font-family: STIXGeneral; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-41">D</script>.</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-512" style="width: 28.444em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.906em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.422em, 1022.91em, 5.218em, -999.997em); top: -4.083em; left: 0em;"><span class="mrow" id="MathJax-Span-513"><span class="mi" id="MathJax-Span-514" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-515" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-516" style="font-family: STIXGeneral; font-style: italic;">G</span><span class="mo" id="MathJax-Span-517" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-518" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">D</span><span class="mo" id="MathJax-Span-519" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-520" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="msubsup" id="MathJax-Span-521" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.02em, 5.003em, -999.997em); top: -3.976em; left: 0em;"><span class="mo" id="MathJax-Span-522" style="font-family: STIXIntegralsD; vertical-align: -0.589em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.433em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.062em; left: 0.594em;"><span class="mi" id="MathJax-Span-523" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="texatom" id="MathJax-Span-524" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-525"><span class="mo" id="MathJax-Span-526" style="vertical-align: -0.589em;"><span style="font-family: STIXSizeThreeSym;">(</span></span></span></span><span class="msubsup" id="MathJax-Span-527"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-528" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="texatom" id="MathJax-Span-529"><span class="mrow" id="MathJax-Span-530"><span class="mi" id="MathJax-Span-531" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-532" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-533" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-534" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-535" style="font-family: STIXGeneral; padding-left: 0.164em;">log</span><span class="mo" id="MathJax-Span-536"></span><span class="mo" id="MathJax-Span-537" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-538" style="font-family: STIXGeneral; font-style: italic;">D</span><span class="mo" id="MathJax-Span-539" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-540" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-541" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-542" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-543" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="msubsup" id="MathJax-Span-544" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-545" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-546" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-547" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-548" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-549" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-550" style="font-family: STIXGeneral; padding-left: 0.164em;">log</span><span class="mo" id="MathJax-Span-551"></span><span class="mo" id="MathJax-Span-552" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-553" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-554" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="mi" id="MathJax-Span-555" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.272em;">D</span><span class="mo" id="MathJax-Span-556" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-557" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-558" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-559" style="font-family: STIXGeneral;">)</span><span class="texatom" id="MathJax-Span-560"><span class="mrow" id="MathJax-Span-561"><span class="mo" id="MathJax-Span-562" style="vertical-align: -0.589em;"><span style="font-family: STIXSizeThreeSym;">)</span></span></span></span><span class="mi" id="MathJax-Span-563" style="font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-564" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.089em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.263em; border-left: 0px solid; width: 0px; height: 3.203em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>L</mi><mo stretchy="false">(</mo><mi>G</mi><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mo>∫</mo><mi>x</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>D</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><msub><mi>p</mi><mi>g</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>D</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow><mi>d</mi><mi>x</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-42">L(G, D) = \int_x \bigg( p_{r}(x) \log(D(x)) + p_g (x) \log(1 - D(x)) \bigg) dx</script>

<p>Since we are interested in what is the best value of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-565" style="width: 2.261em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.831em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1001.78em, 2.852em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-566"><span class="mi" id="MathJax-Span-567" style="font-family: STIXGeneral; font-style: italic;">D</span><span class="mo" id="MathJax-Span-568" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-569" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-570" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-43">D(x)</script> to maximize <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-571" style="width: 3.82em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.067em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1003.01em, 2.852em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-572"><span class="mi" id="MathJax-Span-573" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-574" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-575" style="font-family: STIXGeneral; font-style: italic;">G</span><span class="mo" id="MathJax-Span-576" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-577" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">D</span><span class="mo" id="MathJax-Span-578" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo stretchy="false">(</mo><mi>G</mi><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-44">L(G, D)</script>, let us label</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-579" style="width: 15.272em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.315em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1012.26em, 2.96em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-580"><span class="texatom" id="MathJax-Span-581"><span class="mrow" id="MathJax-Span-582"><span class="munderover" id="MathJax-Span-583"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-584" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.03em; left: 0.11em;"><span style="height: 0em; vertical-align: 0em; width: 0.379em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-585" style="font-family: STIXGeneral;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.266em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-586" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mi" id="MathJax-Span-587" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.325em;">D</span><span class="mo" id="MathJax-Span-588" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-589" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-590" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-591" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-592" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">A</span><span class="mo" id="MathJax-Span-593" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="msubsup" id="MathJax-Span-594" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-595" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="texatom" id="MathJax-Span-596"><span class="mrow" id="MathJax-Span-597"><span class="mi" id="MathJax-Span-598" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-599" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-600" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-601" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-602" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-603" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">B</span><span class="mo" id="MathJax-Span-604" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="msubsup" id="MathJax-Span-605" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-606" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-607" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-608" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-609" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-610" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.337em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">~</mo></mover></mrow><mo>=</mo><mi>D</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>,</mo><mi>A</mi><mo>=</mo><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>,</mo><mi>B</mi><mo>=</mo><msub><mi>p</mi><mi>g</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-45">\tilde{x} = D(x), 
A=p_{r}(x), 
B=p_g(x)</script>

<p>And then what is inside the integral (we can safely ignore the integral because <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-611" style="width: 0.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.43em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-612"><span class="mi" id="MathJax-Span-613" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.67em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-46">x</script> is sampled over all the possible values) is:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-614" style="width: 17.637em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.196em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-2.363em, 1014.03em, 6.562em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-615"><span class="mtable" id="MathJax-Span-616" style="padding-right: 0.164em; padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 13.874em; height: 0px;"><span style="position: absolute; clip: rect(4.035em, 1002.42em, 11.992em, -999.997em); top: -8.653em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.422em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1001.51em, 4.358em, -999.997em); top: -7.739em; right: 0em;"><span class="mtd" id="MathJax-Span-617"><span class="mrow" id="MathJax-Span-618"><span class="mi" id="MathJax-Span-619" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span><span class="mo" id="MathJax-Span-620" style="font-family: STIXGeneral;">(</span><span class="texatom" id="MathJax-Span-621"><span class="mrow" id="MathJax-Span-622"><span class="munderover" id="MathJax-Span-623"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-624" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.03em; left: 0.11em;"><span style="height: 0em; vertical-align: 0em; width: 0.379em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-625" style="font-family: STIXGeneral;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.266em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-626" style="font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(2.476em, 1002.42em, 4.841em, -999.997em); top: -5.804em; right: 0em;"><span class="mtd" id="MathJax-Span-654"><span class="mrow" id="MathJax-Span-655"><span class="mfrac" id="MathJax-Span-656"><span style="display: inline-block; position: relative; width: 2.207em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1001.99em, 4.358em, -999.997em); top: -4.675em; left: 50%; margin-left: -1.019em;"><span class="mrow" id="MathJax-Span-657"><span class="mi" id="MathJax-Span-658" style="font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-659" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span><span class="mo" id="MathJax-Span-660" style="font-family: STIXGeneral;">(</span><span class="texatom" id="MathJax-Span-661"><span class="mrow" id="MathJax-Span-662"><span class="munderover" id="MathJax-Span-663"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-664" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.03em; left: 0.11em;"><span style="height: 0em; vertical-align: 0em; width: 0.379em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-665" style="font-family: STIXGeneral;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.266em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-666" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1000.97em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.481em;"><span class="mrow" id="MathJax-Span-667"><span class="mi" id="MathJax-Span-668" style="font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="texatom" id="MathJax-Span-669"><span class="mrow" id="MathJax-Span-670"><span class="munderover" id="MathJax-Span-671"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-672" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.03em; left: 0.11em;"><span style="height: 0em; vertical-align: 0em; width: 0.379em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-673" style="font-family: STIXGeneral;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.266em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1002.21em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.207em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.82em, 1000em, 4.142em, -999.997em); top: -3.331em; right: 0em;"><span class="mtd" id="MathJax-Span-710"><span class="mrow" id="MathJax-Span-711"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.82em, 1000em, 4.142em, -999.997em); top: -0.804em; right: 0em;"><span class="mtd" id="MathJax-Span-742"><span class="mrow" id="MathJax-Span-743"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.659em;"></span></span><span style="position: absolute; clip: rect(4.895em, 1011.45em, 13.712em, -999.997em); top: -9.513em; left: 2.422em;"><span style="display: inline-block; position: relative; width: 11.454em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1009.57em, 4.358em, -999.997em); top: -7.739em; left: 0em;"><span class="mtd" id="MathJax-Span-627"><span class="mrow" id="MathJax-Span-628"><span class="mi" id="MathJax-Span-629"></span><span class="mo" id="MathJax-Span-630" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mi" id="MathJax-Span-631" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.325em;">A</span><span class="mi" id="MathJax-Span-632" style="font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-633" style="font-family: STIXGeneral; font-style: italic;">o</span><span class="mi" id="MathJax-Span-634" style="font-family: STIXGeneral; font-style: italic;">g</span><span class="texatom" id="MathJax-Span-635"><span class="mrow" id="MathJax-Span-636"><span class="munderover" id="MathJax-Span-637"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-638" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.03em; left: 0.11em;"><span style="height: 0em; vertical-align: 0em; width: 0.379em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-639" style="font-family: STIXGeneral;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.266em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-640" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="mi" id="MathJax-Span-641" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.272em;">B</span><span class="mi" id="MathJax-Span-642" style="font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-643" style="font-family: STIXGeneral; font-style: italic;">o</span><span class="mi" id="MathJax-Span-644" style="font-family: STIXGeneral; font-style: italic;">g</span><span class="mo" id="MathJax-Span-645" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-646" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-647" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="texatom" id="MathJax-Span-648" style="padding-left: 0.272em;"><span class="mrow" id="MathJax-Span-649"><span class="munderover" id="MathJax-Span-650"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-651" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.03em; left: 0.11em;"><span style="height: 0em; vertical-align: 0em; width: 0.379em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-652" style="font-family: STIXGeneral;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.266em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-653" style="font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(2.476em, 1011.45em, 4.949em, -999.997em); top: -5.804em; left: 0em;"><span class="mtd" id="MathJax-Span-674"><span class="mrow" id="MathJax-Span-675"><span class="mi" id="MathJax-Span-676"></span><span class="mo" id="MathJax-Span-677" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mi" id="MathJax-Span-678" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.325em;">A</span><span class="mfrac" id="MathJax-Span-679"><span style="display: inline-block; position: relative; width: 1.884em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-680" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1001.78em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.911em;"><span class="mrow" id="MathJax-Span-681"><span class="mi" id="MathJax-Span-682" style="font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-683" style="font-family: STIXGeneral; font-style: italic;">n</span><span class="mn" id="MathJax-Span-684" style="font-family: STIXGeneral;">10</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1001.88em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.884em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-685"><span style="display: inline-block; position: relative; width: 0.648em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-686" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1000.43em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.212em;"><span class="texatom" id="MathJax-Span-687"><span class="mrow" id="MathJax-Span-688"><span class="munderover" id="MathJax-Span-689"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-690" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.03em; left: 0.11em;"><span style="height: 0em; vertical-align: 0em; width: 0.379em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-691" style="font-family: STIXGeneral;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.266em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1000.65em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.648em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-692" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="mi" id="MathJax-Span-693" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.272em;">B</span><span class="mfrac" id="MathJax-Span-694"><span style="display: inline-block; position: relative; width: 1.884em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-695" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1001.78em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.911em;"><span class="mrow" id="MathJax-Span-696"><span class="mi" id="MathJax-Span-697" style="font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-698" style="font-family: STIXGeneral; font-style: italic;">n</span><span class="mn" id="MathJax-Span-699" style="font-family: STIXGeneral;">10</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1001.88em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.884em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-700"><span style="display: inline-block; position: relative; width: 2.315em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-701" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1002.15em, 4.304em, -999.997em); top: -3.277em; left: 50%; margin-left: -1.073em;"><span class="mrow" id="MathJax-Span-702"><span class="mn" id="MathJax-Span-703" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-704" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="texatom" id="MathJax-Span-705" style="padding-left: 0.272em;"><span class="mrow" id="MathJax-Span-706"><span class="munderover" id="MathJax-Span-707"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-708" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.03em; left: 0.11em;"><span style="height: 0em; vertical-align: 0em; width: 0.379em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-709" style="font-family: STIXGeneral;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.266em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1002.32em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.315em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(2.476em, 1008.82em, 4.949em, -999.997em); top: -3.331em; left: 0em;"><span class="mtd" id="MathJax-Span-712"><span class="mrow" id="MathJax-Span-713"><span class="mi" id="MathJax-Span-714"></span><span class="mo" id="MathJax-Span-715" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mfrac" id="MathJax-Span-716" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 1.884em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-717" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1001.78em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.911em;"><span class="mrow" id="MathJax-Span-718"><span class="mi" id="MathJax-Span-719" style="font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-720" style="font-family: STIXGeneral; font-style: italic;">n</span><span class="mn" id="MathJax-Span-721" style="font-family: STIXGeneral;">10</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1001.88em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.884em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-722" style="font-family: STIXGeneral;">(</span><span class="mfrac" id="MathJax-Span-723"><span style="display: inline-block; position: relative; width: 0.755em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.175em, 1000.54em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.32em;"><span class="mi" id="MathJax-Span-724" style="font-family: STIXGeneral; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1000.43em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.212em;"><span class="texatom" id="MathJax-Span-725"><span class="mrow" id="MathJax-Span-726"><span class="munderover" id="MathJax-Span-727"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-728" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.03em; left: 0.11em;"><span style="height: 0em; vertical-align: 0em; width: 0.379em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-729" style="font-family: STIXGeneral;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.266em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1000.75em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.755em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-730" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="mfrac" id="MathJax-Span-731" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 2.315em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.32em;"><span class="mi" id="MathJax-Span-732" style="font-family: STIXGeneral; font-style: italic;">B</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1002.15em, 4.304em, -999.997em); top: -3.277em; left: 50%; margin-left: -1.073em;"><span class="mrow" id="MathJax-Span-733"><span class="mn" id="MathJax-Span-734" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-735" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="texatom" id="MathJax-Span-736" style="padding-left: 0.272em;"><span class="mrow" id="MathJax-Span-737"><span class="munderover" id="MathJax-Span-738"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-739" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.03em; left: 0.11em;"><span style="height: 0em; vertical-align: 0em; width: 0.379em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-740" style="font-family: STIXGeneral;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.266em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1002.32em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.315em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-741" style="font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(2.476em, 1009.25em, 5.003em, -999.997em); top: -0.804em; left: 0em;"><span class="mtd" id="MathJax-Span-744"><span class="mrow" id="MathJax-Span-745"><span class="mi" id="MathJax-Span-746"></span><span class="mo" id="MathJax-Span-747" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mfrac" id="MathJax-Span-748" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 1.884em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-749" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1001.78em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.911em;"><span class="mrow" id="MathJax-Span-750"><span class="mi" id="MathJax-Span-751" style="font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-752" style="font-family: STIXGeneral; font-style: italic;">n</span><span class="mn" id="MathJax-Span-753" style="font-family: STIXGeneral;">10</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1001.88em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.884em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-754"><span style="display: inline-block; position: relative; width: 5.54em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1005.43em, 4.304em, -999.997em); top: -4.675em; left: 50%; margin-left: -2.685em;"><span class="mrow" id="MathJax-Span-755"><span class="mi" id="MathJax-Span-756" style="font-family: STIXGeneral; font-style: italic;">A</span><span class="mo" id="MathJax-Span-757" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="mo" id="MathJax-Span-758" style="font-family: STIXGeneral; padding-left: 0.272em;">(</span><span class="mi" id="MathJax-Span-759" style="font-family: STIXGeneral; font-style: italic;">A</span><span class="mo" id="MathJax-Span-760" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="mi" id="MathJax-Span-761" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.272em;">B</span><span class="mo" id="MathJax-Span-762" style="font-family: STIXGeneral;">)</span><span class="texatom" id="MathJax-Span-763"><span class="mrow" id="MathJax-Span-764"><span class="munderover" id="MathJax-Span-765"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-766" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.03em; left: 0.11em;"><span style="height: 0em; vertical-align: 0em; width: 0.379em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-767" style="font-family: STIXGeneral;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.266em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1003.23em, 4.304em, -999.997em); top: -3.277em; left: 50%; margin-left: -1.664em;"><span class="mrow" id="MathJax-Span-768"><span class="texatom" id="MathJax-Span-769"><span class="mrow" id="MathJax-Span-770"><span class="munderover" id="MathJax-Span-771"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-772" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.03em; left: 0.11em;"><span style="height: 0em; vertical-align: 0em; width: 0.379em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-773" style="font-family: STIXGeneral;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.266em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-774" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-775" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-776" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="texatom" id="MathJax-Span-777" style="padding-left: 0.272em;"><span class="mrow" id="MathJax-Span-778"><span class="munderover" id="MathJax-Span-779"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-780" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.03em; left: 0.11em;"><span style="height: 0em; vertical-align: 0em; width: 0.379em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-781" style="font-family: STIXGeneral;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.266em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-782" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1005.54em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.54em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.519em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -5.063em; border-left: 0px solid; width: 0px; height: 10.803em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>f</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">~</mo></mover></mrow><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mi>A</mi><mi>l</mi><mi>o</mi><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">~</mo></mover></mrow><mo>+</mo><mi>B</mi><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">~</mo></mover></mrow><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mfrac><mrow><mi>d</mi><mi>f</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">~</mo></mover></mrow></mrow></mfrac></mtd><mtd><mi></mi><mo>=</mo><mi>A</mi><mfrac><mn>1</mn><mrow><mi>l</mi><mi>n</mi><mn>10</mn></mrow></mfrac><mfrac><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">~</mo></mover></mrow></mfrac><mo>−</mo><mi>B</mi><mfrac><mn>1</mn><mrow><mi>l</mi><mi>n</mi><mn>10</mn></mrow></mfrac><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">~</mo></mover></mrow></mrow></mfrac></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mfrac><mn>1</mn><mrow><mi>l</mi><mi>n</mi><mn>10</mn></mrow></mfrac><mo stretchy="false">(</mo><mfrac><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">~</mo></mover></mrow></mfrac><mo>−</mo><mfrac><mi>B</mi><mrow><mn>1</mn><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">~</mo></mover></mrow></mrow></mfrac><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mfrac><mn>1</mn><mrow><mi>l</mi><mi>n</mi><mn>10</mn></mrow></mfrac><mfrac><mrow><mi>A</mi><mo>−</mo><mo stretchy="false">(</mo><mi>A</mi><mo>+</mo><mi>B</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">~</mo></mover></mrow></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">~</mo></mover></mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">~</mo></mover></mrow><mo stretchy="false">)</mo></mrow></mfrac></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-47">% <![CDATA[
\begin{aligned}
f(\tilde{x}) 
& = A log\tilde{x} + B log(1-\tilde{x}) \\

\frac{d f(\tilde{x})}{d \tilde{x}}
& = A \frac{1}{ln10} \frac{1}{\tilde{x}} - B \frac{1}{ln10} \frac{1}{1 - \tilde{x}} \\
& = \frac{1}{ln10} (\frac{A}{\tilde{x}} - \frac{B}{1-\tilde{x}}) \\
& = \frac{1}{ln10} \frac{A - (A + B)\tilde{x}}{\tilde{x} (1 - \tilde{x})} \\
\end{aligned} %]]></script>

<p>Thus, set <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-783" style="width: 4.465em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.605em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.293em, 1003.61em, 3.121em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-784"><span class="mfrac" id="MathJax-Span-785"><span style="display: inline-block; position: relative; width: 1.562em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.282em, 1001.45em, 4.304em, -999.997em); top: -4.513em; left: 50%; margin-left: -0.75em;"><span class="mrow" id="MathJax-Span-786"><span class="mi" id="MathJax-Span-787" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-788" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-789" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="texatom" id="MathJax-Span-790"><span class="mrow" id="MathJax-Span-791"><span class="munderover" id="MathJax-Span-792"><span style="display: inline-block; position: relative; width: 0.325em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-793" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.03em; left: 0.056em;"><span style="height: 0em; vertical-align: 0em; width: 0.272em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-794" style="font-size: 70.7%; font-family: STIXGeneral;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.159em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-795" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.282em, 1000.7em, 4.142em, -999.997em); top: -3.546em; left: 50%; margin-left: -0.32em;"><span class="mrow" id="MathJax-Span-796"><span class="mi" id="MathJax-Span-797" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-798"><span class="mrow" id="MathJax-Span-799"><span class="munderover" id="MathJax-Span-800"><span style="display: inline-block; position: relative; width: 0.325em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-801" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.03em; left: 0.056em;"><span style="height: 0em; vertical-align: 0em; width: 0.272em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-802" style="font-size: 70.7%; font-family: STIXGeneral;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.159em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1001.56em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.562em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-803" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-804" style="font-family: STIXGeneral; padding-left: 0.325em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.597em; border-left: 0px solid; width: 0px; height: 2.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi>d</mi><mi>f</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">~</mo></mover></mrow></mrow></mfrac><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-48">\frac{d f(\tilde{x})}{d \tilde{x}} = 0</script>, we get the best value of the discriminator: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-805" style="width: 19.841em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.97em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.293em, 1015.86em, 3.336em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-806"><span class="msubsup" id="MathJax-Span-807"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-808" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.702em;"><span class="mo" id="MathJax-Span-809" style="font-size: 70.7%; font-family: STIXGeneral;">∗</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-810" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-811" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-812" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-813" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="msubsup" id="MathJax-Span-814" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="texatom" id="MathJax-Span-815"><span class="mrow" id="MathJax-Span-816"><span class="munderover" id="MathJax-Span-817"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-818" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.03em; left: 0.11em;"><span style="height: 0em; vertical-align: 0em; width: 0.379em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-819" style="font-family: STIXGeneral;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.266em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.406em; left: 0.433em;"><span class="mo" id="MathJax-Span-820" style="font-size: 70.7%; font-family: STIXGeneral;">∗</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-821" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mfrac" id="MathJax-Span-822" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 1.454em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.336em, 1000.38em, 4.142em, -999.997em); top: -4.406em; left: 50%; margin-left: -0.212em;"><span class="mi" id="MathJax-Span-823" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1001.35em, 4.196em, -999.997em); top: -3.599em; left: 50%; margin-left: -0.696em;"><span class="mrow" id="MathJax-Span-824"><span class="mi" id="MathJax-Span-825" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">A</span><span class="mo" id="MathJax-Span-826" style="font-size: 70.7%; font-family: STIXGeneral;">+</span><span class="mi" id="MathJax-Span-827" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">B</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1001.45em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.454em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-828" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mfrac" id="MathJax-Span-829" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 3.444em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.336em, 1001.35em, 4.304em, -999.997em); top: -4.567em; left: 50%; margin-left: -0.696em;"><span class="mrow" id="MathJax-Span-830"><span class="msubsup" id="MathJax-Span-831"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-832" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.379em;"><span class="texatom" id="MathJax-Span-833"><span class="mrow" id="MathJax-Span-834"><span class="mi" id="MathJax-Span-835" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-836" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-837" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-838" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1003.28em, 4.411em, -999.997em); top: -3.599em; left: 50%; margin-left: -1.664em;"><span class="mrow" id="MathJax-Span-839"><span class="msubsup" id="MathJax-Span-840"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-841" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.379em;"><span class="texatom" id="MathJax-Span-842"><span class="mrow" id="MathJax-Span-843"><span class="mi" id="MathJax-Span-844" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-845" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-846" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-847" style="font-size: 70.7%; font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-848" style="font-size: 70.7%; font-family: STIXGeneral;">+</span><span class="msubsup" id="MathJax-Span-849"><span style="display: inline-block; position: relative; width: 0.648em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-850" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.379em;"><span class="mi" id="MathJax-Span-851" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-852" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-853" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-854" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1003.44em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.444em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-855" style="font-family: STIXGeneral; padding-left: 0.325em;">∈</span><span class="mo" id="MathJax-Span-856" style="font-family: STIXGeneral; padding-left: 0.325em;">[</span><span class="mn" id="MathJax-Span-857" style="font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-858" style="font-family: STIXGeneral;">,</span><span class="mn" id="MathJax-Span-859" style="font-family: STIXGeneral; padding-left: 0.164em;">1</span><span class="mo" id="MathJax-Span-860" style="font-family: STIXGeneral;">]</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.863em; border-left: 0px solid; width: 0px; height: 2.27em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>D</mi><mo>∗</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">~</mo></mover></mrow><mo>∗</mo></msup><mo>=</mo><mfrac><mi>A</mi><mrow><mi>A</mi><mo>+</mo><mi>B</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>p</mi><mi>g</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-49">D^*(x) = \tilde{x}^* = \frac{A}{A + B} = \frac{p_{r}(x)}{p_{r}(x) + p_g(x)} \in [0, 1]</script>.</p>

<p>Once the generator is trained to its optimal, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-861" style="width: 1.132em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.777em, 1000.92em, 2.798em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-862"><span class="msubsup" id="MathJax-Span-863"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-864" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-865" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.07em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>g</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-50">p_g</script> gets very close to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-866" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.777em, 1000.86em, 2.745em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-867"><span class="msubsup" id="MathJax-Span-868"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-869" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="texatom" id="MathJax-Span-870"><span class="mrow" id="MathJax-Span-871"><span class="mi" id="MathJax-Span-872" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-51">p_{r}</script>. When <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-873" style="width: 3.874em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.121em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1003.12em, 2.96em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-874"><span class="msubsup" id="MathJax-Span-875"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-876" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-877" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-878" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="msubsup" id="MathJax-Span-879" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-880" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="texatom" id="MathJax-Span-881"><span class="mrow" id="MathJax-Span-882"><span class="mi" id="MathJax-Span-883" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.07em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>g</mi></msub><mo>=</mo><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-52">p_g = p_{r}</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-884" style="width: 2.906em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.315em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1002.26em, 2.852em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-885"><span class="msubsup" id="MathJax-Span-886"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-887" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.702em;"><span class="mo" id="MathJax-Span-888" style="font-size: 70.7%; font-family: STIXGeneral;">∗</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-889" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-890" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-891" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>D</mi><mo>∗</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-53">D^*(x)</script> becomes <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-892" style="width: 1.616em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.293em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1001.29em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-893"><span class="mn" id="MathJax-Span-894" style="font-family: STIXGeneral;">1</span><span class="texatom" id="MathJax-Span-895"><span class="mrow" id="MathJax-Span-896"><span class="mo" id="MathJax-Span-897" style="font-family: STIXGeneral;">/</span></span></span><span class="mn" id="MathJax-Span-898" style="font-family: STIXGeneral;">2</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-54">1/2</script>.</p>

<h3 id="what-is-the-global-optimal">What is the global optimal?</h3>

<p>When both <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-899" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.7em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-900"><span class="mi" id="MathJax-Span-901" style="font-family: STIXGeneral; font-style: italic;">G</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-55">G</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-902" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.7em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-903"><span class="mi" id="MathJax-Span-904" style="font-family: STIXGeneral; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-56">D</script> are at their optimal values, we have <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-905" style="width: 3.874em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.121em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1003.12em, 2.96em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-906"><span class="msubsup" id="MathJax-Span-907"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-908" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-909" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-910" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="msubsup" id="MathJax-Span-911" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-912" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="texatom" id="MathJax-Span-913"><span class="mrow" id="MathJax-Span-914"><span class="mi" id="MathJax-Span-915" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.07em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>g</mi></msub><mo>=</mo><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-57">p_g = p_{r}</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-916" style="width: 6.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.895em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1004.89em, 2.852em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-917"><span class="msubsup" id="MathJax-Span-918"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-919" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.702em;"><span class="mo" id="MathJax-Span-920" style="font-size: 70.7%; font-family: STIXGeneral;">∗</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-921" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-922" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-923" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-924" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-925" style="font-family: STIXGeneral; padding-left: 0.325em;">1</span><span class="texatom" id="MathJax-Span-926"><span class="mrow" id="MathJax-Span-927"><span class="mo" id="MathJax-Span-928" style="font-family: STIXGeneral;">/</span></span></span><span class="mn" id="MathJax-Span-929" style="font-family: STIXGeneral;">2</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>D</mi><mo>∗</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-58">D^*(x) = 1/2</script> and the loss function becomes:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-930" style="width: 30.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.626em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-1.288em, 1024.46em, 5.487em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-931"><span class="mtable" id="MathJax-Span-932" style="padding-right: 0.164em; padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 24.304em; height: 0px;"><span style="position: absolute; clip: rect(3.605em, 1003.5em, 9.411em, -999.997em); top: -6.503em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.551em; height: 0px;"><span style="position: absolute; clip: rect(3.067em, 1003.5em, 4.304em, -999.997em); top: -5.965em; right: 0em;"><span class="mtd" id="MathJax-Span-933"><span class="mrow" id="MathJax-Span-934"><span class="mi" id="MathJax-Span-935" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-936" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-937" style="font-family: STIXGeneral; font-style: italic;">G</span><span class="mo" id="MathJax-Span-938" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-939" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-940" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.406em; left: 0.702em;"><span class="mo" id="MathJax-Span-941" style="font-size: 70.7%; font-family: STIXGeneral;">∗</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-942" style="font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.82em, 1000em, 4.142em, -999.997em); top: -3.277em; right: 0em;"><span class="mtd" id="MathJax-Span-995"><span class="mrow" id="MathJax-Span-996"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.82em, 1000em, 4.142em, -999.997em); top: -1.234em; right: 0em;"><span class="mtd" id="MathJax-Span-1036"><span class="mrow" id="MathJax-Span-1037"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.508em;"></span></span><span style="position: absolute; clip: rect(3.82em, 1020.75em, 10.594em, -999.997em); top: -7.47em; left: 3.551em;"><span style="display: inline-block; position: relative; width: 20.755em; height: 0px;"><span style="position: absolute; clip: rect(2.315em, 1020.75em, 5.11em, -999.997em); top: -5.965em; left: 0em;"><span class="mtd" id="MathJax-Span-943"><span class="mrow" id="MathJax-Span-944"><span class="mi" id="MathJax-Span-945"></span><span class="mo" id="MathJax-Span-946" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="msubsup" id="MathJax-Span-947" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.02em, 5.003em, -999.997em); top: -3.976em; left: 0em;"><span class="mo" id="MathJax-Span-948" style="font-family: STIXIntegralsD; vertical-align: -0.589em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.433em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.062em; left: 0.594em;"><span class="mi" id="MathJax-Span-949" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="texatom" id="MathJax-Span-950" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-951"><span class="mo" id="MathJax-Span-952" style="vertical-align: -0.589em;"><span style="font-family: STIXSizeThreeSym;">(</span></span></span></span><span class="msubsup" id="MathJax-Span-953"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-954" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="texatom" id="MathJax-Span-955"><span class="mrow" id="MathJax-Span-956"><span class="mi" id="MathJax-Span-957" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-958" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-959" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-960" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-961" style="font-family: STIXGeneral; padding-left: 0.164em;">log</span><span class="mo" id="MathJax-Span-962"></span><span class="mo" id="MathJax-Span-963" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-964"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-965" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.406em; left: 0.702em;"><span class="mo" id="MathJax-Span-966" style="font-size: 70.7%; font-family: STIXGeneral;">∗</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-967" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-968" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-969" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-970" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-971" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="msubsup" id="MathJax-Span-972" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-973" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-974" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-975" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-976" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-977" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-978" style="font-family: STIXGeneral; padding-left: 0.164em;">log</span><span class="mo" id="MathJax-Span-979"></span><span class="mo" id="MathJax-Span-980" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-981" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-982" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="msubsup" id="MathJax-Span-983" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-984" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.406em; left: 0.702em;"><span class="mo" id="MathJax-Span-985" style="font-size: 70.7%; font-family: STIXGeneral;">∗</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-986" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-987" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-988" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-989" style="font-family: STIXGeneral;">)</span><span class="texatom" id="MathJax-Span-990"><span class="mrow" id="MathJax-Span-991"><span class="mo" id="MathJax-Span-992" style="vertical-align: -0.589em;"><span style="font-family: STIXSizeThreeSym;">)</span></span></span></span><span class="mi" id="MathJax-Span-993" style="font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-994" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(2.422em, 1015.86em, 5.056em, -999.997em); top: -3.277em; left: 0em;"><span class="mtd" id="MathJax-Span-997"><span class="mrow" id="MathJax-Span-998"><span class="mi" id="MathJax-Span-999"></span><span class="mo" id="MathJax-Span-1000" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mi" id="MathJax-Span-1001" style="font-family: STIXGeneral; padding-left: 0.325em;">log</span><span class="mo" id="MathJax-Span-1002"></span><span class="mfrac" id="MathJax-Span-1003" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.648em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-1004" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1000.49em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-1005" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1000.65em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.648em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1006" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.02em, 5.003em, -999.997em); top: -3.976em; left: 0em;"><span class="mo" id="MathJax-Span-1007" style="font-family: STIXIntegralsD; vertical-align: -0.589em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.433em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.062em; left: 0.594em;"><span class="mi" id="MathJax-Span-1008" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1009" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1010" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="texatom" id="MathJax-Span-1011"><span class="mrow" id="MathJax-Span-1012"><span class="mi" id="MathJax-Span-1013" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1014" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-1015" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1016" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-1017" style="font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-1018" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1019" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="mi" id="MathJax-Span-1020" style="font-family: STIXGeneral; padding-left: 0.272em;">log</span><span class="mo" id="MathJax-Span-1021"></span><span class="mfrac" id="MathJax-Span-1022" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.648em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-1023" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1000.49em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-1024" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1000.65em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.648em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1025" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.02em, 5.003em, -999.997em); top: -3.976em; left: 0em;"><span class="mo" id="MathJax-Span-1026" style="font-family: STIXIntegralsD; vertical-align: -0.589em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.433em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.062em; left: 0.594em;"><span class="mi" id="MathJax-Span-1027" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1028" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1029" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1030" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1031" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-1032" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1033" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-1034" style="font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-1035" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1004.63em, 4.358em, -999.997em); top: -1.234em; left: 0em;"><span class="mtd" id="MathJax-Span-1038"><span class="mrow" id="MathJax-Span-1039"><span class="mi" id="MathJax-Span-1040"></span><span class="mo" id="MathJax-Span-1041" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mo" id="MathJax-Span-1042" style="font-family: STIXGeneral; padding-left: 0.325em;">−</span><span class="mn" id="MathJax-Span-1043" style="font-family: STIXGeneral;">2</span><span class="mi" id="MathJax-Span-1044" style="font-family: STIXGeneral; padding-left: 0.164em;">log</span><span class="mo" id="MathJax-Span-1045"></span><span class="mn" id="MathJax-Span-1046" style="font-family: STIXGeneral; padding-left: 0.164em;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.476em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.73em; border-left: 0px solid; width: 0px; height: 8.137em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>L</mi><mo stretchy="false">(</mo><mi>G</mi><mo>,</mo><msup><mi>D</mi><mo>∗</mo></msup><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><msub><mo>∫</mo><mi>x</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msup><mi>D</mi><mo>∗</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><msub><mi>p</mi><mi>g</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msup><mi>D</mi><mo>∗</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow><mi>d</mi><mi>x</mi></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mi>log</mi><mo>⁡</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mo>∫</mo><mi>x</mi></msub><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>d</mi><mi>x</mi><mo>+</mo><mi>log</mi><mo>⁡</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mo>∫</mo><mi>x</mi></msub><msub><mi>p</mi><mi>g</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>d</mi><mi>x</mi></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mo>−</mo><mn>2</mn><mi>log</mi><mo>⁡</mo><mn>2</mn></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-59">% <![CDATA[
\begin{aligned}
L(G, D^*) 
&= \int_x \bigg( p_{r}(x) \log(D^*(x)) + p_g (x) \log(1 - D^*(x)) \bigg) dx \\
&= \log \frac{1}{2} \int_x p_{r}(x) dx + \log \frac{1}{2} \int_x p_g(x) dx \\
&= -2\log2
\end{aligned} %]]></script>

<h3 id="what-does-the-loss-function-represent">What does the loss function represent?</h3>

<p>According to the formula listed in the <a href="https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html#kullbackleibler-and-jensenshannon-divergence">previous section</a>, JS divergence between <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1047" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.777em, 1000.86em, 2.745em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1048"><span class="msubsup" id="MathJax-Span-1049"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1050" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="texatom" id="MathJax-Span-1051"><span class="mrow" id="MathJax-Span-1052"><span class="mi" id="MathJax-Span-1053" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-60">p_{r}</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1054" style="width: 1.132em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.777em, 1000.92em, 2.798em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1055"><span class="msubsup" id="MathJax-Span-1056"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1057" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1058" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.07em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>g</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-61">p_g</script> can be computed as:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1059" style="width: 29.035em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.39em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-3.277em, 1023.17em, 7.476em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1060"><span class="mtable" id="MathJax-Span-1061" style="padding-right: 0.164em; padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 23.067em; height: 0px;"><span style="position: absolute; clip: rect(4.841em, 1005.49em, 13.927em, -999.997em); top: -9.782em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.487em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1005.49em, 4.411em, -999.997em); top: -8.116em; right: 0em;"><span class="mtd" id="MathJax-Span-1062"><span class="mrow" id="MathJax-Span-1063"><span class="msubsup" id="MathJax-Span-1064"><span style="display: inline-block; position: relative; width: 1.508em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1065" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="texatom" id="MathJax-Span-1066"><span class="mrow" id="MathJax-Span-1067"><span class="mi" id="MathJax-Span-1068" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-1069" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1070" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-1071"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1072" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="texatom" id="MathJax-Span-1073"><span class="mrow" id="MathJax-Span-1074"><span class="mi" id="MathJax-Span-1075" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1076" style="font-family: STIXGeneral;">‖</span><span class="msubsup" id="MathJax-Span-1077"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1078" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1079" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1080" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-1081" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.444em, 1000.65em, 4.142em, -999.997em); top: -5.589em; right: 0em;"><span class="mtd" id="MathJax-Span-1153"><span class="mrow" id="MathJax-Span-1154"><span class="mo" id="MathJax-Span-1155" style="font-family: STIXGeneral;">=</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.82em, 1000em, 4.142em, -999.997em); top: -2.793em; right: 0em;"><span class="mtd" id="MathJax-Span-1210"><span class="mrow" id="MathJax-Span-1211"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.444em, 1000.65em, 4.142em, -999.997em); top: 0.003em; right: 0em;"><span class="mtd" id="MathJax-Span-1261"><span class="mrow" id="MathJax-Span-1262"><span class="mo" id="MathJax-Span-1263" style="font-family: STIXGeneral;">=</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.788em;"></span></span><span style="position: absolute; clip: rect(5.809em, 1017.53em, 16.562em, -999.997em); top: -11.449em; left: 5.487em;"><span style="display: inline-block; position: relative; width: 17.53em; height: 0px;"><span style="position: absolute; clip: rect(2.476em, 1017.53em, 4.841em, -999.997em); top: -8.116em; left: 0em;"><span class="mtd" id="MathJax-Span-1082"><span class="mrow" id="MathJax-Span-1083"><span class="mfrac" id="MathJax-Span-1084"><span style="display: inline-block; position: relative; width: 0.648em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-1085" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1000.49em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-1086" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1000.65em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.648em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1087"><span style="display: inline-block; position: relative; width: 1.723em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1088" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="texatom" id="MathJax-Span-1089"><span class="mrow" id="MathJax-Span-1090"><span class="mi" id="MathJax-Span-1091" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-1092" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1093" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-1094"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1095" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="texatom" id="MathJax-Span-1096"><span class="mrow" id="MathJax-Span-1097"><span class="mi" id="MathJax-Span-1098" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1099"><span class="mrow" id="MathJax-Span-1100"><span class="mo" id="MathJax-Span-1101" style="font-family: STIXVariants;">|</span></span></span><span class="texatom" id="MathJax-Span-1102"><span class="mrow" id="MathJax-Span-1103"><span class="mo" id="MathJax-Span-1104" style="font-family: STIXVariants;">|</span></span></span><span class="mfrac" id="MathJax-Span-1105"><span style="display: inline-block; position: relative; width: 3.175em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.282em, 1003.01em, 4.411em, -999.997em); top: -4.728em; left: 50%; margin-left: -1.503em;"><span class="mrow" id="MathJax-Span-1106"><span class="msubsup" id="MathJax-Span-1107"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1108" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="texatom" id="MathJax-Span-1109"><span class="mrow" id="MathJax-Span-1110"><span class="mi" id="MathJax-Span-1111" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1112" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="msubsup" id="MathJax-Span-1113" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1114" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1115" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1000.49em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-1116" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1003.17em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.175em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-1117" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-1118" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="mfrac" id="MathJax-Span-1119" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 0.648em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-1120" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1000.49em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-1121" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1000.65em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.648em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1122"><span style="display: inline-block; position: relative; width: 1.723em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1123" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="texatom" id="MathJax-Span-1124"><span class="mrow" id="MathJax-Span-1125"><span class="mi" id="MathJax-Span-1126" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-1127" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1128" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-1129"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1130" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="texatom" id="MathJax-Span-1131"><span class="mrow" id="MathJax-Span-1132"><span class="mi" id="MathJax-Span-1133" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1134"><span class="mrow" id="MathJax-Span-1135"><span class="mo" id="MathJax-Span-1136" style="font-family: STIXVariants;">|</span></span></span><span class="texatom" id="MathJax-Span-1137"><span class="mrow" id="MathJax-Span-1138"><span class="mo" id="MathJax-Span-1139" style="font-family: STIXVariants;">|</span></span></span><span class="mfrac" id="MathJax-Span-1140"><span style="display: inline-block; position: relative; width: 3.175em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.282em, 1003.01em, 4.411em, -999.997em); top: -4.728em; left: 50%; margin-left: -1.503em;"><span class="mrow" id="MathJax-Span-1141"><span class="msubsup" id="MathJax-Span-1142"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1143" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="texatom" id="MathJax-Span-1144"><span class="mrow" id="MathJax-Span-1145"><span class="mi" id="MathJax-Span-1146" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1147" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="msubsup" id="MathJax-Span-1148" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1149" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1150" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1000.49em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-1151" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1003.17em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.175em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-1152" style="font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(2.315em, 1016.62em, 5.11em, -999.997em); top: -5.589em; left: 0em;"><span class="mtd" id="MathJax-Span-1156"><span class="mrow" id="MathJax-Span-1157"><span class="mfrac" id="MathJax-Span-1158"><span style="display: inline-block; position: relative; width: 0.648em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-1159" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1000.49em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-1160" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1000.65em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.648em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1161" style=""><span class="mrow" id="MathJax-Span-1162"><span class="mo" id="MathJax-Span-1163" style="vertical-align: -0.589em;"><span style="font-family: STIXSizeThreeSym;">(</span></span></span></span><span class="mi" id="MathJax-Span-1164" style="font-family: STIXGeneral; padding-left: 0.164em;">log</span><span class="mo" id="MathJax-Span-1165"></span><span class="mn" id="MathJax-Span-1166" style="font-family: STIXGeneral; padding-left: 0.164em;">2</span><span class="mo" id="MathJax-Span-1167" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="msubsup" id="MathJax-Span-1168" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.02em, 5.003em, -999.997em); top: -3.976em; left: 0em;"><span class="mo" id="MathJax-Span-1169" style="font-family: STIXIntegralsD; vertical-align: -0.589em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.433em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.062em; left: 0.594em;"><span class="mi" id="MathJax-Span-1170" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1171" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1172" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="texatom" id="MathJax-Span-1173"><span class="mrow" id="MathJax-Span-1174"><span class="mi" id="MathJax-Span-1175" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1176" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-1177" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1178" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-1179" style="font-family: STIXGeneral; padding-left: 0.164em;">log</span><span class="mo" id="MathJax-Span-1180"></span><span class="mfrac" id="MathJax-Span-1181" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 4.25em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1001.94em, 4.358em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.965em;"><span class="mrow" id="MathJax-Span-1182"><span class="msubsup" id="MathJax-Span-1183"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1184" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="texatom" id="MathJax-Span-1185"><span class="mrow" id="MathJax-Span-1186"><span class="mi" id="MathJax-Span-1187" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1188" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-1189" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1190" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1004.09em, 4.411em, -999.997em); top: -3.277em; left: 50%; margin-left: -2.094em;"><span class="mrow" id="MathJax-Span-1191"><span class="msubsup" id="MathJax-Span-1192"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1193" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="texatom" id="MathJax-Span-1194"><span class="mrow" id="MathJax-Span-1195"><span class="mi" id="MathJax-Span-1196" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1197" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="msubsup" id="MathJax-Span-1198" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1199" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1200" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1201" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-1202" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1203" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1004.25em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.25em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mi" id="MathJax-Span-1204" style="font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-1205" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-1206" style=""><span class="mrow" id="MathJax-Span-1207"><span class="mo" id="MathJax-Span-1208" style="vertical-align: -0.589em;"><span style="font-family: STIXSizeThreeSym;">)</span></span></span></span><span class="mo" id="MathJax-Span-1209" style="font-family: STIXGeneral;">+</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(2.315em, 1015.86em, 5.11em, -999.997em); top: -2.793em; left: 0em;"><span class="mtd" id="MathJax-Span-1212"><span class="mrow" id="MathJax-Span-1213"><span class="mfrac" id="MathJax-Span-1214"><span style="display: inline-block; position: relative; width: 0.648em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-1215" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1000.49em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-1216" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1000.65em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.648em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1217" style=""><span class="mrow" id="MathJax-Span-1218"><span class="mo" id="MathJax-Span-1219" style="vertical-align: -0.589em;"><span style="font-family: STIXSizeThreeSym;">(</span></span></span></span><span class="mi" id="MathJax-Span-1220" style="font-family: STIXGeneral; padding-left: 0.164em;">log</span><span class="mo" id="MathJax-Span-1221"></span><span class="mn" id="MathJax-Span-1222" style="font-family: STIXGeneral; padding-left: 0.164em;">2</span><span class="mo" id="MathJax-Span-1223" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="msubsup" id="MathJax-Span-1224" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1001.02em, 5.003em, -999.997em); top: -3.976em; left: 0em;"><span class="mo" id="MathJax-Span-1225" style="font-family: STIXIntegralsD; vertical-align: -0.589em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.433em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.062em; left: 0.594em;"><span class="mi" id="MathJax-Span-1226" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1227" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1228" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1229" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1230" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-1231" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1232" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-1233" style="font-family: STIXGeneral; padding-left: 0.164em;">log</span><span class="mo" id="MathJax-Span-1234"></span><span class="mfrac" id="MathJax-Span-1235" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 4.25em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1001.99em, 4.411em, -999.997em); top: -4.728em; left: 50%; margin-left: -1.019em;"><span class="mrow" id="MathJax-Span-1236"><span class="msubsup" id="MathJax-Span-1237"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1238" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1239" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1240" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-1241" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1242" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1004.09em, 4.411em, -999.997em); top: -3.277em; left: 50%; margin-left: -2.094em;"><span class="mrow" id="MathJax-Span-1243"><span class="msubsup" id="MathJax-Span-1244"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1245" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="texatom" id="MathJax-Span-1246"><span class="mrow" id="MathJax-Span-1247"><span class="mi" id="MathJax-Span-1248" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1249" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="msubsup" id="MathJax-Span-1250" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1251" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1252" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1253" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-1254" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1255" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1004.25em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.25em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mi" id="MathJax-Span-1256" style="font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-1257" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-1258" style=""><span class="mrow" id="MathJax-Span-1259"><span class="mo" id="MathJax-Span-1260" style="vertical-align: -0.589em;"><span style="font-family: STIXSizeThreeSym;">)</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(2.315em, 1009.03em, 5.11em, -999.997em); top: 0.003em; left: 0em;"><span class="mtd" id="MathJax-Span-1264"><span class="mrow" id="MathJax-Span-1265"><span class="mfrac" id="MathJax-Span-1266"><span style="display: inline-block; position: relative; width: 0.648em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-1267" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1000.49em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-1268" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1000.65em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.648em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1269"><span class="mrow" id="MathJax-Span-1270"><span class="mo" id="MathJax-Span-1271" style="vertical-align: -0.589em;"><span style="font-family: STIXSizeThreeSym;">(</span></span></span></span><span class="mi" id="MathJax-Span-1272" style="font-family: STIXGeneral; padding-left: 0.164em;">log</span><span class="mo" id="MathJax-Span-1273"></span><span class="mn" id="MathJax-Span-1274" style="font-family: STIXGeneral; padding-left: 0.164em;">4</span><span class="mo" id="MathJax-Span-1275" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="mi" id="MathJax-Span-1276" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.272em;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1277" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-1278" style="font-family: STIXGeneral; font-style: italic;">G</span><span class="mo" id="MathJax-Span-1279" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-1280" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1281" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.406em; left: 0.702em;"><span class="mo" id="MathJax-Span-1282" style="font-size: 70.7%; font-family: STIXGeneral;">∗</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1283" style="font-family: STIXGeneral;">)</span><span class="texatom" id="MathJax-Span-1284"><span class="mrow" id="MathJax-Span-1285"><span class="mo" id="MathJax-Span-1286" style="vertical-align: -0.589em;"><span style="font-family: STIXSizeThreeSym;">)</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span><span style="display: inline-block; width: 0px; height: 11.454em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -6.197em; border-left: 0px solid; width: 0px; height: 13.07em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>J</mi><mi>S</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub><mo fence="false" stretchy="false">‖</mo><msub><mi>p</mi><mi>g</mi></msub><mo stretchy="false">)</mo><mo>=</mo></mtd><mtd><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mfrac><mrow><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub><mo>+</mo><msub><mi>p</mi><mi>g</mi></msub></mrow><mn>2</mn></mfrac><mo stretchy="false">)</mo><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>g</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mfrac><mrow><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub><mo>+</mo><msub><mi>p</mi><mi>g</mi></msub></mrow><mn>2</mn></mfrac><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mo>=</mo></mtd><mtd><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow class="MJX-TeXAtom-ORD"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mi>log</mi><mo>⁡</mo><mn>2</mn><mo>+</mo><msub><mo>∫</mo><mi>x</mi></msub><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><mfrac><mrow><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub><mo>+</mo><msub><mi>p</mi><mi>g</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mi>d</mi><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow><mo>+</mo></mtd></mtr><mtr><mtd></mtd><mtd><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow class="MJX-TeXAtom-ORD"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mi>log</mi><mo>⁡</mo><mn>2</mn><mo>+</mo><msub><mo>∫</mo><mi>x</mi></msub><msub><mi>p</mi><mi>g</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><mfrac><mrow><msub><mi>p</mi><mi>g</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub><mo>+</mo><msub><mi>p</mi><mi>g</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mi>d</mi><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mtd></mtr><mtr><mtd><mo>=</mo></mtd><mtd><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow class="MJX-TeXAtom-ORD"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mi>log</mi><mo>⁡</mo><mn>4</mn><mo>+</mo><mi>L</mi><mo stretchy="false">(</mo><mi>G</mi><mo>,</mo><msup><mi>D</mi><mo>∗</mo></msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-62">% <![CDATA[
\begin{aligned}
D_{JS}(p_{r} \| p_g) 
=& \frac{1}{2} D_{KL}(p_{r} || \frac{p_{r} + p_g}{2}) + \frac{1}{2} D_{KL}(p_{g} || \frac{p_{r} + p_g}{2}) \\
=& \frac{1}{2} \bigg( \log2 + \int_x p_{r}(x) \log \frac{p_{r}(x)}{p_{r} + p_g(x)} dx \bigg) + \\& \frac{1}{2} \bigg( \log2 + \int_x p_g(x) \log \frac{p_g(x)}{p_{r} + p_g(x)} dx \bigg) \\
=& \frac{1}{2} \bigg( \log4 + L(G, D^*) \bigg)
\end{aligned} %]]></script>

<p>Thus,</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1287" style="width: 16.938em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.659em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.616em, 1013.66em, 2.96em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1288"><span class="mi" id="MathJax-Span-1289" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1290" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-1291" style="font-family: STIXGeneral; font-style: italic;">G</span><span class="mo" id="MathJax-Span-1292" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-1293" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1294" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.406em; left: 0.702em;"><span class="mo" id="MathJax-Span-1295" style="font-size: 70.7%; font-family: STIXGeneral;">∗</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1296" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-1297" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-1298" style="font-family: STIXGeneral; padding-left: 0.325em;">2</span><span class="msubsup" id="MathJax-Span-1299"><span style="display: inline-block; position: relative; width: 1.508em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1300" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="texatom" id="MathJax-Span-1301"><span class="mrow" id="MathJax-Span-1302"><span class="mi" id="MathJax-Span-1303" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-1304" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1305" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-1306"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1307" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="texatom" id="MathJax-Span-1308"><span class="mrow" id="MathJax-Span-1309"><span class="mi" id="MathJax-Span-1310" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1311" style="font-family: STIXGeneral;">‖</span><span class="msubsup" id="MathJax-Span-1312"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1313" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1314" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1315" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-1316" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="mn" id="MathJax-Span-1317" style="font-family: STIXGeneral; padding-left: 0.272em;">2</span><span class="mi" id="MathJax-Span-1318" style="font-family: STIXGeneral; padding-left: 0.164em;">log</span><span class="mo" id="MathJax-Span-1319"></span><span class="mn" id="MathJax-Span-1320" style="font-family: STIXGeneral; padding-left: 0.164em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.403em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>L</mi><mo stretchy="false">(</mo><mi>G</mi><mo>,</mo><msup><mi>D</mi><mo>∗</mo></msup><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>J</mi><mi>S</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub><mo fence="false" stretchy="false">‖</mo><msub><mi>p</mi><mi>g</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mn>2</mn><mi>log</mi><mo>⁡</mo><mn>2</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-63">L(G, D^*) = 2D_{JS}(p_{r} \| p_g) - 2\log2</script>

<p>Essentially the loss function of GAN quantifies the similarity between the generative data distribution <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1321" style="width: 1.132em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.777em, 1000.92em, 2.798em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1322"><span class="msubsup" id="MathJax-Span-1323"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1324" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1325" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.07em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>g</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-64">p_g</script> and the real sample distribution <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1326" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.777em, 1000.86em, 2.745em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1327"><span class="msubsup" id="MathJax-Span-1328"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1329" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="texatom" id="MathJax-Span-1330"><span class="mrow" id="MathJax-Span-1331"><span class="mi" id="MathJax-Span-1332" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-65">p_{r}</script> by JS divergence when the discriminator is optimal. The best <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1333" style="width: 1.508em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.508em, 1001.18em, 2.53em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1334"><span class="msubsup" id="MathJax-Span-1335"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1336" style="font-family: STIXGeneral; font-style: italic;">G</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.702em;"><span class="mo" id="MathJax-Span-1337" style="font-size: 70.7%; font-family: STIXGeneral;">∗</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>G</mi><mo>∗</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-66">G^*</script> that replicates the real data distribution leads to the minimum <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1338" style="width: 10.702em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.605em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1008.61em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1339"><span class="mi" id="MathJax-Span-1340" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1341" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-1342"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1343" style="font-family: STIXGeneral; font-style: italic;">G</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.702em;"><span class="mo" id="MathJax-Span-1344" style="font-size: 70.7%; font-family: STIXGeneral;">∗</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1345" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-1346" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1347" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.702em;"><span class="mo" id="MathJax-Span-1348" style="font-size: 70.7%; font-family: STIXGeneral;">∗</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1349" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-1350" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mo" id="MathJax-Span-1351" style="font-family: STIXGeneral; padding-left: 0.325em;">−</span><span class="mn" id="MathJax-Span-1352" style="font-family: STIXGeneral;">2</span><span class="mi" id="MathJax-Span-1353" style="font-family: STIXGeneral; padding-left: 0.164em;">log</span><span class="mo" id="MathJax-Span-1354"></span><span class="mn" id="MathJax-Span-1355" style="font-family: STIXGeneral; padding-left: 0.164em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.27em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo stretchy="false">(</mo><msup><mi>G</mi><mo>∗</mo></msup><mo>,</mo><msup><mi>D</mi><mo>∗</mo></msup><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mn>2</mn><mi>log</mi><mo>⁡</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-67">L(G^*, D^*) = -2\log2</script> which is aligned with equations above.</p>

<blockquote>
  <p><strong>Other Variations of GAN</strong>: There are many variations of GANs in different contexts or designed for different tasks. For example, for semi-supervised learning, one idea is to update the discriminator to output real class labels, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1356" style="width: 6.116em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.922em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.722em, 1004.81em, 2.821em, -999.982em); top: -2.529em; left: 0em;"><span class="mrow" id="MathJax-Span-1357"><span class="mn" id="MathJax-Span-1358" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-1359" style="font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-1360" style="font-family: STIXGeneral; padding-left: 0.193em;">…</span><span class="mo" id="MathJax-Span-1361" style="font-family: STIXGeneral; padding-left: 0.193em;">,</span><span class="mi" id="MathJax-Span-1362" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.193em;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.05em;"></span></span><span class="mo" id="MathJax-Span-1363" style="font-family: STIXGeneral; padding-left: 0.241em;">−</span><span class="mn" id="MathJax-Span-1364" style="font-family: STIXGeneral; padding-left: 0.241em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.234em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>K</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-68">1, \dots, K-1</script>, as well as one fake class label <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1365" style="width: 0.91em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.719em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.722em, 1000.7em, 2.677em, -999.982em); top: -2.529em; left: 0em;"><span class="mrow" id="MathJax-Span-1366"><span class="mi" id="MathJax-Span-1367" style="font-family: STIXGeneral; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.05em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 0.951em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-69">K</script>. The generator model aims to trick the discriminator to output a classification label smaller than <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1368" style="width: 0.91em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.719em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.722em, 1000.7em, 2.677em, -999.982em); top: -2.529em; left: 0em;"><span class="mrow" id="MathJax-Span-1369"><span class="mi" id="MathJax-Span-1370" style="font-family: STIXGeneral; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.05em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 0.951em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-70">K</script>.</p>
</blockquote>

<p><strong>Tensorfor Implementation</strong>: <a href="https://github.com/carpedm20/DCGAN-tensorflow">carpedm20/DCGAN-tensorflow</a></p>

<h2 id="problems-in-gans">Problems in GANs</h2>

<p>Although GAN has shown great success in the realistic image generation, the training is not easy; The process is known to be slow and unstable.</p>

<h3 id="hard-to-achieve-nash-equilibrium">Hard to achieve Nash equilibrium</h3>

<p><a href="http://papers.nips.cc/paper/6125-improved-techniques-for-training-gans.pdf">Salimans et al. (2016)</a> discussed the problem with GAN’s gradient-descent-based training procedure. Two models are trained simultaneously to find a <a href="https://en.wikipedia.org/wiki/Nash_equilibrium">Nash equilibrium</a> to a two-player non-cooperative game. However, each model updates its cost independently with no respect to another player in the game. Updating the gradient of both models concurrently cannot guarantee a convergence.</p>

<p>Let’s check out a simple example to better understand why it is difficult to find a Nash equilibrium in an non-cooperative game. Suppose one player takes control of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1371" style="width: 0.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.43em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1372"><span class="mi" id="MathJax-Span-1373" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.67em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-71">x</script> to minimize <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1374" style="width: 5.003em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.035em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1004.03em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1375"><span class="msubsup" id="MathJax-Span-1376"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.43em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1377" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.272em;"><span class="mn" id="MathJax-Span-1378" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1379" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-1380" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1381" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-1382" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mi" id="MathJax-Span-1383" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.325em;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1384" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-72">f_1(x) = xy</script>, while at the same time the other player constantly updates <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1385" style="width: 0.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.43em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1386"><span class="mi" id="MathJax-Span-1387" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-73">y</script> to minimize <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1388" style="width: 5.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.734em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1004.73em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1389"><span class="msubsup" id="MathJax-Span-1390"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.43em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1391" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.272em;"><span class="mn" id="MathJax-Span-1392" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1393" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-1394" style="font-family: STIXGeneral; font-style: italic;">y</span><span class="mo" id="MathJax-Span-1395" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-1396" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mo" id="MathJax-Span-1397" style="font-family: STIXGeneral; padding-left: 0.325em;">−</span><span class="mi" id="MathJax-Span-1398" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1399" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi>x</mi><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-74">f_2(y) = -xy</script>.</p>

<p>Because <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1400" style="width: 3.712em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.96em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.293em, 1002.96em, 3.067em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1401"><span class="mfrac" id="MathJax-Span-1402"><span style="display: inline-block; position: relative; width: 0.97em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.336em, 1000.81em, 4.304em, -999.997em); top: -4.567em; left: 50%; margin-left: -0.427em;"><span class="mrow" id="MathJax-Span-1403"><span class="mi" id="MathJax-Span-1404" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-1405"><span style="display: inline-block; position: relative; width: 0.487em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1406" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.218em;"><span class="mn" id="MathJax-Span-1407" style="font-size: 50%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.65em, 4.142em, -999.997em); top: -3.599em; left: 50%; margin-left: -0.32em;"><span class="mrow" id="MathJax-Span-1408"><span class="mi" id="MathJax-Span-1409" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-1410" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1000.97em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.97em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-1411" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mi" id="MathJax-Span-1412" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.325em;">y</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.53em; border-left: 0px solid; width: 0px; height: 1.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>f</mi><mn>1</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-75">\frac{\partial f_1}{\partial x} = y</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1413" style="width: 4.573em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.659em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.293em, 1003.66em, 3.228em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1414"><span class="mfrac" id="MathJax-Span-1415"><span style="display: inline-block; position: relative; width: 0.97em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.336em, 1000.81em, 4.304em, -999.997em); top: -4.567em; left: 50%; margin-left: -0.427em;"><span class="mrow" id="MathJax-Span-1416"><span class="mi" id="MathJax-Span-1417" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-1418"><span style="display: inline-block; position: relative; width: 0.487em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1419" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.218em;"><span class="mn" id="MathJax-Span-1420" style="font-size: 50%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.65em, 4.304em, -999.997em); top: -3.599em; left: 50%; margin-left: -0.32em;"><span class="mrow" id="MathJax-Span-1421"><span class="mi" id="MathJax-Span-1422" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-1423" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1000.97em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.97em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-1424" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mo" id="MathJax-Span-1425" style="font-family: STIXGeneral; padding-left: 0.325em;">−</span><span class="mi" id="MathJax-Span-1426" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.73em; border-left: 0px solid; width: 0px; height: 2.137em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>f</mi><mn>2</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac><mo>=</mo><mo>−</mo><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-76">\frac{\partial f_2}{\partial y} = -x</script>, we update <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1427" style="width: 0.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.43em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1428"><span class="mi" id="MathJax-Span-1429" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.67em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-77">x</script> with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1430" style="width: 4.196em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.39em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.831em, 1003.39em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1431"><span class="mi" id="MathJax-Span-1432" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1433" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="mi" id="MathJax-Span-1434" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.272em;">η</span><span class="mo" id="MathJax-Span-1435" style="font-family: STIXGeneral; padding-left: 0.272em;">⋅</span><span class="mi" id="MathJax-Span-1436" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.272em;">y</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.07em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>−</mo><mi>η</mi><mo>⋅</mo><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-78">x-\eta \cdot y</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1437" style="width: 0.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.43em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1438"><span class="mi" id="MathJax-Span-1439" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-79">y</script> with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1440" style="width: 4.196em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.39em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.831em, 1003.39em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1441"><span class="mi" id="MathJax-Span-1442" style="font-family: STIXGeneral; font-style: italic;">y</span><span class="mo" id="MathJax-Span-1443" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="mi" id="MathJax-Span-1444" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.272em;">η</span><span class="mo" id="MathJax-Span-1445" style="font-family: STIXGeneral; padding-left: 0.272em;">⋅</span><span class="mi" id="MathJax-Span-1446" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.272em;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.07em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>+</mo><mi>η</mi><mo>⋅</mo><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-80">y+ \eta \cdot x</script> simulitanously in one iteration, where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1447" style="width: 0.594em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.487em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.43em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1448"><span class="mi" id="MathJax-Span-1449" style="font-family: STIXGeneral; font-style: italic;">η</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>η</mi></math></span></span><script type="math/tex" id="MathJax-Element-81">\eta</script> is the learning rate. Once <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1450" style="width: 0.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.43em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1451"><span class="mi" id="MathJax-Span-1452" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.67em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-82">x</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1453" style="width: 0.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.43em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1454"><span class="mi" id="MathJax-Span-1455" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-83">y</script> have different signs, every following gradient update causes huge oscillation and the instability gets worse in time, as shown in Fig. 3.</p>

<p style="width: 660px;" class="center"><img src="./From GAN to WGAN_files/nash_equilibrium.png" alt="Nash equilibrium example"></p>
<p><em>Fig. 3. A simulation of our example for updating <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1456" style="width: 0.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.43em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1457"><span class="mi" id="MathJax-Span-1458" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.67em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-84">x</script> to minimize <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1459" style="width: 1.132em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.92em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1460"><span class="mi" id="MathJax-Span-1461" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1462" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-85">xy</script> and updating <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1463" style="width: 0.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.43em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1464"><span class="mi" id="MathJax-Span-1465" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-86">y</script> to minimize <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1466" style="width: 1.938em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.562em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.831em, 1001.56em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1467"><span class="mo" id="MathJax-Span-1468" style="font-family: STIXGeneral;">−</span><span class="mi" id="MathJax-Span-1469" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1470" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.07em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>−</mo><mi>x</mi><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-87">-xy</script>. The learning rate <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1471" style="width: 3.82em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.067em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1002.96em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1472"><span class="mi" id="MathJax-Span-1473" style="font-family: STIXGeneral; font-style: italic;">η</span><span class="mo" id="MathJax-Span-1474" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-1475" style="font-family: STIXGeneral; padding-left: 0.325em;">0.1</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>η</mi><mo>=</mo><mn>0.1</mn></math></span></span><script type="math/tex" id="MathJax-Element-88">\eta = 0.1</script>. With more iterations, the oscillation grows more and more unstable.</em></p>

<h3 id="low-dimensional-supports">Low dimensional supports</h3>

<table class="info">
  <thead>
    <tr>
      <th>Term</th>
      <th>Explanation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="https://en.wikipedia.org/wiki/Manifold">Manifold</a></td>
      <td>A topological space that locally resembles Euclidean space near each point. Precisely, when this Euclidean space is of <strong>dimension <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1476" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.473em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.884em, 1000.47em, 2.707em, -999.997em); top: -2.525em; left: 0em;"><span class="mrow" id="MathJax-Span-1477"><span class="mi" id="MathJax-Span-1478" style="font-family: STIXGeneral; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.531em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.07em; border-left: 0px solid; width: 0px; height: 0.744em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-89">n</script></strong>, the manifold is referred as <strong><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1479" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.473em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.884em, 1000.47em, 2.707em, -999.997em); top: -2.525em; left: 0em;"><span class="mrow" id="MathJax-Span-1480"><span class="mi" id="MathJax-Span-1481" style="font-family: STIXGeneral; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.531em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.07em; border-left: 0px solid; width: 0px; height: 0.744em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-90">n</script>-manifold</strong>.</td>
    </tr>
    <tr>
      <td><a href="https://en.wikipedia.org/wiki/Support_(mathematics)">Support</a></td>
      <td>A real-valued function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1482" style="width: 0.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.421em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.735em, 1000.42em, 2.93em, -999.997em); top: -2.566em; left: 0em;"><span class="mrow" id="MathJax-Span-1483"><span class="mi" id="MathJax-Span-1484" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.572em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.293em; border-left: 0px solid; width: 0px; height: 1.263em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-91">f</script> is the subset of the domain containing those elements which are not mapped to <strong>zero</strong>.</td>
    </tr>
  </tbody>
</table>

<p><a href="https://arxiv.org/pdf/1701.04862.pdf">Arjovsky and Bottou (2017)</a> discussed the problem of the <a href="https://en.wikipedia.org/wiki/Support_(mathematics)">supports</a> of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1485" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.777em, 1000.86em, 2.745em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1486"><span class="msubsup" id="MathJax-Span-1487"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1488" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1489" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>r</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-92">p_r</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1490" style="width: 1.132em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.777em, 1000.92em, 2.798em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1491"><span class="msubsup" id="MathJax-Span-1492"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1493" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1494" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.07em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>g</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-93">p_g</script> lying on low dimensional <a href="https://en.wikipedia.org/wiki/Manifold">manifolds</a> and how it contributes to the instability of GAN training thoroughly in a very theoretical paper <a href="https://arxiv.org/pdf/1701.04862.pdf">“Towards principled methods for training generative adversarial networks”</a>.</p>

<p>The dimensions of many real-world datasets, as represented by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1495" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.777em, 1000.86em, 2.745em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1496"><span class="msubsup" id="MathJax-Span-1497"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1498" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1499" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>r</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-94">p_r</script>, only appear to be <strong>artificially high</strong>. They have been found to concentrate in a lower dimensional manifold. This is actually the fundamental assumption for <a href="http://scikit-learn.org/stable/modules/manifold.html">Manifold Learning</a>. Thinking of the real world images, once the theme or the contained object is fixed, the images have a lot of restrictions to follow, i.e., a dog should have two ears and a tail, and a skyscraper should have a straight and tall body, etc. These restrictions keep images aways from the possibility of having a high-dimensional free form.</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1500" style="width: 1.132em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.777em, 1000.92em, 2.798em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1501"><span class="msubsup" id="MathJax-Span-1502"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1503" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1504" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.07em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>g</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-95">p_g</script> lies in a low dimensional manifolds, too. Whenever the generator is asked to a much larger image like 64x64 given a small dimension, such as 100, noise variable input <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1505" style="width: 0.487em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.379em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.38em, 2.798em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1506"><span class="mi" id="MathJax-Span-1507" style="font-family: STIXGeneral; font-style: italic;">z</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.197em; border-left: 0px solid; width: 0px; height: 0.737em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-96">z</script>, the distribution of colors over these 4096 pixels has been defined by the small 100-dimension random number vector and can hardly fill up the whole high dimensional space.</p>

<p>Because both <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1508" style="width: 1.132em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.777em, 1000.92em, 2.798em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1509"><span class="msubsup" id="MathJax-Span-1510"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1511" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1512" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.07em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>g</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-97">p_g</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1513" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.777em, 1000.86em, 2.745em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1514"><span class="msubsup" id="MathJax-Span-1515"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1516" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1517" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>r</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-98">p_r</script> rest in low dimensional manifolds, they are almost certainly gonna be disjoint (See Fig. 4). When they have disjoint supports, we are always capable of finding a perfect discriminator that separates real and fake samples 100% correctly. Check the <a href="https://arxiv.org/pdf/1701.04862.pdf">paper</a> if you are curious about the proof.</p>

<p style="width: 640px;" class="center"><img src="./From GAN to WGAN_files/low_dim_manifold.png" alt="Low dimensional manifolds in high dimension space"></p>
<p><em>Fig. 4. Low dimensional manifolds in high dimension space can hardly have overlaps. (Left) Two lines in a three-dimension space. (Right) Two surfaces in a three-dimension space.</em></p>

<h3 id="vanishing-gradient">Vanishing gradient</h3>

<p>When the discriminator is perfect, we are guaranteed with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2200;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1518" style="width: 9.035em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.261em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1007.26em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1519"><span class="mi" id="MathJax-Span-1520" style="font-family: STIXGeneral; font-style: italic;">D</span><span class="mo" id="MathJax-Span-1521" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-1522" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1523" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-1524" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-1525" style="font-family: STIXGeneral; padding-left: 0.325em;">1</span><span class="mo" id="MathJax-Span-1526" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-1527" style="font-family: STIXGeneral; padding-left: 0.164em;">∀</span><span class="mi" id="MathJax-Span-1528" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1529" style="font-family: STIXGeneral; padding-left: 0.325em;">∈</span><span class="msubsup" id="MathJax-Span-1530" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1531" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1532" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>,</mo><mi mathvariant="normal">∀</mi><mi>x</mi><mo>∈</mo><msub><mi>p</mi><mi>r</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-99">D(x) = 1, \forall x \in p_r</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2200;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1533" style="width: 9.089em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.315em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1007.32em, 2.96em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1534"><span class="mi" id="MathJax-Span-1535" style="font-family: STIXGeneral; font-style: italic;">D</span><span class="mo" id="MathJax-Span-1536" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-1537" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1538" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-1539" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-1540" style="font-family: STIXGeneral; padding-left: 0.325em;">0</span><span class="mo" id="MathJax-Span-1541" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-1542" style="font-family: STIXGeneral; padding-left: 0.164em;">∀</span><span class="mi" id="MathJax-Span-1543" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1544" style="font-family: STIXGeneral; padding-left: 0.325em;">∈</span><span class="msubsup" id="MathJax-Span-1545" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1546" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1547" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.337em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn><mo>,</mo><mi mathvariant="normal">∀</mi><mi>x</mi><mo>∈</mo><msub><mi>p</mi><mi>g</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-100">D(x) = 0, \forall x \in p_g</script>. Therefore the loss function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-101-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1548" style="width: 0.702em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.54em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.54em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1549"><span class="mi" id="MathJax-Span-1550" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-101">L</script> falls to zero and we end up with no gradient to update the loss during learning iterations. Fig. 5 demonstrates an experiment when the discriminator gets better, the gradient vanishes fast.</p>

<p style="width: 480px;" class="center"><img src="./From GAN to WGAN_files/GAN_vanishing_gradient.png" alt="Low dimensional manifolds in high dimension space"></p>
<p><em>Fig. 5. First, a DCGAN is trained for 1, 10 and 25 epochs. Then, with the <strong>generator fixed</strong>, a discriminator is trained from scratch and measure the gradients with the original cost function. We see the gradient norms <strong>decay quickly</strong> (in log scale), in the best case 5 orders of magnitude after 4000 discriminator iterations. (Image source: <a href="https://arxiv.org/pdf/1701.04862.pdf">Arjovsky and Bottou, 2017</a>)</em></p>

<p>As a result, training a GAN faces a <strong>dilemma</strong>:</p>
<ul>
  <li>If the discriminator behaves badly, the generator does not have accurate feedback and the loss function cannot represent the reality.</li>
  <li>If the discriminator does a great job, the gradient of the loss function drops down to close to zero and the learning becomes super slow or even jammed.</li>
</ul>

<p>This dilemma clearly is capable to make the GAN training very tough.</p>

<h3 id="mode-collapse">Mode collapse</h3>

<p>During the training, the generator may collapse to a setting where it always produces same outputs. This is a common failure case for GANs, commonly referred to as <strong>Mode Collapse</strong>. Even though the generator might be able to trick the corresponding discriminator, it fails to learn to represent the complex real-world data distribution and gets stuck in a small space with extremely low variety.</p>

<p style="width: 720px;" class="center"><img src="./From GAN to WGAN_files/mode_collapse.png" alt="Mode collapse in GAN"></p>
<p><em>Fig. 6. A DCGAN model is trained with an MLP network with 4 layers, 512 units and ReLU activation function, configured to lack a strong inductive bias for image generation. The results shows a significant degree of mode collapse. (Image source: <a href="https://arxiv.org/pdf/1701.07875.pdf">Arjovsky, Chintala, &amp; Bottou, 2017.</a>)</em></p>

<h3 id="lack-of-a-proper-evaluation-metric">Lack of a proper evaluation metric</h3>

<p>Generative adversarial networks are not born with a good objection function that can inform us the training progress. Without a good evaluation metric, it is like working in the dark. No good sign to tell when to stop; No good indicator to compare the performance of multiple models.</p>

<h2 id="improved-gan-training">Improved GAN Training</h2>

<p>The following suggestions are proposed to help stabilize and improve the training of GANs.</p>

<p>First five methods are practical techniques to achieve faster convergence of GAN training, proposed in <a href="http://papers.nips.cc/paper/6125-improved-techniques-for-training-gans.pdf">“Improve Techniques for Training GANs”</a>.
The last two are proposed in <a href="https://arxiv.org/pdf/1701.04862.pdf">“Towards principled methods for training generative adversarial networks”</a> to solve the problem of disjoint distributions.</p>

<p>(1) <strong>Feature Matching</strong></p>

<p>Feature matching suggests to optimize the discriminator to inspect whether the generator’s output matches expected statistics of the real samples. In such a scenario, the new loss function is defined as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-102-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msubsup&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1551" style="width: 14.949em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.046em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.562em, 1012.05em, 3.067em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1552"><span class="mo" id="MathJax-Span-1553" style="font-family: STIXGeneral;">‖</span><span class="msubsup" id="MathJax-Span-1554"><span style="display: inline-block; position: relative; width: 2.099em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="texatom" id="MathJax-Span-1555"><span class="mrow" id="MathJax-Span-1556"><span class="mi" id="MathJax-Span-1557" style="font-family: STIXGeneral;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.648em;"><span class="texatom" id="MathJax-Span-1558"><span class="mrow" id="MathJax-Span-1559"><span class="mi" id="MathJax-Span-1560" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1561" style="font-size: 70.7%; font-family: STIXGeneral;">∼</span><span class="msubsup" id="MathJax-Span-1562"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1563" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.379em;"><span class="mi" id="MathJax-Span-1564" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mi" id="MathJax-Span-1565" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span><span class="mo" id="MathJax-Span-1566" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-1567" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1568" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-1569" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="msubsup" id="MathJax-Span-1570" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 2.798em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="texatom" id="MathJax-Span-1571"><span class="mrow" id="MathJax-Span-1572"><span class="mi" id="MathJax-Span-1573" style="font-family: STIXGeneral;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.648em;"><span class="texatom" id="MathJax-Span-1574"><span class="mrow" id="MathJax-Span-1575"><span class="mi" id="MathJax-Span-1576" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span class="mo" id="MathJax-Span-1577" style="font-size: 70.7%; font-family: STIXGeneral;">∼</span><span class="msubsup" id="MathJax-Span-1578"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1579" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.379em;"><span class="mi" id="MathJax-Span-1580" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1581" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-1582" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span class="mo" id="MathJax-Span-1583" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mi" id="MathJax-Span-1584" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span><span class="mo" id="MathJax-Span-1585" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-1586" style="font-family: STIXGeneral; font-style: italic;">G</span><span class="mo" id="MathJax-Span-1587" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-1588" style="font-family: STIXGeneral; font-style: italic;">z</span><span class="mo" id="MathJax-Span-1589" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-1590" style="font-family: STIXGeneral;">)</span><span class="msubsup" id="MathJax-Span-1591"><span style="display: inline-block; position: relative; width: 0.97em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mo" id="MathJax-Span-1592" style="font-family: STIXGeneral;">‖</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.43em, 4.142em, -999.997em); top: -4.298em; left: 0.54em;"><span class="mn" id="MathJax-Span-1593" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.43em, 4.142em, -999.997em); top: -3.653em; left: 0.54em;"><span class="mn" id="MathJax-Span-1594" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.53em; border-left: 0px solid; width: 0px; height: 1.603em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">‖</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>∼</mo><msub><mi>p</mi><mi>r</mi></msub></mrow></msub><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mo>∼</mo><msub><mi>p</mi><mi>z</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow></msub><mi>f</mi><mo stretchy="false">(</mo><mi>G</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><msubsup><mo fence="false" stretchy="false">‖</mo><mn>2</mn><mn>2</mn></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-102">\| \mathbb{E}_{x \sim p_r} f(x) - \mathbb{E}_{z \sim p_z(z)}f(G(z)) \|_2^2</script>, where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-103-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1595" style="width: 1.938em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.562em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1001.51em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1596"><span class="mi" id="MathJax-Span-1597" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span><span class="mo" id="MathJax-Span-1598" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-1599" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1600" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-103">f(x)</script> can be any computation of statistics of features, such as mean or median.</p>

<p>(2) <strong>Minibatch Discrimination</strong></p>

<p>With minibatch discrimination, the discriminator is able to digest the relationship between training data points in one batch, instead of processing each point independently.</p>

<p>In one minibatch, we approximate the closeness between every pair of samples, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-104-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1601" style="width: 3.605em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.906em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1002.85em, 3.013em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1602"><span class="mi" id="MathJax-Span-1603" style="font-family: STIXGeneral; font-style: italic;">c</span><span class="mo" id="MathJax-Span-1604" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-1605"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1606" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.433em;"><span class="mi" id="MathJax-Span-1607" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1608" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-1609" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1610" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.433em;"><span class="mi" id="MathJax-Span-1611" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1612" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.463em; border-left: 0px solid; width: 0px; height: 1.337em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-104">c(x_i, x_j)</script>, and get the overall summary of one data point by summing up how close it is to other samples in the same batch, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1613" style="width: 9.304em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.476em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.616em, 1007.42em, 3.121em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1614"><span class="mi" id="MathJax-Span-1615" style="font-family: STIXGeneral; font-style: italic;">o</span><span class="mo" id="MathJax-Span-1616" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-1617"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1618" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.433em;"><span class="mi" id="MathJax-Span-1619" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1620" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-1621" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="munderover" id="MathJax-Span-1622" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.067em, 1000.86em, 4.411em, -999.997em); top: -3.976em; left: 0em;"><span class="mo" id="MathJax-Span-1623" style="font-family: STIXGeneral; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.653em; left: 0.917em;"><span class="texatom" id="MathJax-Span-1624"><span class="mrow" id="MathJax-Span-1625"><span class="mi" id="MathJax-Span-1626" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mi" id="MathJax-Span-1627" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">c</span><span class="mo" id="MathJax-Span-1628" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-1629"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1630" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.433em;"><span class="mi" id="MathJax-Span-1631" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1632" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-1633" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1634" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.433em;"><span class="mi" id="MathJax-Span-1635" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1636" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.597em; border-left: 0px solid; width: 0px; height: 1.603em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>o</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></munder><mi>c</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-105">o(x_i) = \sum_{j} c(x_i, x_j)</script>. Then <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1637" style="width: 2.368em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.884em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1001.83em, 2.852em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1638"><span class="mi" id="MathJax-Span-1639" style="font-family: STIXGeneral; font-style: italic;">o</span><span class="mo" id="MathJax-Span-1640" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-1641"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1642" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.433em;"><span class="mi" id="MathJax-Span-1643" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1644" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>o</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-106">o(x_i)</script> is explicitly added to the input of the model.</p>

<p>(3) <strong>Historical Averaging</strong></p>

<p>For both models, add <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0398;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mfrac&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0398;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1645" style="width: 9.304em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.476em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.454em, 1007.48em, 3.067em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1646"><span class="mo" id="MathJax-Span-1647" style="font-family: STIXGeneral;">‖</span><span class="mi" id="MathJax-Span-1648" style="font-family: STIXGeneral;">Θ</span><span class="mo" id="MathJax-Span-1649" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="mfrac" id="MathJax-Span-1650" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 0.487em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.336em, 1000.27em, 4.142em, -999.997em); top: -4.406em; left: 50%; margin-left: -0.159em;"><span class="mn" id="MathJax-Span-1651" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.444em, 1000.22em, 4.142em, -999.997em); top: -3.653em; left: 50%; margin-left: -0.105em;"><span class="mi" id="MathJax-Span-1652" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1000.49em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.487em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1653" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 2.046em; height: 0px;"><span style="position: absolute; clip: rect(3.067em, 1000.86em, 4.411em, -999.997em); top: -3.976em; left: 0em;"><span class="mo" id="MathJax-Span-1654" style="font-family: STIXGeneral; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.444em, 1000.27em, 4.142em, -999.997em); top: -4.46em; left: 0.917em;"><span class="mi" id="MathJax-Span-1655" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1001.13em, 4.142em, -999.997em); top: -3.653em; left: 0.917em;"><span class="texatom" id="MathJax-Span-1656"><span class="mrow" id="MathJax-Span-1657"><span class="mi" id="MathJax-Span-1658" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-1659" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-1660" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1661" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.97em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1662" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="mi" id="MathJax-Span-1663" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1664"><span style="display: inline-block; position: relative; width: 0.97em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mo" id="MathJax-Span-1665" style="font-family: STIXGeneral;">‖</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.54em;"><span class="mn" id="MathJax-Span-1666" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.53em; border-left: 0px solid; width: 0px; height: 1.67em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">‖</mo><mi mathvariant="normal">Θ</mi><mo>−</mo><mfrac><mn>1</mn><mi>t</mi></mfrac><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></munderover><msub><mi mathvariant="normal">Θ</mi><mi>i</mi></msub><msup><mo fence="false" stretchy="false">‖</mo><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-107">\| \Theta - \frac{1}{t} \sum_{i=1}^t \Theta_i \|^2</script> into the loss function, where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0398;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1667" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1000.65em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1668"><span class="mi" id="MathJax-Span-1669" style="font-family: STIXGeneral;">Θ</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-108">\Theta</script> is the model parameter and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-109-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0398;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1670" style="width: 1.239em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.97em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.508em, 1000.97em, 2.691em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1671"><span class="msubsup" id="MathJax-Span-1672"><span style="display: inline-block; position: relative; width: 0.97em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1673" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="mi" id="MathJax-Span-1674" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">Θ</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-109">\Theta_i</script> is how the parameter is configured at the past training time <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-110-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1675" style="width: 0.379em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.272em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.27em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1676"><span class="mi" id="MathJax-Span-1677" style="font-family: STIXGeneral; font-style: italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-110">i</script>. This addition piece penalizes the training speed when <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-111-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0398;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1678" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1000.65em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1679"><span class="mi" id="MathJax-Span-1680" style="font-family: STIXGeneral;">Θ</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-111">\Theta</script> is changing too dramatically in time.</p>

<p>(4) <strong>One-sided Label Smoothing</strong></p>

<p>When feeding the discriminator, instead of providing 1 and 0 labels, use soften values such as 0.9 and 0.1. It is shown to reduce the networks’ vulnerability.</p>

<p>(5) <strong>Virtual Batch Normalization</strong> (VBN)</p>

<p>Each data sample is normalized based on a fixed batch (<em>“reference batch”</em>) of data rather than within its minibatch. The reference batch is chosen once at the beginning and stays the same through the training.</p>

<p><strong>Theano Implementation</strong>: <a href="https://github.com/openai/improved-gan">openai/improved-gan</a></p>

<p>(6) <strong>Adding Noises</strong>.</p>

<p>Based on the discussion in the <a href="https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html#low-dimensional-supports">previous section</a>, we now know <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-112-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1681" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.777em, 1000.86em, 2.745em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1682"><span class="msubsup" id="MathJax-Span-1683"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1684" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1685" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>r</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-112">p_r</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1686" style="width: 1.132em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.777em, 1000.92em, 2.798em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1687"><span class="msubsup" id="MathJax-Span-1688"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1689" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1690" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.07em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>g</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-113">p_g</script> are disjoint in a high dimensional space and it causes the problem of vanishing gradient. To artificially “spread out” the distribution and to create higher chances for two probability distributions to have overlaps, one solution is to add continuous noises onto the inputs of the discriminator <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-114-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1691" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.7em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1692"><span class="mi" id="MathJax-Span-1693" style="font-family: STIXGeneral; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-114">D</script>.</p>

<p>(7) <strong>Use Better Metric of Distribution Similarity</strong></p>

<p>The loss function of the vanilla GAN measures the JS divergence between the distributions of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-115-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1694" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.777em, 1000.86em, 2.745em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1695"><span class="msubsup" id="MathJax-Span-1696"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1697" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1698" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>r</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-115">p_r</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-116-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1699" style="width: 1.132em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.777em, 1000.92em, 2.798em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1700"><span class="msubsup" id="MathJax-Span-1701"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1702" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1703" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.07em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>g</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-116">p_g</script>. This metric fails to provide a meaningful value when two distributions are disjoint.</p>

<p><a href="https://en.wikipedia.org/wiki/Wasserstein_metric">Wasserstein metric</a> is proposed to replace JS divergence because it has a much smoother value space. See more in the next section.</p>

<h2 id="wasserstein-gan-wgan">Wasserstein GAN (WGAN)</h2>

<h3 id="what-is-wasserstein-distance">What is Wasserstein distance?</h3>

<p><a href="https://en.wikipedia.org/wiki/Wasserstein_metric">Wasserstein Distance</a> is a measure of the distance between two probability distributions.
It is also called <strong>Earth Mover’s distance</strong>, short for EM distance, because informally it can be interpreted as moving piles of dirt that follow one probability distribution at a minimum cost to follow the other distribution. The cost is quantified by the amount of dirt moved times the moving distance.</p>

<!-- 
https://en.wikipedia.org/wiki/Hungarian_algorithm
https://en.wikipedia.org/wiki/Transportation_theory_(mathematics)
-->

<p>Let us first look at a simple case where the probability domain is <em>discrete</em>. For example, suppose we have two distributions <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-117-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1704" style="width: 0.755em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.59em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1705"><span class="mi" id="MathJax-Span-1706" style="font-family: STIXGeneral; font-style: italic;">P</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-117">P</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-118-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1707" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.7em, 2.852em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1708"><span class="mi" id="MathJax-Span-1709" style="font-family: STIXGeneral; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-118">Q</script>, each has four piles of dirt and both have ten shovelfuls of dirt in total. The numbers of shovelfuls in each dirt pile are assigned as follows:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-119-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;msub&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1710" style="width: 100%; display: inline-block; min-width: 16.347em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(3.121em, 1013.12em, 5.648em, -999.997em); top: -3.976em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-1711"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1012.69em, 4.304em, -999.997em); top: -3.976em; left: 50%; margin-left: -6.341em;"><span class="msubsup" id="MathJax-Span-1712"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1713" style="font-family: STIXGeneral; font-style: italic;">P</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.594em;"><span class="mn" id="MathJax-Span-1714" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1715" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-1716" style="font-family: STIXGeneral; padding-left: 0.325em;">3</span><span class="mo" id="MathJax-Span-1717" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-1718" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1719" style="font-family: STIXGeneral; font-style: italic;">P</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.594em;"><span class="mn" id="MathJax-Span-1720" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1721" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-1722" style="font-family: STIXGeneral; padding-left: 0.325em;">2</span><span class="mo" id="MathJax-Span-1723" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-1724" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1725" style="font-family: STIXGeneral; font-style: italic;">P</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.594em;"><span class="mn" id="MathJax-Span-1726" style="font-size: 70.7%; font-family: STIXGeneral;">3</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1727" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-1728" style="font-family: STIXGeneral; padding-left: 0.325em;">1</span><span class="mo" id="MathJax-Span-1729" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-1730" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1731" style="font-family: STIXGeneral; font-style: italic;">P</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.594em;"><span class="mn" id="MathJax-Span-1732" style="font-size: 70.7%; font-family: STIXGeneral;">4</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1733" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-1734" style="font-family: STIXGeneral; padding-left: 0.325em;">4</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1013.12em, 4.304em, -999.997em); top: -2.632em; left: 50%; margin-left: -6.61em;"><span class="mspace" id="MathJax-Span-1735" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-1736"><span style="display: inline-block; position: relative; width: 1.132em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1737" style="font-family: STIXGeneral; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="mn" id="MathJax-Span-1738" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1739" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-1740" style="font-family: STIXGeneral; padding-left: 0.325em;">1</span><span class="mo" id="MathJax-Span-1741" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-1742" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.132em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1743" style="font-family: STIXGeneral; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="mn" id="MathJax-Span-1744" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1745" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-1746" style="font-family: STIXGeneral; padding-left: 0.325em;">2</span><span class="mo" id="MathJax-Span-1747" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-1748" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.132em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1749" style="font-family: STIXGeneral; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="mn" id="MathJax-Span-1750" style="font-size: 70.7%; font-family: STIXGeneral;">3</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1751" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-1752" style="font-family: STIXGeneral; padding-left: 0.325em;">4</span><span class="mo" id="MathJax-Span-1753" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-1754" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.132em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1755" style="font-family: STIXGeneral; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="mn" id="MathJax-Span-1756" style="font-size: 70.7%; font-family: STIXGeneral;">4</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1757" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-1758" style="font-family: STIXGeneral; padding-left: 0.325em;">3</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.93em; border-left: 0px solid; width: 0px; height: 2.87em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>P</mi><mn>1</mn></msub><mo>=</mo><mn>3</mn><mo>,</mo><msub><mi>P</mi><mn>2</mn></msub><mo>=</mo><mn>2</mn><mo>,</mo><msub><mi>P</mi><mn>3</mn></msub><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>P</mi><mn>4</mn></msub><mo>=</mo><mn>4</mn><mspace linebreak="newline"></mspace><msub><mi>Q</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>Q</mi><mn>2</mn></msub><mo>=</mo><mn>2</mn><mo>,</mo><msub><mi>Q</mi><mn>3</mn></msub><mo>=</mo><mn>4</mn><mo>,</mo><msub><mi>Q</mi><mn>4</mn></msub><mo>=</mo><mn>3</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-119">P_1 = 3, P_2 = 2, P_3 = 1, P_4 = 4\\
Q_1 = 1, Q_2 = 2, Q_3 = 4, Q_4 = 3</script>

<p>In order to change <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-120-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1759" style="width: 0.755em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.59em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1760"><span class="mi" id="MathJax-Span-1761" style="font-family: STIXGeneral; font-style: italic;">P</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-120">P</script> to look like <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-121-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1762" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.7em, 2.852em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1763"><span class="mi" id="MathJax-Span-1764" style="font-family: STIXGeneral; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-121">Q</script>, as illustrated in Fig. x, we:</p>
<ul>
  <li>First move 2 shovelfuls from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-122-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1765" style="width: 1.293em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.562em, 1001.02em, 2.691em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1766"><span class="msubsup" id="MathJax-Span-1767"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1768" style="font-family: STIXGeneral; font-style: italic;">P</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.594em;"><span class="mn" id="MathJax-Span-1769" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.137em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>P</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-122">P_1</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-123-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1770" style="width: 1.293em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.562em, 1001.02em, 2.691em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1771"><span class="msubsup" id="MathJax-Span-1772"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1773" style="font-family: STIXGeneral; font-style: italic;">P</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.594em;"><span class="mn" id="MathJax-Span-1774" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.137em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>P</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-123">P_2</script> =&gt; <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-124-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1775" style="width: 4.035em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.228em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1003.17em, 2.852em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1776"><span class="mo" id="MathJax-Span-1777" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-1778"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1779" style="font-family: STIXGeneral; font-style: italic;">P</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.594em;"><span class="mn" id="MathJax-Span-1780" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1781" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-1782" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.132em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1783" style="font-family: STIXGeneral; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="mn" id="MathJax-Span-1784" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1785" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>P</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Q</mi><mn>1</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-124">(P_1, Q_1)</script> match up.</li>
  <li>Then move 2 shovelfuls from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-125-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1786" style="width: 1.293em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.562em, 1001.02em, 2.691em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1787"><span class="msubsup" id="MathJax-Span-1788"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1789" style="font-family: STIXGeneral; font-style: italic;">P</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.594em;"><span class="mn" id="MathJax-Span-1790" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.137em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>P</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-125">P_2</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-126-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1791" style="width: 1.293em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.562em, 1001.02em, 2.691em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1792"><span class="msubsup" id="MathJax-Span-1793"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1794" style="font-family: STIXGeneral; font-style: italic;">P</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.594em;"><span class="mn" id="MathJax-Span-1795" style="font-size: 70.7%; font-family: STIXGeneral;">3</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.137em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>P</mi><mn>3</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-126">P_3</script> =&gt; <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-127-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1796" style="width: 4.035em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.228em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1003.17em, 2.852em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1797"><span class="mo" id="MathJax-Span-1798" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-1799"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1800" style="font-family: STIXGeneral; font-style: italic;">P</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.594em;"><span class="mn" id="MathJax-Span-1801" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1802" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-1803" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.132em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1804" style="font-family: STIXGeneral; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="mn" id="MathJax-Span-1805" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1806" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>P</mi><mn>2</mn></msub><mo>,</mo><msub><mi>Q</mi><mn>2</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-127">(P_2, Q_2)</script> match up.</li>
  <li>Finally move 1 shovelfuls from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-128-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1807" style="width: 1.401em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.132em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.562em, 1001.13em, 2.691em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1808"><span class="msubsup" id="MathJax-Span-1809"><span style="display: inline-block; position: relative; width: 1.132em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1810" style="font-family: STIXGeneral; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="mn" id="MathJax-Span-1811" style="font-size: 70.7%; font-family: STIXGeneral;">3</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>Q</mi><mn>3</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-128">Q_3</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-129-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1812" style="width: 1.401em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.132em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.562em, 1001.13em, 2.691em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1813"><span class="msubsup" id="MathJax-Span-1814"><span style="display: inline-block; position: relative; width: 1.132em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1815" style="font-family: STIXGeneral; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="mn" id="MathJax-Span-1816" style="font-size: 70.7%; font-family: STIXGeneral;">4</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>Q</mi><mn>4</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-129">Q_4</script> =&gt; <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-130-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1817" style="width: 4.035em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.228em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1003.17em, 2.852em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1818"><span class="mo" id="MathJax-Span-1819" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-1820"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1821" style="font-family: STIXGeneral; font-style: italic;">P</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.594em;"><span class="mn" id="MathJax-Span-1822" style="font-size: 70.7%; font-family: STIXGeneral;">3</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1823" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-1824" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.132em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1825" style="font-family: STIXGeneral; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="mn" id="MathJax-Span-1826" style="font-size: 70.7%; font-family: STIXGeneral;">3</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1827" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>P</mi><mn>3</mn></msub><mo>,</mo><msub><mi>Q</mi><mn>3</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-130">(P_3, Q_3)</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-131-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1828" style="width: 4.035em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.228em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1003.17em, 2.852em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1829"><span class="mo" id="MathJax-Span-1830" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-1831"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1832" style="font-family: STIXGeneral; font-style: italic;">P</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.594em;"><span class="mn" id="MathJax-Span-1833" style="font-size: 70.7%; font-family: STIXGeneral;">4</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1834" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-1835" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.132em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1836" style="font-family: STIXGeneral; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="mn" id="MathJax-Span-1837" style="font-size: 70.7%; font-family: STIXGeneral;">4</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1838" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>P</mi><mn>4</mn></msub><mo>,</mo><msub><mi>Q</mi><mn>4</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-131">(P_4, Q_4)</script> match up.</li>
</ul>

<p>If we label the cost to pay to make <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-132-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1839" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.562em, 1000.86em, 2.691em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1840"><span class="msubsup" id="MathJax-Span-1841"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1842" style="font-family: STIXGeneral; font-style: italic;">P</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.594em;"><span class="mi" id="MathJax-Span-1843" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.137em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>P</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-132">P_i</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-133-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1844" style="width: 1.239em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.97em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.562em, 1000.97em, 2.691em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1845"><span class="msubsup" id="MathJax-Span-1846"><span style="display: inline-block; position: relative; width: 0.97em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1847" style="font-family: STIXGeneral; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="mi" id="MathJax-Span-1848" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>Q</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-133">Q_i</script> match as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-134-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1849" style="width: 0.97em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.755em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.562em, 1000.75em, 2.691em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1850"><span class="msubsup" id="MathJax-Span-1851"><span style="display: inline-block; position: relative; width: 0.755em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.49em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1852" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1853" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.137em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>δ</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-134">\delta_i</script>, we would have <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-135-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1854" style="width: 9.841em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.906em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1007.91em, 2.852em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1855"><span class="msubsup" id="MathJax-Span-1856"><span style="display: inline-block; position: relative; width: 1.562em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.49em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1857" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="texatom" id="MathJax-Span-1858"><span class="mrow" id="MathJax-Span-1859"><span class="mi" id="MathJax-Span-1860" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-1861" style="font-size: 70.7%; font-family: STIXGeneral;">+</span><span class="mn" id="MathJax-Span-1862" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1863" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="msubsup" id="MathJax-Span-1864" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 0.755em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.49em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1865" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1866" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1867" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="msubsup" id="MathJax-Span-1868" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1869" style="font-family: STIXGeneral; font-style: italic;">P</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.594em;"><span class="mi" id="MathJax-Span-1870" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1871" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="msubsup" id="MathJax-Span-1872" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 0.97em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1873" style="font-family: STIXGeneral; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="mi" id="MathJax-Span-1874" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>δ</mi><mi>i</mi></msub><mo>+</mo><msub><mi>P</mi><mi>i</mi></msub><mo>−</mo><msub><mi>Q</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-135">\delta_{i+1} = \delta_i + P_i - Q_i</script> and in the example:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-136-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1875" style="width: 11.239em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.035em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-1.234em, 1008.87em, 5.433em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1876"><span class="mtable" id="MathJax-Span-1877" style="padding-right: 0.164em; padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 8.712em; height: 0px;"><span style="position: absolute; clip: rect(3.712em, 1000.92em, 10.164em, -999.997em); top: -7.148em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.92em, 4.304em, -999.997em); top: -6.61em; right: 0em;"><span class="mtd" id="MathJax-Span-1878"><span class="mrow" id="MathJax-Span-1879"><span class="msubsup" id="MathJax-Span-1880"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.49em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1881" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mn" id="MathJax-Span-1882" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.175em, 1000.92em, 4.304em, -999.997em); top: -5.266em; right: 0em;"><span class="mtd" id="MathJax-Span-1888"><span class="mrow" id="MathJax-Span-1889"><span class="msubsup" id="MathJax-Span-1890"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.49em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1891" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mn" id="MathJax-Span-1892" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.175em, 1000.92em, 4.304em, -999.997em); top: -3.922em; right: 0em;"><span class="mtd" id="MathJax-Span-1904"><span class="mrow" id="MathJax-Span-1905"><span class="msubsup" id="MathJax-Span-1906"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.49em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1907" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mn" id="MathJax-Span-1908" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.175em, 1000.92em, 4.304em, -999.997em); top: -2.578em; right: 0em;"><span class="mtd" id="MathJax-Span-1920"><span class="mrow" id="MathJax-Span-1921"><span class="msubsup" id="MathJax-Span-1922"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.49em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1923" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mn" id="MathJax-Span-1924" style="font-size: 70.7%; font-family: STIXGeneral;">3</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.175em, 1000.92em, 4.304em, -999.997em); top: -1.234em; right: 0em;"><span class="mtd" id="MathJax-Span-1937"><span class="mrow" id="MathJax-Span-1938"><span class="msubsup" id="MathJax-Span-1939"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.49em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1940" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mn" id="MathJax-Span-1941" style="font-size: 70.7%; font-family: STIXGeneral;">4</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.153em;"></span></span><span style="position: absolute; clip: rect(3.712em, 1007.8em, 10.164em, -999.997em); top: -7.148em; left: 0.917em;"><span style="display: inline-block; position: relative; width: 7.798em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1001.83em, 4.142em, -999.997em); top: -6.61em; left: 0em;"><span class="mtd" id="MathJax-Span-1883"><span class="mrow" id="MathJax-Span-1884"><span class="mi" id="MathJax-Span-1885"></span><span class="mo" id="MathJax-Span-1886" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-1887" style="font-family: STIXGeneral; padding-left: 0.325em;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1007.1em, 4.304em, -999.997em); top: -5.266em; left: 0em;"><span class="mtd" id="MathJax-Span-1893"><span class="mrow" id="MathJax-Span-1894"><span class="mi" id="MathJax-Span-1895"></span><span class="mo" id="MathJax-Span-1896" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-1897" style="font-family: STIXGeneral; padding-left: 0.325em;">0</span><span class="mo" id="MathJax-Span-1898" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="mn" id="MathJax-Span-1899" style="font-family: STIXGeneral; padding-left: 0.272em;">3</span><span class="mo" id="MathJax-Span-1900" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="mn" id="MathJax-Span-1901" style="font-family: STIXGeneral; padding-left: 0.272em;">1</span><span class="mo" id="MathJax-Span-1902" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-1903" style="font-family: STIXGeneral; padding-left: 0.325em;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1007.1em, 4.304em, -999.997em); top: -3.922em; left: 0em;"><span class="mtd" id="MathJax-Span-1909"><span class="mrow" id="MathJax-Span-1910"><span class="mi" id="MathJax-Span-1911"></span><span class="mo" id="MathJax-Span-1912" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-1913" style="font-family: STIXGeneral; padding-left: 0.325em;">2</span><span class="mo" id="MathJax-Span-1914" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="mn" id="MathJax-Span-1915" style="font-family: STIXGeneral; padding-left: 0.272em;">2</span><span class="mo" id="MathJax-Span-1916" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="mn" id="MathJax-Span-1917" style="font-family: STIXGeneral; padding-left: 0.272em;">2</span><span class="mo" id="MathJax-Span-1918" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-1919" style="font-family: STIXGeneral; padding-left: 0.325em;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1007.69em, 4.304em, -999.997em); top: -2.578em; left: 0em;"><span class="mtd" id="MathJax-Span-1925"><span class="mrow" id="MathJax-Span-1926"><span class="mi" id="MathJax-Span-1927"></span><span class="mo" id="MathJax-Span-1928" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-1929" style="font-family: STIXGeneral; padding-left: 0.325em;">2</span><span class="mo" id="MathJax-Span-1930" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="mn" id="MathJax-Span-1931" style="font-family: STIXGeneral; padding-left: 0.272em;">1</span><span class="mo" id="MathJax-Span-1932" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="mn" id="MathJax-Span-1933" style="font-family: STIXGeneral; padding-left: 0.272em;">4</span><span class="mo" id="MathJax-Span-1934" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mo" id="MathJax-Span-1935" style="font-family: STIXGeneral; padding-left: 0.325em;">−</span><span class="mn" id="MathJax-Span-1936" style="font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1007.8em, 4.304em, -999.997em); top: -1.234em; left: 0em;"><span class="mtd" id="MathJax-Span-1942"><span class="mrow" id="MathJax-Span-1943"><span class="mi" id="MathJax-Span-1944"></span><span class="mo" id="MathJax-Span-1945" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mo" id="MathJax-Span-1946" style="font-family: STIXGeneral; padding-left: 0.325em;">−</span><span class="mn" id="MathJax-Span-1947" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-1948" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="mn" id="MathJax-Span-1949" style="font-family: STIXGeneral; padding-left: 0.272em;">4</span><span class="mo" id="MathJax-Span-1950" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="mn" id="MathJax-Span-1951" style="font-family: STIXGeneral; padding-left: 0.272em;">3</span><span class="mo" id="MathJax-Span-1952" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-1953" style="font-family: STIXGeneral; padding-left: 0.325em;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.153em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.663em; border-left: 0px solid; width: 0px; height: 8.003em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>δ</mi><mn>0</mn></msub></mtd><mtd><mi></mi><mo>=</mo><mn>0</mn></mtd></mtr><mtr><mtd><msub><mi>δ</mi><mn>1</mn></msub></mtd><mtd><mi></mi><mo>=</mo><mn>0</mn><mo>+</mo><mn>3</mn><mo>−</mo><mn>1</mn><mo>=</mo><mn>2</mn></mtd></mtr><mtr><mtd><msub><mi>δ</mi><mn>2</mn></msub></mtd><mtd><mi></mi><mo>=</mo><mn>2</mn><mo>+</mo><mn>2</mn><mo>−</mo><mn>2</mn><mo>=</mo><mn>2</mn></mtd></mtr><mtr><mtd><msub><mi>δ</mi><mn>3</mn></msub></mtd><mtd><mi></mi><mo>=</mo><mn>2</mn><mo>+</mo><mn>1</mn><mo>−</mo><mn>4</mn><mo>=</mo><mo>−</mo><mn>1</mn></mtd></mtr><mtr><mtd><msub><mi>δ</mi><mn>4</mn></msub></mtd><mtd><mi></mi><mo>=</mo><mo>−</mo><mn>1</mn><mo>+</mo><mn>4</mn><mo>−</mo><mn>3</mn><mo>=</mo><mn>0</mn></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-136">% <![CDATA[
\begin{aligned}
\delta_0 &= 0\\
\delta_1 &= 0 + 3 - 1 = 2\\
\delta_2 &= 2 + 2 - 2 = 2\\
\delta_3 &= 2 + 1 - 4 = -1\\
\delta_4 &= -1 + 4 - 3 = 0
\end{aligned} %]]></script>

<p>Finally the Earth Mover’s distance is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-137-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1954" style="width: 8.067em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.508em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.616em, 1006.45em, 2.96em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1955"><span class="mi" id="MathJax-Span-1956" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-1957" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mo" id="MathJax-Span-1958" style="font-family: STIXGeneral; vertical-align: 0.003em; padding-left: 0.325em;">∑</span><span class="mo" id="MathJax-Span-1959" style="font-family: STIXVariants; padding-left: 0.164em;">|</span><span class="msubsup" id="MathJax-Span-1960"><span style="display: inline-block; position: relative; width: 0.755em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.49em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1961" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1962" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1963" style="font-family: STIXVariants;">|</span><span class="mo" id="MathJax-Span-1964" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-1965" style="font-family: STIXGeneral; padding-left: 0.325em;">5</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.403em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi><mo>=</mo><mo>∑</mo><mo fence="false" stretchy="false">|</mo><msub><mi>δ</mi><mi>i</mi></msub><mo fence="false" stretchy="false">|</mo><mo>=</mo><mn>5</mn></math></span></span><script type="math/tex" id="MathJax-Element-137">W = \sum \vert \delta_i \vert = 5</script>.</p>

<p class="center"><img src="./From GAN to WGAN_files/EM_distance_discrete.png" alt="EM distance for discrete case"></p>
<p><em>Fig. 7. Step-by-step plan of moving dirt between piles in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-138-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1966" style="width: 0.755em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.59em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1967"><span class="mi" id="MathJax-Span-1968" style="font-family: STIXGeneral; font-style: italic;">P</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-138">P</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-139-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1969" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.7em, 2.852em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1970"><span class="mi" id="MathJax-Span-1971" style="font-family: STIXGeneral; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-139">Q</script> to make them match.</em></p>

<p>When dealing with the continuous probability domain, the distance formula becomes:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-140-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;inf&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1972" style="width: 18.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.11em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1015em, 3.712em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-1973"><span class="mi" id="MathJax-Span-1974" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-1975" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-1976"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1977" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1978" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1979" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-1980" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1981" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-1982" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1983" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-1984" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="munderover" id="MathJax-Span-1985" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 3.228em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1001.18em, 4.142em, -999.997em); top: -3.976em; left: 1.078em;"><span class="mo" id="MathJax-Span-1986" style="font-family: STIXGeneral;">inf</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1003.17em, 4.519em, -999.997em); top: -3.277em; left: 0em;"><span class="texatom" id="MathJax-Span-1987"><span class="mrow" id="MathJax-Span-1988"><span class="mi" id="MathJax-Span-1989" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1990" style="font-size: 70.7%; font-family: STIXGeneral;">∼</span><span class="mi" id="MathJax-Span-1991" style="font-size: 70.7%; font-family: STIXGeneral;">Π</span><span class="mo" id="MathJax-Span-1992" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-1993"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1994" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.379em;"><span class="mi" id="MathJax-Span-1995" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-1996" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-1997"><span style="display: inline-block; position: relative; width: 0.648em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-1998" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.379em;"><span class="mi" id="MathJax-Span-1999" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2000" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2001" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 2.798em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="texatom" id="MathJax-Span-2002"><span class="mrow" id="MathJax-Span-2003"><span class="mi" id="MathJax-Span-2004" style="font-family: STIXGeneral;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.648em;"><span class="texatom" id="MathJax-Span-2005"><span class="mrow" id="MathJax-Span-2006"><span class="mo" id="MathJax-Span-2007" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2008" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2009" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2010" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span class="mo" id="MathJax-Span-2011" style="font-size: 70.7%; font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2012" style="font-size: 70.7%; font-family: STIXGeneral;">∼</span><span class="mi" id="MathJax-Span-2013" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2014" style="font-family: STIXGeneral;">[</span><span class="mo" id="MathJax-Span-2015" style="font-family: STIXGeneral;">‖</span><span class="mi" id="MathJax-Span-2016" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2017" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="mi" id="MathJax-Span-2018" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.272em;">y</span><span class="mo" id="MathJax-Span-2019" style="font-family: STIXGeneral;">‖</span><span class="mo" id="MathJax-Span-2020" style="font-family: STIXGeneral;">]</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.33em; border-left: 0px solid; width: 0px; height: 2.27em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>W</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mi>r</mi></msub><mo>,</mo><msub><mi>p</mi><mi>g</mi></msub><mo stretchy="false">)</mo><mo>=</mo><munder><mo movablelimits="true" form="prefix">inf</mo><mrow class="MJX-TeXAtom-ORD"><mi>γ</mi><mo>∼</mo><mi mathvariant="normal">Π</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mi>r</mi></msub><mo>,</mo><msub><mi>p</mi><mi>g</mi></msub><mo stretchy="false">)</mo></mrow></munder><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>∼</mo><mi>γ</mi></mrow></msub><mo stretchy="false">[</mo><mo fence="false" stretchy="false">‖</mo><mi>x</mi><mo>−</mo><mi>y</mi><mo fence="false" stretchy="false">‖</mo><mo stretchy="false">]</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-140">W(p_r, p_g) = \inf_{\gamma \sim \Pi(p_r, p_g)} \mathbb{E}_{(x, y) \sim \gamma}[\| x-y \|]</script>

<p>In the formula above, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-141-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2021" style="width: 4.465em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.605em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1003.55em, 2.96em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2022"><span class="mi" id="MathJax-Span-2023" style="font-family: STIXGeneral;">Π</span><span class="mo" id="MathJax-Span-2024" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-2025"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2026" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-2027" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2028" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-2029" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2030" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-2031" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2032" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.337em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Π</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mi>r</mi></msub><mo>,</mo><msub><mi>p</mi><mi>g</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-141">\Pi(p_r, p_g)</script> is the set of all possible joint probability distributions between <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-142-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2033" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.777em, 1000.86em, 2.745em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2034"><span class="msubsup" id="MathJax-Span-2035"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2036" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-2037" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>r</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-142">p_r</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-143-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2038" style="width: 1.132em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.777em, 1000.92em, 2.798em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2039"><span class="msubsup" id="MathJax-Span-2040"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2041" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-2042" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.07em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>g</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-143">p_g</script>. One joint distribution <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-144-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2043" style="width: 6.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.379em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1005.33em, 2.96em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2044"><span class="mi" id="MathJax-Span-2045" style="font-family: STIXGeneral; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-2046" style="font-family: STIXGeneral; padding-left: 0.325em;">∈</span><span class="mi" id="MathJax-Span-2047" style="font-family: STIXGeneral; padding-left: 0.325em;">Π</span><span class="mo" id="MathJax-Span-2048" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-2049"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2050" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-2051" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2052" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-2053" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2054" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-2055" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2056" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.337em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi><mo>∈</mo><mi mathvariant="normal">Π</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mi>r</mi></msub><mo>,</mo><msub><mi>p</mi><mi>g</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-144">\gamma \in \Pi(p_r, p_g)</script> describes one dirt transport plan, same as the discrete example above, but in the continuous probability space. Precisely <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-145-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2057" style="width: 3.013em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.422em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1002.37em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2058"><span class="mi" id="MathJax-Span-2059" style="font-family: STIXGeneral; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-2060" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2061" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2062" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2063" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">y</span><span class="mo" id="MathJax-Span-2064" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-145">\gamma(x, y)</script> states the percentage of dirt should be transported from point <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-146-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2065" style="width: 0.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.43em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2066"><span class="mi" id="MathJax-Span-2067" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.67em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-146">x</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-147-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2068" style="width: 0.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.43em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2069"><span class="mi" id="MathJax-Span-2070" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-147">y</script> so as to make <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-148-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2071" style="width: 0.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.43em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2072"><span class="mi" id="MathJax-Span-2073" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.67em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-148">x</script> follows the same probability distribution of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-149-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2074" style="width: 0.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.43em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2075"><span class="mi" id="MathJax-Span-2076" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-149">y</script>. That’s why the marginal distribution over <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-150-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2077" style="width: 0.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.43em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2078"><span class="mi" id="MathJax-Span-2079" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.67em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-150">x</script> adds up to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-151-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2080" style="width: 1.132em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.777em, 1000.92em, 2.798em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2081"><span class="msubsup" id="MathJax-Span-2082"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2083" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-2084" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.07em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>g</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-151">p_g</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-152-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2085" style="width: 9.035em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.261em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.616em, 1007.21em, 3.013em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2086"><span class="munderover" id="MathJax-Span-2087"><span style="display: inline-block; position: relative; width: 1.293em; height: 0px;"><span style="position: absolute; clip: rect(3.067em, 1000.86em, 4.411em, -999.997em); top: -3.976em; left: 0em;"><span class="mo" id="MathJax-Span-2088" style="font-family: STIXGeneral; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.653em; left: 0.917em;"><span class="texatom" id="MathJax-Span-2089"><span class="mrow" id="MathJax-Span-2090"><span class="mi" id="MathJax-Span-2091" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mi" id="MathJax-Span-2092" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-2093" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2094" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2095" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2096" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">y</span><span class="mo" id="MathJax-Span-2097" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2098" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="msubsup" id="MathJax-Span-2099" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2100" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-2101" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2102" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2103" style="font-family: STIXGeneral; font-style: italic;">y</span><span class="mo" id="MathJax-Span-2104" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.463em; border-left: 0px solid; width: 0px; height: 1.47em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></munder><mi>γ</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>p</mi><mi>g</mi></msub><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-152">\sum_{x} \gamma(x, y) = p_g(y)</script> (Once we finish moving the planned amount of dirt from every possible <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-153-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2105" style="width: 0.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.43em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2106"><span class="mi" id="MathJax-Span-2107" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.67em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-153">x</script> to the target <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-154-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2108" style="width: 0.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.43em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2109"><span class="mi" id="MathJax-Span-2110" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-154">y</script>, we end up with exactly what <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-155-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2111" style="width: 0.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.43em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2112"><span class="mi" id="MathJax-Span-2113" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-155">y</script> has according to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-156-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2114" style="width: 1.132em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.777em, 1000.92em, 2.798em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2115"><span class="msubsup" id="MathJax-Span-2116"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2117" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-2118" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.07em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>g</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-156">p_g</script>.) and vice versa <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-157-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2119" style="width: 8.927em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.207em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.616em, 1007.15em, 3.121em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2120"><span class="munderover" id="MathJax-Span-2121"><span style="display: inline-block; position: relative; width: 1.293em; height: 0px;"><span style="position: absolute; clip: rect(3.067em, 1000.86em, 4.411em, -999.997em); top: -3.976em; left: 0em;"><span class="mo" id="MathJax-Span-2122" style="font-family: STIXGeneral; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.653em; left: 0.917em;"><span class="texatom" id="MathJax-Span-2123"><span class="mrow" id="MathJax-Span-2124"><span class="mi" id="MathJax-Span-2125" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mi" id="MathJax-Span-2126" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-2127" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2128" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2129" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2130" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">y</span><span class="mo" id="MathJax-Span-2131" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2132" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="msubsup" id="MathJax-Span-2133" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2134" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-2135" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2136" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2137" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2138" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.597em; border-left: 0px solid; width: 0px; height: 1.603em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></munder><mi>γ</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>p</mi><mi>r</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-157">\sum_{y} \gamma(x, y) = p_r(x)</script>.</p>

<p>When treating <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-158-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2139" style="width: 0.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.43em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2140"><span class="mi" id="MathJax-Span-2141" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.67em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-158">x</script> as the starting point and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-159-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2142" style="width: 0.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.43em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2143"><span class="mi" id="MathJax-Span-2144" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-159">y</script> as the destination, the total amount of dirt moved is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-160-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2145" style="width: 3.013em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.422em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1002.37em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2146"><span class="mi" id="MathJax-Span-2147" style="font-family: STIXGeneral; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-2148" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2149" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2150" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2151" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">y</span><span class="mo" id="MathJax-Span-2152" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-160">\gamma(x, y)</script> and the travelling distance is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-161-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2153" style="width: 3.927em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.175em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1003.07em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2154"><span class="mo" id="MathJax-Span-2155" style="font-family: STIXGeneral;">‖</span><span class="mi" id="MathJax-Span-2156" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2157" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="mi" id="MathJax-Span-2158" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.272em;">y</span><span class="mo" id="MathJax-Span-2159" style="font-family: STIXGeneral;">‖</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.27em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">‖</mo><mi>x</mi><mo>−</mo><mi>y</mi><mo fence="false" stretchy="false">‖</mo></math></span></span><script type="math/tex" id="MathJax-Element-161">\| x-y \|</script> and thus the cost is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-162-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2160" style="width: 7.96em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.401em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1006.29em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2161"><span class="mi" id="MathJax-Span-2162" style="font-family: STIXGeneral; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-2163" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2164" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2165" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2166" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">y</span><span class="mo" id="MathJax-Span-2167" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2168" style="font-family: STIXGeneral; padding-left: 0.272em;">⋅</span><span class="mo" id="MathJax-Span-2169" style="font-family: STIXGeneral; padding-left: 0.272em;">‖</span><span class="mi" id="MathJax-Span-2170" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2171" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="mi" id="MathJax-Span-2172" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.272em;">y</span><span class="mo" id="MathJax-Span-2173" style="font-family: STIXGeneral;">‖</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.27em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>⋅</mo><mo fence="false" stretchy="false">‖</mo><mi>x</mi><mo>−</mo><mi>y</mi><mo fence="false" stretchy="false">‖</mo></math></span></span><script type="math/tex" id="MathJax-Element-162">\gamma(x, y) \cdot \| x-y \|</script>. The expected cost averaged across all the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-163-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2174" style="width: 2.476em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.992em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1001.94em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2175"><span class="mo" id="MathJax-Span-2176" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2177" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2178" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2179" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">y</span><span class="mo" id="MathJax-Span-2180" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-163">(x,y)</script> pairs can be easily computed as:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-164-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2181" style="width: 17.153em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.82em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.401em, 1013.71em, 4.089em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2182"><span class="munderover" id="MathJax-Span-2183"><span style="display: inline-block; position: relative; width: 1.293em; height: 0px;"><span style="position: absolute; clip: rect(2.852em, 1001.18em, 4.626em, -999.997em); top: -3.976em; left: 0em;"><span class="mo" id="MathJax-Span-2184" style="font-family: STIXSizeOneSym; vertical-align: -0.535em;">∑</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.497em, 1000.81em, 4.411em, -999.997em); top: -2.847em; left: 0.272em;"><span class="texatom" id="MathJax-Span-2185"><span class="mrow" id="MathJax-Span-2186"><span class="mi" id="MathJax-Span-2187" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2188" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2189" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mi" id="MathJax-Span-2190" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-2191" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2192" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2193" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2194" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">y</span><span class="mo" id="MathJax-Span-2195" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2196" style="font-family: STIXGeneral;">‖</span><span class="mi" id="MathJax-Span-2197" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2198" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="mi" id="MathJax-Span-2199" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.272em;">y</span><span class="mo" id="MathJax-Span-2200" style="font-family: STIXGeneral;">‖</span><span class="mo" id="MathJax-Span-2201" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="msubsup" id="MathJax-Span-2202" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 2.315em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="texatom" id="MathJax-Span-2203"><span class="mrow" id="MathJax-Span-2204"><span class="mi" id="MathJax-Span-2205" style="font-family: STIXGeneral;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.648em;"><span class="texatom" id="MathJax-Span-2206"><span class="mrow" id="MathJax-Span-2207"><span class="mi" id="MathJax-Span-2208" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2209" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2210" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span class="mo" id="MathJax-Span-2211" style="font-size: 70.7%; font-family: STIXGeneral;">∼</span><span class="mi" id="MathJax-Span-2212" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2213" style="font-family: STIXGeneral;">‖</span><span class="mi" id="MathJax-Span-2214" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2215" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="mi" id="MathJax-Span-2216" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.272em;">y</span><span class="mo" id="MathJax-Span-2217" style="font-family: STIXGeneral;">‖</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.797em; border-left: 0px solid; width: 0px; height: 3.07em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>,</mo><mi>y</mi></mrow></munder><mi>γ</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="false">‖</mo><mi>x</mi><mo>−</mo><mi>y</mi><mo fence="false" stretchy="false">‖</mo><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>,</mo><mi>y</mi><mo>∼</mo><mi>γ</mi></mrow></msub><mo fence="false" stretchy="false">‖</mo><mi>x</mi><mo>−</mo><mi>y</mi><mo fence="false" stretchy="false">‖</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-164">\sum_{x, y} \gamma(x, y) \| x-y \| 
= \mathbb{E}_{x, y \sim \gamma} \| x-y \|</script>

<p>Finally, we take the minimum one among the costs of all dirt moving solutions as the EM distance. In the definition of Wasserstein distance, the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-165-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;inf&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2218" style="width: 1.401em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.132em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1001.18em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2219"><span class="mo" id="MathJax-Span-2220" style="font-family: STIXGeneral;">inf</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo movablelimits="true" form="prefix">inf</mo></math></span></span><script type="math/tex" id="MathJax-Element-165">\inf</script> (<a href="https://en.wikipedia.org/wiki/Infimum_and_supremum">infimum</a>, also known as <em>greatest lower bound</em>) indicates that we are only interested in the smallest cost.</p>

<h3 id="why-wasserstein-is-better-than-js-or-kl-divergence">Why Wasserstein is better than JS or KL divergence?</h3>

<p>Even when two distributions are located in lower dimensional manifolds without overlaps, Wasserstein distance can still provide a meaningful and smooth representation of the distance in-between.</p>

<p>The WGAN paper exemplified the idea with a simple example.</p>

<p>Suppose we have two probability distributions, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-166-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2221" style="width: 0.755em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.59em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2222"><span class="mi" id="MathJax-Span-2223" style="font-family: STIXGeneral; font-style: italic;">P</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-166">P</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-167-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2224" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.7em, 2.852em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2225"><span class="mi" id="MathJax-Span-2226" style="font-family: STIXGeneral; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-167">Q</script>:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-168-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2200;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mtext&gt;&amp;#xA0;and&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2200;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mtext&gt;&amp;#xA0;and&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2227" style="width: 100%; display: inline-block; min-width: 22.906em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(3.39em, 1018.39em, 6.992em, -999.997em); top: -4.245em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-2228"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1013.71em, 4.358em, -999.997em); top: -3.976em; left: 50%; margin-left: -6.879em;"><span class="mi" id="MathJax-Span-2229" style="font-family: STIXGeneral;">∀</span><span class="mo" id="MathJax-Span-2230" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2231" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2232" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2233" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">y</span><span class="mo" id="MathJax-Span-2234" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2235" style="font-family: STIXGeneral; padding-left: 0.325em;">∈</span><span class="mi" id="MathJax-Span-2236" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.325em;">P</span><span class="mo" id="MathJax-Span-2237" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2238" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2239" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-2240" style="font-family: STIXGeneral; padding-left: 0.325em;">0</span><span class="mtext" id="MathJax-Span-2241" style="font-family: STIXGeneral;">&nbsp;and&nbsp;</span><span class="mi" id="MathJax-Span-2242" style="font-family: STIXGeneral; font-style: italic;">y</span><span class="mo" id="MathJax-Span-2243" style="font-family: STIXGeneral; padding-left: 0.325em;">∼</span><span class="mi" id="MathJax-Span-2244" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.325em;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-2245" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-2246" style="font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-2247" style="font-family: STIXGeneral;">,</span><span class="mn" id="MathJax-Span-2248" style="font-family: STIXGeneral; padding-left: 0.164em;">1</span><span class="mo" id="MathJax-Span-2249" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1018.39em, 4.358em, -999.997em); top: -2.578em; left: 50%; margin-left: -9.191em;"><span class="mspace" id="MathJax-Span-2250" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-2251" style="font-family: STIXGeneral;">∀</span><span class="mo" id="MathJax-Span-2252" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2253" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2254" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2255" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">y</span><span class="mo" id="MathJax-Span-2256" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2257" style="font-family: STIXGeneral; padding-left: 0.325em;">∈</span><span class="mi" id="MathJax-Span-2258" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.325em;">Q</span><span class="mo" id="MathJax-Span-2259" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2260" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2261" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mi" id="MathJax-Span-2262" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.325em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2263" style="font-family: STIXGeneral;">,</span><span class="mn" id="MathJax-Span-2264" style="font-family: STIXGeneral; padding-left: 0.164em;">0</span><span class="mo" id="MathJax-Span-2265" style="font-family: STIXGeneral; padding-left: 0.325em;">≤</span><span class="mi" id="MathJax-Span-2266" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.325em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2267" style="font-family: STIXGeneral; padding-left: 0.325em;">≤</span><span class="mn" id="MathJax-Span-2268" style="font-family: STIXGeneral; padding-left: 0.325em;">1</span><span class="mtext" id="MathJax-Span-2269" style="font-family: STIXGeneral;">&nbsp;and&nbsp;</span><span class="mi" id="MathJax-Span-2270" style="font-family: STIXGeneral; font-style: italic;">y</span><span class="mo" id="MathJax-Span-2271" style="font-family: STIXGeneral; padding-left: 0.325em;">∼</span><span class="mi" id="MathJax-Span-2272" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.325em;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-2273" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-2274" style="font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-2275" style="font-family: STIXGeneral;">,</span><span class="mn" id="MathJax-Span-2276" style="font-family: STIXGeneral; padding-left: 0.164em;">1</span><span class="mo" id="MathJax-Span-2277" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.82em, 1000em, 4.142em, -999.997em); top: -1.395em; left: 50%; margin-left: 0em;"><span class="mspace" id="MathJax-Span-2278" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.25em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.263em; border-left: 0px solid; width: 0px; height: 4.203em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi mathvariant="normal">∀</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>∈</mo><mi>P</mi><mo>,</mo><mi>x</mi><mo>=</mo><mn>0</mn><mtext>&nbsp;and&nbsp;</mtext><mi>y</mi><mo>∼</mo><mi>U</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi mathvariant="normal">∀</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>∈</mo><mi>Q</mi><mo>,</mo><mi>x</mi><mo>=</mo><mi>θ</mi><mo>,</mo><mn>0</mn><mo>≤</mo><mi>θ</mi><mo>≤</mo><mn>1</mn><mtext>&nbsp;and&nbsp;</mtext><mi>y</mi><mo>∼</mo><mi>U</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-168">\forall (x, y) \in P, x = 0 \text{ and } y \sim U(0, 1)\\
\forall (x, y) \in Q, x = \theta, 0 \leq \theta \leq 1 \text{ and } y \sim U(0, 1)\\</script>

<p style="width: 480px;" class="center"><img src="./From GAN to WGAN_files/wasserstein_simple_example.png" alt="Simple example"></p>
<p><em>Fig. 8. There is no overlap between <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-169-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2279" style="width: 0.755em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.59em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2280"><span class="mi" id="MathJax-Span-2281" style="font-family: STIXGeneral; font-style: italic;">P</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-169">P</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-170-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2282" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.7em, 2.852em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2283"><span class="mi" id="MathJax-Span-2284" style="font-family: STIXGeneral; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-170">Q</script> when <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-171-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2285" style="width: 2.906em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.315em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1002.32em, 2.852em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2286"><span class="mi" id="MathJax-Span-2287" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2288" style="font-family: STIXGeneral; padding-left: 0.325em;">≠</span><span class="mn" id="MathJax-Span-2289" style="font-family: STIXGeneral; padding-left: 0.325em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi><mo>≠</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-171">\theta \neq 0</script>.</em></p>

<p>When <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-172-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2290" style="width: 2.906em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.315em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1002.32em, 2.852em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2291"><span class="mi" id="MathJax-Span-2292" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2293" style="font-family: STIXGeneral; padding-left: 0.325em;">≠</span><span class="mn" id="MathJax-Span-2294" style="font-family: STIXGeneral; padding-left: 0.325em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi><mo>≠</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-172">\theta \neq 0</script>:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-173-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2295" style="width: 36.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 29.089em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-3.169em, 1028.87em, 7.422em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2296"><span class="mtable" id="MathJax-Span-2297" style="padding-right: 0.164em; padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 28.766em; height: 0px;"><span style="position: absolute; clip: rect(5.702em, 1004.2em, 15.594em, -999.997em); top: -10.589em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.25em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1004.2em, 4.358em, -999.997em); top: -8.008em; right: 0em;"><span class="mtd" id="MathJax-Span-2298"><span class="mrow" id="MathJax-Span-2299"><span class="msubsup" id="MathJax-Span-2300"><span style="display: inline-block; position: relative; width: 1.723em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2301" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="texatom" id="MathJax-Span-2302"><span class="mrow" id="MathJax-Span-2303"><span class="mi" id="MathJax-Span-2304" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-2305" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2306" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2307" style="font-family: STIXGeneral; font-style: italic;">P</span><span class="mo" id="MathJax-Span-2308" style="font-family: STIXGeneral;">‖</span><span class="mi" id="MathJax-Span-2309" style="font-family: STIXGeneral; font-style: italic;">Q</span><span class="mo" id="MathJax-Span-2310" style="font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1004.2em, 4.358em, -999.997em); top: -4.89em; right: 0em;"><span class="mtd" id="MathJax-Span-2341"><span class="mrow" id="MathJax-Span-2342"><span class="msubsup" id="MathJax-Span-2343"><span style="display: inline-block; position: relative; width: 1.723em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2344" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="texatom" id="MathJax-Span-2345"><span class="mrow" id="MathJax-Span-2346"><span class="mi" id="MathJax-Span-2347" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-2348" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2349" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2350" style="font-family: STIXGeneral; font-style: italic;">Q</span><span class="mo" id="MathJax-Span-2351" style="font-family: STIXGeneral;">‖</span><span class="mi" id="MathJax-Span-2352" style="font-family: STIXGeneral; font-style: italic;">P</span><span class="mo" id="MathJax-Span-2353" style="font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1003.87em, 4.304em, -999.997em); top: -1.825em; right: 0em;"><span class="mtd" id="MathJax-Span-2384"><span class="mrow" id="MathJax-Span-2385"><span class="msubsup" id="MathJax-Span-2386"><span style="display: inline-block; position: relative; width: 1.508em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2387" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="texatom" id="MathJax-Span-2388"><span class="mrow" id="MathJax-Span-2389"><span class="mi" id="MathJax-Span-2390" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-2391" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2392" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2393" style="font-family: STIXGeneral; font-style: italic;">P</span><span class="mo" id="MathJax-Span-2394" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2395" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">Q</span><span class="mo" id="MathJax-Span-2396" style="font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1003.28em, 4.304em, -999.997em); top: 0.702em; right: 0em;"><span class="mtd" id="MathJax-Span-2467"><span class="mrow" id="MathJax-Span-2468"><span class="mi" id="MathJax-Span-2469" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-2470" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2471" style="font-family: STIXGeneral; font-style: italic;">P</span><span class="mo" id="MathJax-Span-2472" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2473" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">Q</span><span class="mo" id="MathJax-Span-2474" style="font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.594em;"></span></span><span style="position: absolute; clip: rect(5.702em, 1024.52em, 16.293em, -999.997em); top: -11.234em; left: 4.25em;"><span style="display: inline-block; position: relative; width: 24.573em; height: 0px;"><span style="position: absolute; clip: rect(2.476em, 1012.05em, 5.54em, -999.997em); top: -8.008em; left: 0em;"><span class="mtd" id="MathJax-Span-2311"><span class="mrow" id="MathJax-Span-2312"><span class="mi" id="MathJax-Span-2313"></span><span class="mo" id="MathJax-Span-2314" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="munderover" id="MathJax-Span-2315" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 4.035em; height: 0px;"><span style="position: absolute; clip: rect(2.852em, 1001.18em, 4.626em, -999.997em); top: -3.976em; left: 1.347em;"><span class="mo" id="MathJax-Span-2316" style="font-family: STIXSizeOneSym; vertical-align: -0.535em;">∑</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1003.98em, 4.411em, -999.997em); top: -2.847em; left: 0em;"><span class="texatom" id="MathJax-Span-2317"><span class="mrow" id="MathJax-Span-2318"><span class="mi" id="MathJax-Span-2319" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2320" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-2321" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-2322" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2323" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span class="mo" id="MathJax-Span-2324" style="font-size: 70.7%; font-family: STIXGeneral;">∼</span><span class="mi" id="MathJax-Span-2325" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-2326" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-2327" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-2328" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mn" id="MathJax-Span-2329" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-2330" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mn" id="MathJax-Span-2331" style="font-family: STIXGeneral; padding-left: 0.164em;">1</span><span class="mo" id="MathJax-Span-2332" style="font-family: STIXGeneral; padding-left: 0.272em;">⋅</span><span class="mi" id="MathJax-Span-2333" style="font-family: STIXGeneral; padding-left: 0.272em;">log</span><span class="mo" id="MathJax-Span-2334"></span><span class="mfrac" id="MathJax-Span-2335" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.648em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-2336" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1000.49em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-2337" style="font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1000.65em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.648em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-2338" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mo" id="MathJax-Span-2339" style="font-family: STIXGeneral; padding-left: 0.325em;">+</span><span class="mi" id="MathJax-Span-2340" style="font-family: STIXGeneral;">∞</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(2.476em, 1012.05em, 5.54em, -999.997em); top: -4.89em; left: 0em;"><span class="mtd" id="MathJax-Span-2354"><span class="mrow" id="MathJax-Span-2355"><span class="mi" id="MathJax-Span-2356"></span><span class="mo" id="MathJax-Span-2357" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="munderover" id="MathJax-Span-2358" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 4.035em; height: 0px;"><span style="position: absolute; clip: rect(2.852em, 1001.18em, 4.626em, -999.997em); top: -3.976em; left: 1.347em;"><span class="mo" id="MathJax-Span-2359" style="font-family: STIXSizeOneSym; vertical-align: -0.535em;">∑</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1003.98em, 4.411em, -999.997em); top: -2.847em; left: 0em;"><span class="texatom" id="MathJax-Span-2360"><span class="mrow" id="MathJax-Span-2361"><span class="mi" id="MathJax-Span-2362" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2363" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mi" id="MathJax-Span-2364" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2365" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2366" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span class="mo" id="MathJax-Span-2367" style="font-size: 70.7%; font-family: STIXGeneral;">∼</span><span class="mi" id="MathJax-Span-2368" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-2369" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-2370" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-2371" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mn" id="MathJax-Span-2372" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-2373" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mn" id="MathJax-Span-2374" style="font-family: STIXGeneral; padding-left: 0.164em;">1</span><span class="mo" id="MathJax-Span-2375" style="font-family: STIXGeneral; padding-left: 0.272em;">⋅</span><span class="mi" id="MathJax-Span-2376" style="font-family: STIXGeneral; padding-left: 0.272em;">log</span><span class="mo" id="MathJax-Span-2377"></span><span class="mfrac" id="MathJax-Span-2378" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.648em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-2379" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1000.49em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-2380" style="font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1000.65em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.648em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-2381" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mo" id="MathJax-Span-2382" style="font-family: STIXGeneral; padding-left: 0.325em;">+</span><span class="mi" id="MathJax-Span-2383" style="font-family: STIXGeneral;">∞</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(2.476em, 1024.52em, 5.54em, -999.997em); top: -1.825em; left: 0em;"><span class="mtd" id="MathJax-Span-2397"><span class="mrow" id="MathJax-Span-2398"><span class="mi" id="MathJax-Span-2399"></span><span class="mo" id="MathJax-Span-2400" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mfrac" id="MathJax-Span-2401" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 0.648em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-2402" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1000.49em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-2403" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1000.65em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.648em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-2404" style="font-family: STIXGeneral;">(</span><span class="munderover" id="MathJax-Span-2405"><span style="display: inline-block; position: relative; width: 4.035em; height: 0px;"><span style="position: absolute; clip: rect(2.852em, 1001.18em, 4.626em, -999.997em); top: -3.976em; left: 1.347em;"><span class="mo" id="MathJax-Span-2406" style="font-family: STIXSizeOneSym; vertical-align: -0.535em;">∑</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1003.98em, 4.411em, -999.997em); top: -2.847em; left: 0em;"><span class="texatom" id="MathJax-Span-2407"><span class="mrow" id="MathJax-Span-2408"><span class="mi" id="MathJax-Span-2409" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2410" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-2411" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-2412" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2413" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span class="mo" id="MathJax-Span-2414" style="font-size: 70.7%; font-family: STIXGeneral;">∼</span><span class="mi" id="MathJax-Span-2415" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-2416" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-2417" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-2418" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mn" id="MathJax-Span-2419" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-2420" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mn" id="MathJax-Span-2421" style="font-family: STIXGeneral; padding-left: 0.164em;">1</span><span class="mo" id="MathJax-Span-2422" style="font-family: STIXGeneral; padding-left: 0.272em;">⋅</span><span class="mi" id="MathJax-Span-2423" style="font-family: STIXGeneral; padding-left: 0.272em;">log</span><span class="mo" id="MathJax-Span-2424"></span><span class="mfrac" id="MathJax-Span-2425" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.401em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-2426" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1001.24em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.642em;"><span class="mrow" id="MathJax-Span-2427"><span class="mn" id="MathJax-Span-2428" style="font-family: STIXGeneral;">1</span><span class="texatom" id="MathJax-Span-2429"><span class="mrow" id="MathJax-Span-2430"><span class="mo" id="MathJax-Span-2431" style="font-family: STIXGeneral;">/</span></span></span><span class="mn" id="MathJax-Span-2432" style="font-family: STIXGeneral;">2</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1001.4em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.401em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-2433" style="font-family: STIXGeneral; padding-left: 0.272em;">+</span><span class="munderover" id="MathJax-Span-2434" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 4.035em; height: 0px;"><span style="position: absolute; clip: rect(2.852em, 1001.18em, 4.626em, -999.997em); top: -3.976em; left: 1.347em;"><span class="mo" id="MathJax-Span-2435" style="font-family: STIXSizeOneSym; vertical-align: -0.535em;">∑</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1003.98em, 4.411em, -999.997em); top: -2.847em; left: 0em;"><span class="texatom" id="MathJax-Span-2436"><span class="mrow" id="MathJax-Span-2437"><span class="mi" id="MathJax-Span-2438" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2439" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-2440" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-2441" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2442" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span class="mo" id="MathJax-Span-2443" style="font-size: 70.7%; font-family: STIXGeneral;">∼</span><span class="mi" id="MathJax-Span-2444" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-2445" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-2446" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-2447" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mn" id="MathJax-Span-2448" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-2449" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mn" id="MathJax-Span-2450" style="font-family: STIXGeneral; padding-left: 0.164em;">1</span><span class="mo" id="MathJax-Span-2451" style="font-family: STIXGeneral; padding-left: 0.272em;">⋅</span><span class="mi" id="MathJax-Span-2452" style="font-family: STIXGeneral; padding-left: 0.272em;">log</span><span class="mo" id="MathJax-Span-2453"></span><span class="mfrac" id="MathJax-Span-2454" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.401em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-2455" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1001.24em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.642em;"><span class="mrow" id="MathJax-Span-2456"><span class="mn" id="MathJax-Span-2457" style="font-family: STIXGeneral;">1</span><span class="texatom" id="MathJax-Span-2458"><span class="mrow" id="MathJax-Span-2459"><span class="mo" id="MathJax-Span-2460" style="font-family: STIXGeneral;">/</span></span></span><span class="mn" id="MathJax-Span-2461" style="font-family: STIXGeneral;">2</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1001.4em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.401em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-2462" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2463" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mi" id="MathJax-Span-2464" style="font-family: STIXGeneral; padding-left: 0.325em;">log</span><span class="mo" id="MathJax-Span-2465"></span><span class="mn" id="MathJax-Span-2466" style="font-family: STIXGeneral; padding-left: 0.164em;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1002.37em, 4.358em, -999.997em); top: 0.702em; left: 0em;"><span class="mtd" id="MathJax-Span-2475"><span class="mrow" id="MathJax-Span-2476"><span class="mi" id="MathJax-Span-2477"></span><span class="mo" id="MathJax-Span-2478" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="texatom" id="MathJax-Span-2479" style="padding-left: 0.325em;"><span class="mrow" id="MathJax-Span-2480"><span class="mo" id="MathJax-Span-2481" style="font-family: STIXVariants;">|</span></span></span><span class="mi" id="MathJax-Span-2482" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2483"><span class="mrow" id="MathJax-Span-2484"><span class="mo" id="MathJax-Span-2485" style="font-family: STIXVariants;">|</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span><span style="display: inline-block; width: 0px; height: 11.239em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -6.13em; border-left: 0px solid; width: 0px; height: 12.87em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">(</mo><mi>P</mi><mo fence="false" stretchy="false">‖</mo><mi>Q</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>=</mo><mn>0</mn><mo>,</mo><mi>y</mi><mo>∼</mo><mi>U</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></munder><mn>1</mn><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mfrac><mn>1</mn><mn>0</mn></mfrac><mo>=</mo><mo>+</mo><mi mathvariant="normal">∞</mi></mtd></mtr><mtr><mtd><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">(</mo><mi>Q</mi><mo fence="false" stretchy="false">‖</mo><mi>P</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>=</mo><mi>θ</mi><mo>,</mo><mi>y</mi><mo>∼</mo><mi>U</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></munder><mn>1</mn><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mfrac><mn>1</mn><mn>0</mn></mfrac><mo>=</mo><mo>+</mo><mi mathvariant="normal">∞</mi></mtd></mtr><mtr><mtd><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>J</mi><mi>S</mi></mrow></msub><mo stretchy="false">(</mo><mi>P</mi><mo>,</mo><mi>Q</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>=</mo><mn>0</mn><mo>,</mo><mi>y</mi><mo>∼</mo><mi>U</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></munder><mn>1</mn><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></mrow></mfrac><mo>+</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>=</mo><mn>0</mn><mo>,</mo><mi>y</mi><mo>∼</mo><mi>U</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></munder><mn>1</mn><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></mrow></mfrac><mo stretchy="false">)</mo><mo>=</mo><mi>log</mi><mo>⁡</mo><mn>2</mn></mtd></mtr><mtr><mtd><mi>W</mi><mo stretchy="false">(</mo><mi>P</mi><mo>,</mo><mi>Q</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-173">% <![CDATA[
\begin{aligned}
D_{KL}(P \| Q) &= \sum_{x=0, y \sim U(0, 1)} 1 \cdot \log\frac{1}{0} = +\infty \\
D_{KL}(Q \| P) &= \sum_{x=\theta, y \sim U(0, 1)} 1 \cdot \log\frac{1}{0} = +\infty \\
D_{JS}(P, Q) &= \frac{1}{2}(\sum_{x=0, y \sim U(0, 1)} 1 \cdot \log\frac{1}{1/2} + \sum_{x=0, y \sim U(0, 1)} 1 \cdot \log\frac{1}{1/2}) = \log 2\\
W(P, Q) &= |\theta|
\end{aligned} %]]></script>

<p>But when <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-174-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2486" style="width: 2.906em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.315em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1002.32em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2487"><span class="mi" id="MathJax-Span-2488" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2489" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-2490" style="font-family: STIXGeneral; padding-left: 0.325em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-174">\theta = 0</script>, two distributions are fully overlapped:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-175-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x007C;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x007C;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2491" style="width: 21.347em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.207em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.809em, 1017.05em, 3.444em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2492"><span class="mtable" id="MathJax-Span-2493" style="padding-right: 0.164em; padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 16.884em; height: 0px;"><span style="position: absolute; clip: rect(2.53em, 1004.2em, 5.056em, -999.997em); top: -3.976em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.25em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1004.2em, 4.358em, -999.997em); top: -4.621em; right: 0em;"><span class="mtd" id="MathJax-Span-2494"><span class="mrow" id="MathJax-Span-2495"><span class="msubsup" id="MathJax-Span-2496"><span style="display: inline-block; position: relative; width: 1.723em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2497" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="texatom" id="MathJax-Span-2498"><span class="mrow" id="MathJax-Span-2499"><span class="mi" id="MathJax-Span-2500" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-2501" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2502" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2503" style="font-family: STIXGeneral; font-style: italic;">P</span><span class="mo" id="MathJax-Span-2504" style="font-family: STIXGeneral;">‖</span><span class="mi" id="MathJax-Span-2505" style="font-family: STIXGeneral; font-style: italic;">Q</span><span class="mo" id="MathJax-Span-2506" style="font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1003.28em, 4.304em, -999.997em); top: -3.277em; right: 0em;"><span class="mtd" id="MathJax-Span-2536"><span class="mrow" id="MathJax-Span-2537"><span class="mi" id="MathJax-Span-2538" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-2539" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2540" style="font-family: STIXGeneral; font-style: italic;">P</span><span class="mo" id="MathJax-Span-2541" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2542" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">Q</span><span class="mo" id="MathJax-Span-2543" style="font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(2.53em, 1012.64em, 5.056em, -999.997em); top: -3.976em; left: 4.25em;"><span style="display: inline-block; position: relative; width: 12.637em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1012.64em, 4.358em, -999.997em); top: -4.621em; left: 0em;"><span class="mtd" id="MathJax-Span-2507"><span class="mrow" id="MathJax-Span-2508"><span class="mi" id="MathJax-Span-2509"></span><span class="mo" id="MathJax-Span-2510" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="msubsup" id="MathJax-Span-2511" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 1.723em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2512" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="texatom" id="MathJax-Span-2513"><span class="mrow" id="MathJax-Span-2514"><span class="mi" id="MathJax-Span-2515" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-2516" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2517" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2518" style="font-family: STIXGeneral; font-style: italic;">Q</span><span class="mo" id="MathJax-Span-2519" style="font-family: STIXGeneral;">‖</span><span class="mi" id="MathJax-Span-2520" style="font-family: STIXGeneral; font-style: italic;">P</span><span class="mo" id="MathJax-Span-2521" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2522" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="msubsup" id="MathJax-Span-2523" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 1.508em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2524" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="texatom" id="MathJax-Span-2525"><span class="mrow" id="MathJax-Span-2526"><span class="mi" id="MathJax-Span-2527" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-2528" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2529" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2530" style="font-family: STIXGeneral; font-style: italic;">P</span><span class="mo" id="MathJax-Span-2531" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2532" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">Q</span><span class="mo" id="MathJax-Span-2533" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2534" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-2535" style="font-family: STIXGeneral; padding-left: 0.325em;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1004.2em, 4.358em, -999.997em); top: -3.277em; left: 0em;"><span class="mtd" id="MathJax-Span-2544"><span class="mrow" id="MathJax-Span-2545"><span class="mi" id="MathJax-Span-2546"></span><span class="mo" id="MathJax-Span-2547" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-2548" style="font-family: STIXGeneral; padding-left: 0.325em;">0</span><span class="mo" id="MathJax-Span-2549" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mo" id="MathJax-Span-2550" style="font-family: STIXVariants; padding-left: 0.325em;">|</span><span class="mi" id="MathJax-Span-2551" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2552" style="font-family: STIXVariants;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.197em; border-left: 0px solid; width: 0px; height: 3.003em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">(</mo><mi>P</mi><mo fence="false" stretchy="false">‖</mo><mi>Q</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">(</mo><mi>Q</mi><mo fence="false" stretchy="false">‖</mo><mi>P</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>J</mi><mi>S</mi></mrow></msub><mo stretchy="false">(</mo><mi>P</mi><mo>,</mo><mi>Q</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mtd></mtr><mtr><mtd><mi>W</mi><mo stretchy="false">(</mo><mi>P</mi><mo>,</mo><mi>Q</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mn>0</mn><mo>=</mo><mo fence="false" stretchy="false">|</mo><mi>θ</mi><mo fence="false" stretchy="false">|</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-175">% <![CDATA[
\begin{aligned}
D_{KL}(P \| Q) &= D_{KL}(Q \| P) = D_{JS}(P, Q) = 0\\
W(P, Q) &= 0 = \lvert \theta \rvert
\end{aligned} %]]></script>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-176-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2553" style="width: 2.153em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.723em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.562em, 1001.72em, 2.691em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2554"><span class="msubsup" id="MathJax-Span-2555"><span style="display: inline-block; position: relative; width: 1.723em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2556" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="texatom" id="MathJax-Span-2557"><span class="mrow" id="MathJax-Span-2558"><span class="mi" id="MathJax-Span-2559" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-2560" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.137em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-176">D_{KL}</script> gives us inifity when two distributions are disjoint. The value of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-177-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2561" style="width: 1.884em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.508em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.562em, 1001.51em, 2.691em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2562"><span class="msubsup" id="MathJax-Span-2563"><span style="display: inline-block; position: relative; width: 1.508em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2564" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.702em;"><span class="texatom" id="MathJax-Span-2565"><span class="mrow" id="MathJax-Span-2566"><span class="mi" id="MathJax-Span-2567" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mi" id="MathJax-Span-2568" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.137em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>J</mi><mi>S</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-177">D_{JS}</script> has sudden jump, not differentiable at <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-178-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2569" style="width: 2.906em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.315em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1002.32em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2570"><span class="mi" id="MathJax-Span-2571" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2572" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mn" id="MathJax-Span-2573" style="font-family: STIXGeneral; padding-left: 0.325em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-178">\theta = 0</script>. Only Wasserstein metric provides a smooth measure, which is super helpful for a stable learning process using gradient descents.</p>

<h3 id="use-wasserstein-distance-as-gan-loss-function">Use Wasserstein distance as GAN loss function</h3>

<p>It is intractable to exhaust all the possible joint distributions in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-179-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2574" style="width: 4.465em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.605em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1003.55em, 2.96em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2575"><span class="mi" id="MathJax-Span-2576" style="font-family: STIXGeneral;">Π</span><span class="mo" id="MathJax-Span-2577" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-2578"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2579" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-2580" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2581" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-2582" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2583" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-2584" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2585" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.337em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Π</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mi>r</mi></msub><mo>,</mo><msub><mi>p</mi><mi>g</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-179">\Pi(p_r, p_g)</script> to compute <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-180-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;inf&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2586" style="width: 5.487em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.411em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.508em, 1004.41em, 2.96em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2587"><span class="munderover" id="MathJax-Span-2588"><span style="display: inline-block; position: relative; width: 4.411em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1001.18em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mo" id="MathJax-Span-2589" style="font-family: STIXGeneral;">inf</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 1.132em;"><span class="texatom" id="MathJax-Span-2590"><span class="mrow" id="MathJax-Span-2591"><span class="mi" id="MathJax-Span-2592" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2593" style="font-size: 70.7%; font-family: STIXGeneral;">∼</span><span class="mi" id="MathJax-Span-2594" style="font-size: 70.7%; font-family: STIXGeneral;">Π</span><span class="mo" id="MathJax-Span-2595" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-2596"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2597" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.379em;"><span class="mi" id="MathJax-Span-2598" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2599" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-2600"><span style="display: inline-block; position: relative; width: 0.648em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2601" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.379em;"><span class="mi" id="MathJax-Span-2602" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2603" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.597em; border-left: 0px solid; width: 0px; height: 1.537em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><munder><mo movablelimits="true" form="prefix">inf</mo><mrow class="MJX-TeXAtom-ORD"><mi>γ</mi><mo>∼</mo><mi mathvariant="normal">Π</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mi>r</mi></msub><mo>,</mo><msub><mi>p</mi><mi>g</mi></msub><mo stretchy="false">)</mo></mrow></munder></math></span></span><script type="math/tex" id="MathJax-Element-180">\inf_{\gamma \sim \Pi(p_r, p_g)}</script>. Thus the authors proposed a smart transformation of the formula based on the Kantorovich-Rubinstein duality to:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-181-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/mfrac&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;sup&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2604" style="width: 23.282em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.766em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.024em, 1018.66em, 3.82em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2605"><span class="mi" id="MathJax-Span-2606" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-2607" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-2608"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2609" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-2610" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2611" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-2612" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2613" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-2614" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2615" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2616" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mfrac" id="MathJax-Span-2617" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.142em, -999.997em); top: -4.675em; left: 50%; margin-left: -0.266em;"><span class="mn" id="MathJax-Span-2618" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.175em, 1000.7em, 4.142em, -999.997em); top: -3.277em; left: 50%; margin-left: -0.374em;"><span class="mi" id="MathJax-Span-2619" style="font-family: STIXGeneral; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1000.86em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.863em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2620" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 2.368em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1001.35em, 4.358em, -999.997em); top: -3.976em; left: 0.487em;"><span class="mo" id="MathJax-Span-2621" style="font-family: STIXGeneral;">sup</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1002.37em, 4.411em, -999.997em); top: -3.062em; left: 0em;"><span class="texatom" id="MathJax-Span-2622"><span class="mrow" id="MathJax-Span-2623"><span class="mo" id="MathJax-Span-2624" style="font-size: 70.7%; font-family: STIXGeneral;">‖</span><span class="mi" id="MathJax-Span-2625" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="msubsup" id="MathJax-Span-2626"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.27em, 4.25em, -999.997em); top: -3.976em; left: 0em;"><span class="mo" id="MathJax-Span-2627" style="font-size: 70.7%; font-family: STIXGeneral;">‖</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.379em;"><span class="mi" id="MathJax-Span-2628" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2629" style="font-size: 70.7%; font-family: STIXGeneral;">≤</span><span class="mi" id="MathJax-Span-2630" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2631" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 2.099em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="texatom" id="MathJax-Span-2632"><span class="mrow" id="MathJax-Span-2633"><span class="mi" id="MathJax-Span-2634" style="font-family: STIXGeneral;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.648em;"><span class="texatom" id="MathJax-Span-2635"><span class="mrow" id="MathJax-Span-2636"><span class="mi" id="MathJax-Span-2637" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2638" style="font-size: 70.7%; font-family: STIXGeneral;">∼</span><span class="msubsup" id="MathJax-Span-2639"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2640" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.379em;"><span class="mi" id="MathJax-Span-2641" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2642" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-2643" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span><span class="mo" id="MathJax-Span-2644" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2645" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2646" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2647" style="font-family: STIXGeneral;">]</span><span class="mo" id="MathJax-Span-2648" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="msubsup" id="MathJax-Span-2649" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 2.153em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="texatom" id="MathJax-Span-2650"><span class="mrow" id="MathJax-Span-2651"><span class="mi" id="MathJax-Span-2652" style="font-family: STIXGeneral;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.648em;"><span class="texatom" id="MathJax-Span-2653"><span class="mrow" id="MathJax-Span-2654"><span class="mi" id="MathJax-Span-2655" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2656" style="font-size: 70.7%; font-family: STIXGeneral;">∼</span><span class="msubsup" id="MathJax-Span-2657"><span style="display: inline-block; position: relative; width: 0.648em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2658" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.379em;"><span class="mi" id="MathJax-Span-2659" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2660" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-2661" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span><span class="mo" id="MathJax-Span-2662" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2663" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2664" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2665" style="font-family: STIXGeneral;">]</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.463em; border-left: 0px solid; width: 0px; height: 3.27em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>W</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mi>r</mi></msub><mo>,</mo><msub><mi>p</mi><mi>g</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>K</mi></mfrac><munder><mo movablelimits="true" form="prefix">sup</mo><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">‖</mo><mi>f</mi><msub><mo fence="false" stretchy="false">‖</mo><mi>L</mi></msub><mo>≤</mo><mi>K</mi></mrow></munder><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>∼</mo><msub><mi>p</mi><mi>r</mi></msub></mrow></msub><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>−</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>∼</mo><msub><mi>p</mi><mi>g</mi></msub></mrow></msub><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-181">W(p_r, p_g) = \frac{1}{K} \sup_{\| f \|_L \leq K} \mathbb{E}_{x \sim p_r}[f(x)] - \mathbb{E}_{x \sim p_g}[f(x)]</script>

<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-182-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;sup&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2666" style="width: 1.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.401em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.884em, 1001.35em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2667"><span class="mo" id="MathJax-Span-2668" style="font-family: STIXGeneral;">sup</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo movablelimits="true" form="prefix">sup</mo></math></span></span><script type="math/tex" id="MathJax-Element-182">\sup</script> (<a href="https://en.wikipedia.org/wiki/Infimum_and_supremum">supremum</a>) is the opposite of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-183-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2669" style="width: 1.562em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.239em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1001.24em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2670"><span class="mi" id="MathJax-Span-2671" style="font-family: STIXGeneral; font-style: italic;">i</span><span class="mi" id="MathJax-Span-2672" style="font-family: STIXGeneral; font-style: italic;">n</span><span class="mi" id="MathJax-Span-2673" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mi>n</mi><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-183">inf</script> (infimum); we want to measure the least upper bound or, in even simpler words, the maximum value.</p>

<p><strong>Lipschitz continuity?</strong></p>

<p>The function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-184-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2674" style="width: 0.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1000.43em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2675"><span class="mi" id="MathJax-Span-2676" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-184">f</script> in the new form of Wasserstein metric is demanded to satisfy <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-185-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2677" style="width: 4.949em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.981em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1003.98em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2678"><span class="mo" id="MathJax-Span-2679" style="font-family: STIXGeneral;">‖</span><span class="mi" id="MathJax-Span-2680" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span><span class="msubsup" id="MathJax-Span-2681"><span style="display: inline-block; position: relative; width: 0.97em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mo" id="MathJax-Span-2682" style="font-family: STIXGeneral;">‖</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.54em;"><span class="mi" id="MathJax-Span-2683" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2684" style="font-family: STIXGeneral; padding-left: 0.325em;">≤</span><span class="mi" id="MathJax-Span-2685" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.325em;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.27em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">‖</mo><mi>f</mi><msub><mo fence="false" stretchy="false">‖</mo><mi>L</mi></msub><mo>≤</mo><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-185">\| f \|_L \leq K</script>, meaning it should be <a href="https://en.wikipedia.org/wiki/Lipschitz_continuity">K-Lipschitz continuous</a>.</p>

<p>A real-valued function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-186-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2686" style="width: 5.487em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.411em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1004.36em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2687"><span class="mi" id="MathJax-Span-2688" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span><span class="mo" id="MathJax-Span-2689" style="font-family: STIXGeneral; padding-left: 0.325em;">:</span><span class="texatom" id="MathJax-Span-2690" style="padding-left: 0.325em;"><span class="mrow" id="MathJax-Span-2691"><span class="mi" id="MathJax-Span-2692" style="font-family: STIXGeneral;">ℝ</span></span></span><span class="mo" id="MathJax-Span-2693" style="font-family: STIXGeneral; padding-left: 0.325em;">→</span><span class="texatom" id="MathJax-Span-2694" style="padding-left: 0.325em;"><span class="mrow" id="MathJax-Span-2695"><span class="mi" id="MathJax-Span-2696" style="font-family: STIXGeneral;">ℝ</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo>:</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow><mo stretchy="false">→</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-186">f: \mathbb{R} \rightarrow \mathbb{R}</script> is called <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-187-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2697" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.7em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2698"><span class="mi" id="MathJax-Span-2699" style="font-family: STIXGeneral; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-187">K</script>-Lipschitz continuous if there exists a real constant <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-188-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2700" style="width: 3.175em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.53em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1002.53em, 2.798em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2701"><span class="mi" id="MathJax-Span-2702" style="font-family: STIXGeneral; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-2703" style="font-family: STIXGeneral; padding-left: 0.325em;">≥</span><span class="mn" id="MathJax-Span-2704" style="font-family: STIXGeneral; padding-left: 0.325em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.197em; border-left: 0px solid; width: 0px; height: 1.07em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi><mo>≥</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-188">K \geq 0</script> such that, for all <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-189-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2705" style="width: 5.218em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.196em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1004.14em, 2.852em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2706"><span class="msubsup" id="MathJax-Span-2707"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2708" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.433em;"><span class="mn" id="MathJax-Span-2709" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2710" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-2711" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2712" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.433em;"><span class="mn" id="MathJax-Span-2713" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2714" style="font-family: STIXGeneral; padding-left: 0.325em;">∈</span><span class="texatom" id="MathJax-Span-2715" style="padding-left: 0.325em;"><span class="mrow" id="MathJax-Span-2716"><span class="mi" id="MathJax-Span-2717" style="font-family: STIXGeneral;">ℝ</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.137em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>∈</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-189">x_1, x_2 \in \mathbb{R}</script>,</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-190-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x007C;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x007C;&lt;/mo&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x007C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x007C;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2718" style="width: 14.196em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.454em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1011.35em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2719"><span class="mo" id="MathJax-Span-2720" style="font-family: STIXVariants;">|</span><span class="mi" id="MathJax-Span-2721" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span><span class="mo" id="MathJax-Span-2722" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-2723"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2724" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.433em;"><span class="mn" id="MathJax-Span-2725" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2726" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2727" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="mi" id="MathJax-Span-2728" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.272em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span><span class="mo" id="MathJax-Span-2729" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-2730"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2731" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.433em;"><span class="mn" id="MathJax-Span-2732" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2733" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2734" style="font-family: STIXVariants;">|</span><span class="mo" id="MathJax-Span-2735" style="font-family: STIXGeneral; padding-left: 0.325em;">≤</span><span class="mi" id="MathJax-Span-2736" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.325em;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-2737" style="font-family: STIXVariants;">|</span><span class="msubsup" id="MathJax-Span-2738"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2739" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.433em;"><span class="mn" id="MathJax-Span-2740" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2741" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="msubsup" id="MathJax-Span-2742" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.43em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2743" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.433em;"><span class="mn" id="MathJax-Span-2744" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2745" style="font-family: STIXVariants;">|</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.27em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo fence="false" stretchy="false">|</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo fence="false" stretchy="false">|</mo><mo>≤</mo><mi>K</mi><mo fence="false" stretchy="false">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><msub><mi>x</mi><mn>2</mn></msub><mo fence="false" stretchy="false">|</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-190">\lvert f(x_1) - f(x_2) \rvert \leq K \lvert x_1 - x_2 \rvert</script>

<p>Functions that are everywhere continuously differentiable is Lipschitz continuous, because the derivative, estimated as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-191-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x007C;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x007C;&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x007C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x007C;&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2746" style="width: 5.003em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.035em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.185em, 1004.03em, 3.067em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2747"><span class="mfrac" id="MathJax-Span-2748"><span style="display: inline-block; position: relative; width: 3.82em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.336em, 1003.61em, 4.304em, -999.997em); top: -4.513em; left: 50%; margin-left: -1.879em;"><span class="mrow" id="MathJax-Span-2749"><span class="mo" id="MathJax-Span-2750" style="font-size: 70.7%; font-family: STIXVariants;">|</span><span class="mi" id="MathJax-Span-2751" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-2752" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-2753"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2754" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.868em; left: 0.325em;"><span class="mn" id="MathJax-Span-2755" style="font-size: 50%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2756" style="font-size: 70.7%; font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2757" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mi" id="MathJax-Span-2758" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-2759" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-2760"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2761" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.868em; left: 0.325em;"><span class="mn" id="MathJax-Span-2762" style="font-size: 50%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2763" style="font-size: 70.7%; font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2764" style="font-size: 70.7%; font-family: STIXVariants;">|</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1002.1em, 4.25em, -999.997em); top: -3.599em; left: 50%; margin-left: -1.073em;"><span class="mrow" id="MathJax-Span-2765"><span class="mo" id="MathJax-Span-2766" style="font-size: 70.7%; font-family: STIXVariants;">|</span><span class="msubsup" id="MathJax-Span-2767"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2768" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.868em; left: 0.325em;"><span class="mn" id="MathJax-Span-2769" style="font-size: 50%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2770" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="msubsup" id="MathJax-Span-2771"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2772" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.868em; left: 0.325em;"><span class="mn" id="MathJax-Span-2773" style="font-size: 50%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2774" style="font-size: 70.7%; font-family: STIXVariants;">|</span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(0.863em, 1003.82em, 1.239em, -999.997em); top: -1.288em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.82em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.73em; border-left: 0px solid; width: 0px; height: 2.07em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mo fence="false" stretchy="false">|</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo fence="false" stretchy="false">|</mo></mrow><mrow><mo fence="false" stretchy="false">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><msub><mi>x</mi><mn>2</mn></msub><mo fence="false" stretchy="false">|</mo></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-191">\frac{\lvert f(x_1) - f(x_2) \rvert}{\lvert x_1 - x_2 \rvert}</script>, has bounds. However, a Lipschitz continuous function may not be everywhere differentiable, such as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-192-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x007C;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x007C;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2775" style="width: 4.949em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.981em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1003.87em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2776"><span class="mi" id="MathJax-Span-2777" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span><span class="mo" id="MathJax-Span-2778" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2779" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2780" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2781" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mo" id="MathJax-Span-2782" style="font-family: STIXVariants; padding-left: 0.325em;">|</span><span class="mi" id="MathJax-Span-2783" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2784" style="font-family: STIXVariants;">|</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.27em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mo fence="false" stretchy="false">|</mo><mi>x</mi><mo fence="false" stretchy="false">|</mo></math></span></span><script type="math/tex" id="MathJax-Element-192">f(x) = \lvert x \rvert</script>.</p>

<p>Explaining how the transformation happens on the Wasserstein distance formula is worthy of a long post by itself, so I skip the details here. If you are interested in how to compute Wasserstein metric using linear programming, or how to transfer Wasserstein metric into its dual form according to the Kantorovich-Rubinstein Duality, read this <a href="https://vincentherrmann.github.io/blog/wasserstein/">awesome post</a>.</p>

<p>Suppose this function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-193-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2785" style="width: 0.54em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1000.43em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2786"><span class="mi" id="MathJax-Span-2787" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-193">f</script> comes from a family of K-Lipschitz continuous functions, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-194-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2788" style="width: 4.304em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.444em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1003.44em, 2.906em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2789"><span class="mo" id="MathJax-Span-2790" style="font-family: STIXGeneral;">{</span><span class="msubsup" id="MathJax-Span-2791"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.43em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2792" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.272em;"><span class="mi" id="MathJax-Span-2793" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2794"><span style="display: inline-block; position: relative; width: 2.153em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.38em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mo" id="MathJax-Span-2795" style="font-family: STIXGeneral;">}</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="texatom" id="MathJax-Span-2796"><span class="mrow" id="MathJax-Span-2797"><span class="mi" id="MathJax-Span-2798" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span><span class="mo" id="MathJax-Span-2799" style="font-size: 70.7%; font-family: STIXGeneral;">∈</span><span class="mi" id="MathJax-Span-2800" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><msub><mi>f</mi><mi>w</mi></msub><msub><mo fence="false" stretchy="false">}</mo><mrow class="MJX-TeXAtom-ORD"><mi>w</mi><mo>∈</mo><mi>W</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-194">\{ f_w \}_{w \in W}</script>, parameterized by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-195-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2801" style="width: 0.809em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.648em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.65em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2802"><span class="mi" id="MathJax-Span-2803" style="font-family: STIXGeneral; font-style: italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.737em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-195">w</script>. In the modified Wasserstein-GAN, the “discriminator” model is used to learn <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-196-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2804" style="width: 0.809em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.648em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.65em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2805"><span class="mi" id="MathJax-Span-2806" style="font-family: STIXGeneral; font-style: italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.737em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-196">w</script> to find a good <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-197-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2807" style="width: 1.024em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.508em, 1000.81em, 2.745em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2808"><span class="msubsup" id="MathJax-Span-2809"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.43em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2810" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.272em;"><span class="mi" id="MathJax-Span-2811" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mi>w</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-197">f_w</script> and the loss function is configured as measuring the Wasserstein distance between <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-198-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2812" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.777em, 1000.86em, 2.745em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2813"><span class="msubsup" id="MathJax-Span-2814"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2815" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-2816" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>r</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-198">p_r</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-199-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2817" style="width: 1.132em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.777em, 1000.92em, 2.798em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2818"><span class="msubsup" id="MathJax-Span-2819"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2820" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-2821" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.07em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>g</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-199">p_g</script>.</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-200-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2822" style="width: 30.433em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.519em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1024.41em, 3.497em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2823"><span class="mi" id="MathJax-Span-2824" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2825" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-2826"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2827" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-2828" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2829" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-2830" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2831" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-2832" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2833" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2834" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="mi" id="MathJax-Span-2835" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.325em;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-2836" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-2837"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2838" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-2839" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2840" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-2841" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2842" style="font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-2843" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2844" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2845" style="font-family: STIXGeneral; padding-left: 0.325em;">=</span><span class="munderover" id="MathJax-Span-2846" style="padding-left: 0.325em;"><span style="display: inline-block; position: relative; width: 1.723em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1001.72em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="mo" id="MathJax-Span-2847" style="font-family: STIXGeneral;">max</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1001.62em, 4.25em, -999.997em); top: -3.277em; left: 0.056em;"><span class="texatom" id="MathJax-Span-2848"><span class="mrow" id="MathJax-Span-2849"><span class="mi" id="MathJax-Span-2850" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span><span class="mo" id="MathJax-Span-2851" style="font-size: 70.7%; font-family: STIXGeneral;">∈</span><span class="mi" id="MathJax-Span-2852" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2853" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 2.099em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="texatom" id="MathJax-Span-2854"><span class="mrow" id="MathJax-Span-2855"><span class="mi" id="MathJax-Span-2856" style="font-family: STIXGeneral;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.648em;"><span class="texatom" id="MathJax-Span-2857"><span class="mrow" id="MathJax-Span-2858"><span class="mi" id="MathJax-Span-2859" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2860" style="font-size: 70.7%; font-family: STIXGeneral;">∼</span><span class="msubsup" id="MathJax-Span-2861"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2862" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.379em;"><span class="mi" id="MathJax-Span-2863" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2864" style="font-family: STIXGeneral;">[</span><span class="msubsup" id="MathJax-Span-2865"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.43em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2866" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.272em;"><span class="mi" id="MathJax-Span-2867" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2868" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2869" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2870" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2871" style="font-family: STIXGeneral;">]</span><span class="mo" id="MathJax-Span-2872" style="font-family: STIXGeneral; padding-left: 0.272em;">−</span><span class="msubsup" id="MathJax-Span-2873" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 2.798em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.59em, 4.142em, -999.997em); top: -3.976em; left: 0em;"><span class="texatom" id="MathJax-Span-2874"><span class="mrow" id="MathJax-Span-2875"><span class="mi" id="MathJax-Span-2876" style="font-family: STIXGeneral;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.648em;"><span class="texatom" id="MathJax-Span-2877"><span class="mrow" id="MathJax-Span-2878"><span class="mi" id="MathJax-Span-2879" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span class="mo" id="MathJax-Span-2880" style="font-size: 70.7%; font-family: STIXGeneral;">∼</span><span class="msubsup" id="MathJax-Span-2881"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px;"><span style="position: absolute; clip: rect(3.497em, 1000.33em, 4.304em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2882" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.379em;"><span class="mi" id="MathJax-Span-2883" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2884" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2885" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span class="mo" id="MathJax-Span-2886" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2887" style="font-family: STIXGeneral;">[</span><span class="msubsup" id="MathJax-Span-2888"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.43em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2889" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.272em;"><span class="mi" id="MathJax-Span-2890" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2891" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-2892"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.49em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2893" style="font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.487em;"><span class="mi" id="MathJax-Span-2894" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span><span class="mo" id="MathJax-Span-2895" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-2896" style="font-family: STIXGeneral; font-style: italic;">z</span><span class="mo" id="MathJax-Span-2897" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2898" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-2899" style="font-family: STIXGeneral;">]</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.063em; border-left: 0px solid; width: 0px; height: 2.003em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>L</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mi>r</mi></msub><mo>,</mo><msub><mi>p</mi><mi>g</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>W</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mi>r</mi></msub><mo>,</mo><msub><mi>p</mi><mi>g</mi></msub><mo stretchy="false">)</mo><mo>=</mo><munder><mo movablelimits="true" form="prefix">max</mo><mrow class="MJX-TeXAtom-ORD"><mi>w</mi><mo>∈</mo><mi>W</mi></mrow></munder><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>∼</mo><msub><mi>p</mi><mi>r</mi></msub></mrow></msub><mo stretchy="false">[</mo><msub><mi>f</mi><mi>w</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>−</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mo>∼</mo><msub><mi>p</mi><mi>r</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">[</mo><msub><mi>f</mi><mi>w</mi></msub><mo stretchy="false">(</mo><msub><mi>g</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-200">L(p_r, p_g) = W(p_r, p_g) = \max_{w \in W} \mathbb{E}_{x \sim p_r}[f_w(x)] - \mathbb{E}_{z \sim p_r(z)}[f_w(g_\theta(z))]</script>

<p>Thus the “discriminator” is not a direct critic of telling the fake samples apart from the real ones anymore. Instead, it is trained to learn a <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-201-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2900" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.7em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2901"><span class="mi" id="MathJax-Span-2902" style="font-family: STIXGeneral; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-201">K</script>-Lipschitz continuous function to help compute Wasserstein distance. As the loss function decreases in the training, the Wasserstein distance gets smaller and the generator model’s output grows closer to the real data distribution.</p>

<p>One big problem is to maintain the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-202-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2903" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.702em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.7em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2904"><span class="mi" id="MathJax-Span-2905" style="font-family: STIXGeneral; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-202">K</script>-Lipschitz continuity of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-203-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2906" style="width: 1.024em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.508em, 1000.81em, 2.745em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2907"><span class="msubsup" id="MathJax-Span-2908"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.43em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2909" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.272em;"><span class="mi" id="MathJax-Span-2910" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mi>w</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-203">f_w</script> during the training in order to make everything work out. The paper presents a simple but very practical trick: After every gradient update, clamp the weights <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-204-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2911" style="width: 0.809em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.648em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.938em, 1000.65em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2912"><span class="mi" id="MathJax-Span-2913" style="font-family: STIXGeneral; font-style: italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.737em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-204">w</script> to a small window, such as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-205-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;0.01&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0.01&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2914" style="width: 6.562em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.272em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.669em, 1005.16em, 2.852em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2915"><span class="mo" id="MathJax-Span-2916" style="font-family: STIXGeneral;">[</span><span class="mo" id="MathJax-Span-2917" style="font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-2918" style="font-family: STIXGeneral;">0.01</span><span class="mo" id="MathJax-Span-2919" style="font-family: STIXGeneral;">,</span><span class="mn" id="MathJax-Span-2920" style="font-family: STIXGeneral; padding-left: 0.164em;">0.01</span><span class="mo" id="MathJax-Span-2921" style="font-family: STIXGeneral;">]</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.137em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>−</mo><mn>0.01</mn><mo>,</mo><mn>0.01</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-205">[-0.01, 0.01]</script>, resulting in a compact parameter space <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-206-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2922" style="width: 1.132em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1000.92em, 2.691em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2923"><span class="mi" id="MathJax-Span-2924" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-206">W</script> and thus <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-207-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2925" style="width: 1.024em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.508em, 1000.81em, 2.745em, -999.997em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2926"><span class="msubsup" id="MathJax-Span-2927"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.43em, 4.358em, -999.997em); top: -3.976em; left: 0em;"><span class="mi" id="MathJax-Span-2928" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span><span style="position: absolute; top: -3.815em; left: 0.272em;"><span class="mi" id="MathJax-Span-2929" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.981em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mi>w</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-207">f_w</script> obtains its lower and upper bounds to preserve the Lipschitz continuity.</p>

<p style="width: 640px;" class="center"><img src="./From GAN to WGAN_files/WGAN_algorithm.png" alt="Simple example"></p>
<p><em>Fig. 9. Algorithm of Wasserstein generative adversarial network. (Image source: <a href="https://arxiv.org/pdf/1701.07875.pdf">Arjovsky, Chintala, &amp; Bottou, 2017.</a>)</em></p>

<p>Compared to the original GAN algorithm, the WGAN undertakes the following changes:</p>
<ul>
  <li>After every gradient update on the critic function, clamp the weights to a small fixed range, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-208-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2930" style="width: 3.282em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.637em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.723em, 1002.53em, 2.852em, -999.997em); top: -2.524em; left: 0em;"><span class="mrow" id="MathJax-Span-2931"><span class="mo" id="MathJax-Span-2932" style="font-family: STIXGeneral;">[</span><span class="mo" id="MathJax-Span-2933" style="font-family: STIXGeneral;">−</span><span class="mi" id="MathJax-Span-2934" style="font-family: STIXGeneral; font-style: italic;">c</span><span class="mo" id="MathJax-Span-2935" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-2936" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.164em;">c</span><span class="mo" id="MathJax-Span-2937" style="font-family: STIXGeneral;">]</span></span><span style="display: inline-block; width: 0px; height: 2.53em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.263em; border-left: 0px solid; width: 0px; height: 1.137em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>−</mo><mi>c</mi><mo>,</mo><mi>c</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-208">[-c, c]</script>.</li>
  <li>Use a new loss function derived from the Wasserstein distance, no logarithm anymore. The “discriminator” model does not play as a direct critic but a helper for estimating the Wasserstein metric between real and generated data distribution.</li>
  <li>Empirically the authors recommended <a href="http://www.cs.toronto.edu/~tijmen/csc321/slides/lecture_slides_lec6.pdf">RMSProp</a> optimizer on the critic, rather than a momentum based optimizer such as <a href="https://arxiv.org/abs/1412.6980v8">Adam</a> which could cause instability in the model training. I haven’t seen clear theoretical explanation on this point through.</li>
</ul>

<hr>

<p>Sadly, Wasserstein GAN is not perfect. Even the authors of the original WGAN paper mentioned that <em>“Weight clipping is a clearly terrible way to enforce a Lipschitz constraint”</em> (Oops!). WGAN still suffers from unstable training, slow convergence after weight clipping (when clipping window is too large), and vanishing gradients (when clipping window is too small).</p>

<p>Some improvement, precisely replacing weight clipping with <strong>gradient penalty</strong>, has been discussed in <a href="https://arxiv.org/pdf/1704.00028.pdf">Gulrajani et al. 2017</a>. I will leave this to a future post.</p>

<h2 id="example-create-new-pokemons">Example: Create New Pokemons!</h2>

<p>Just for fun, I tried out <a href="https://github.com/carpedm20/DCGAN-tensorflow">carpedm20/DCGAN-tensorflow</a> on a tiny dataset, <a href="https://github.com/PokeAPI/sprites/">Pokemon sprites</a>. The dataset only has 900-ish pokemon images, including different levels of same pokemon species.</p>

<p>Let’s check out what types of new pokemons the model is able to create. 
Unfortunately due to the tiny training data, the new pokemons only have rough shapes without details. The shapes and colors do look better with more training epoches! Hooray!</p>

<p class="center"><img src="./From GAN to WGAN_files/pokemon-GAN.png" alt="Pokemon GAN"></p>
<p><em>Fig. 10. Train <a href="https://github.com/carpedm20/DCGAN-tensorflow">carpedm20/DCGAN-tensorflow</a> on a set of Pokemon sprite images. The sample outputs are listed after training epoches = 7, 21, 49.</em></p>

<p>If you are interested in a commented version of <a href="https://github.com/carpedm20/DCGAN-tensorflow">carpedm20/DCGAN-tensorflow</a> and how to modify it to train WGAN and WGAN with gradient penalty, check <a href="https://github.com/lilianweng/unified-gan-tensorflow">lilianweng/unified-gan-tensorflow</a>.</p>

<hr>

<p><em>If you notice mistakes and errors in this post, don’t hesitate to contact me at [lilian dot wengweng at gmail dot com] and I would be super happy to correct them right away!</em></p>

<p>See you in the next post :D</p>

<h2 id="references">References</h2>

<p>[1] Goodfellow, Ian, et al. <a href="https://arxiv.org/pdf/1406.2661.pdf">“Generative adversarial nets.”</a> NIPS, 2014.</p>

<p>[2] Tim Salimans, Ian Goodfellow, Wojciech Zaremba, Vicki Cheung, Alec Radford, and Xi Chen. <a href="http://papers.nips.cc/paper/6125-improved-techniques-for-training-gans.pdf">“Improved techniques for training gans.”</a> In Advances in Neural Information Processing Systems.</p>

<p>[3] Martin Arjovsky and Léon Bottou. <a href="https://arxiv.org/pdf/1701.04862.pdf">“Towards principled methods for training generative adversarial networks.”</a> arXiv preprint arXiv:1701.04862 (2017).</p>

<p>[4] Martin Arjovsky, Soumith Chintala, and Léon Bottou. <a href="https://arxiv.org/pdf/1701.07875.pdf">“Wasserstein GAN.”</a> arXiv preprint arXiv:1701.07875 (2017).</p>

<p>[4] Ishaan Gulrajani, Faruk Ahmed, Martin Arjovsky, Vincent Dumoulin, Aaron Courville. <a href="https://arxiv.org/pdf/1704.00028.pdf">Improved training of wasserstein gans.</a> arXiv preprint arXiv:1704.00028 (2017).</p>

<p>[5] <a href="http://robotics.stanford.edu/~scohen/research/emdg/emdg.html">Computing the Earth Mover’s Distance under Transformations</a></p>

<p>[6] <a href="https://vincentherrmann.github.io/blog/wasserstein/">Wasserstein GAN and the Kantorovich-Rubinstein Duality</a></p>

<p>[7] <a href="https://zhuanlan.zhihu.com/p/25071913">zhuanlan.zhihu.com/p/25071913</a></p>

<p>[8] Ferenc Huszár. <a href="https://arxiv.org/pdf/1511.05101.pdf">“How (not) to Train your Generative Model: Scheduled Sampling, Likelihood, Adversary?.”</a> arXiv preprint arXiv:1511.05101 (2015).</p>

  </div>


  <div class="page-navigation">
    
      <a class="prev" href="https://lilianweng.github.io/lil-log/2017/08/01/how-to-explain-the-prediction-of-a-machine-learning-model.html">← How to Explain the Prediction of a Machine Learning Model?</a>
    

    
      <a class="next" href="https://lilianweng.github.io/lil-log/2017/09/28/anatomize-deep-learning-with-information-theory.html">Anatomize Deep Learning with Information Theory →</a>
    
  </div>

  

</article>

      </div>
    </main>

    <div style="clear: both;">
<footer class="site-footer">
    2018 © Built by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a> and <a href="https://github.com/jekyll/minima/" target="_blank">minima</a> | View <a href="https://github.com/lilianweng/lil-log/tree/gh-pages" target="_blank">this</a> on Github

    <p>
        <a href="https://lilianweng.github.io/lil-log/feed.xml" target="_blank">
            <img src="./From GAN to WGAN_files/logo_rss.png">
        </a>
        <a href="https://scholar.google.com/citations?user=dCa-pW8AAAAJ&amp;hl=en&amp;oi=ao" target="_blank">
            <img src="./From GAN to WGAN_files/logo_scholar.png">
        </a>
        <a href="https://github.com/lilianweng" target="_blank">
            <img src="./From GAN to WGAN_files/logo_github.png">
        </a>
        <a href="https://www.instagram.com/lilianweng/" target="_blank">
            <img src="./From GAN to WGAN_files/logo_instagram.png">
        </a>
    </p>
</footer>


  


</div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXSizeOneSym, sans-serif;"></div></div></body></html>